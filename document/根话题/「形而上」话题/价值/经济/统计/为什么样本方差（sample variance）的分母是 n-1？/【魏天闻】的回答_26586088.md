# 为什么样本方差（sample variance）的分母是 n-1？
- 点赞数：6684
- 更新时间：2015年03月11日23时02分15秒
- 回答url：https://www.zhihu.com/question/20099757/answer/26586088
<body>
 <p data-pid="7jO6WbTr">上面有答案解释得很明确，即样本方差计算公式里分母为<img src="https://www.zhihu.com/equation?tex=n-1" alt="n-1" eeimg="1">的目的是为了让方差的估计是<b>无偏</b>的。无偏的估计(unbiased estimator)比有偏估计(biased estimator)更好是符合直觉的，尽管有的统计学家认为让mean square error即MSE最小才更有意义，这个问题我们不在这里探讨；<b>不符合直觉的是，为什么分母必须得是<img src="https://www.zhihu.com/equation?tex=n-1" alt="n-1" eeimg="1">而不是<img src="https://www.zhihu.com/equation?tex=n" alt="n" eeimg="1">才能使得该估计无偏。</b>我相信这是题主真正困惑的地方。</p>
 <p data-pid="TchPMsAr">要回答这个问题，偷懒的办法是让困惑的题主去看下面这个等式的数学证明：</p>
 <p data-pid="XBO7kuEl"><img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5CBig%5B%5Cfrac%7B1%7D%7Bn-1%7D+%5Csum_%7Bi%3D1%7D%5En%5CBig%28X_i+-%5Cbar%7BX%7D%5CBig%29%5E2+%5CBig%5D%3D%5Csigma%5E2" alt="\mathbb{E}\Big[\frac{1}{n-1} \sum_{i=1}^n\Big(X_i -\bar{X}\Big)^2 \Big]=\sigma^2" eeimg="1">.</p>
 <p data-pid="Ub4y7q_F">但是这个答案显然不够直观（教材里面统计学家像变魔法似的不知怎么就得到了上面这个等式）。</p>
 <p data-pid="_5gZU_VV">下面我将提供一个略微更友善一点的解释。</p>
 <p data-pid="JDyXALG-">==================================================================</p>
 <p data-pid="DjjhbUVh">===================== 答案的分割线 ===================================</p>
 <p data-pid="Ioi0BBEE">==================================================================</p>
 <p data-pid="en7aEM7_">首先，我们假定随机变量<img src="https://www.zhihu.com/equation?tex=X" alt="X" eeimg="1">的数学期望<img src="https://www.zhihu.com/equation?tex=%5Cmu" alt="\mu" eeimg="1">是已知的，然而方差<img src="https://www.zhihu.com/equation?tex=%5Csigma%5E2" alt="\sigma^2" eeimg="1">未知。在这个条件下，根据方差的定义我们有</p>
 <p data-pid="XWY5FWaF"><img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5CBig%5B%5Cbig%28X_i+-%5Cmu%5Cbig%29%5E2+%5CBig%5D%3D%5Csigma%5E2%2C+%5Cquad%5Cforall+i%3D1%2C%5Cldots%2Cn%2C" alt="\mathbb{E}\Big[\big(X_i -\mu\big)^2 \Big]=\sigma^2, \quad\forall i=1,\ldots,n," eeimg="1"></p>
 <p data-pid="Y3J3m_lj">由此可得</p>
 <p data-pid="FnQ_Wqmo"><b><img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5CBig%5B%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi%3D1%7D%5En%5CBig%28X_i+-%5Cmu%5CBig%29%5E2+%5CBig%5D%3D%5Csigma%5E2" alt="\mathbb{E}\Big[\frac{1}{n} \sum_{i=1}^n\Big(X_i -\mu\Big)^2 \Big]=\sigma^2" eeimg="1">.<br></b></p>
 <p data-pid="Jumh4Ala"><b>因此<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi%3D1%7D%5En%5CBig%28X_i+-%5Cmu%5CBig%29%5E2+" alt="\frac{1}{n} \sum_{i=1}^n\Big(X_i -\mu\Big)^2 " eeimg="1">是</b><b>方差<img src="https://www.zhihu.com/equation?tex=%5Csigma%5E2" alt="\sigma^2" eeimg="1">的一个无偏估计，注意式中的分母不偏不倚正好是<img src="https://www.zhihu.com/equation?tex=n" alt="n" eeimg="1">！</b></p>
 <p data-pid="cRQtlHJf">这个结果符合直觉，并且在数学上也是显而易见的。</p>
 <p data-pid="PAWNGmKk">现在，我们考虑随机变量<img src="https://www.zhihu.com/equation?tex=X" alt="X" eeimg="1">的数学期望<img src="https://www.zhihu.com/equation?tex=%5Cmu" alt="\mu" eeimg="1">是未知的情形。这时，我们会倾向于无脑直接用样本均值<img src="https://www.zhihu.com/equation?tex=%5Cbar%7BX%7D" alt="\bar{X}" eeimg="1">替换掉上面式子中的<img src="https://www.zhihu.com/equation?tex=%5Cmu" alt="\mu" eeimg="1">。这样做有什么后果呢？后果就是，</p>
 <p data-pid="6t9IgTI0"><b>如果直接使用<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi%3D1%7D%5En%5CBig%28X_i+-%5Cbar%7BX%7D%5CBig%29%5E2+" alt="\frac{1}{n} \sum_{i=1}^n\Big(X_i -\bar{X}\Big)^2 " eeimg="1">作为估计，那么你会倾向于低估方差！</b></p>
 <p data-pid="s-37TlcV">这是因为：</p>
 <p data-pid="kjd5OmI0"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Beqnarray%7D%0A%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28X_i-%5Cbar%7BX%7D%29%5E2+%26%3D%26%0A%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%5CBig%5B%28X_i-%5Cmu%29+%2B+%28%5Cmu+-%5Cbar%7BX%7D%29+%5CBig%5D%5E2%5C%5C%0A%26%3D%26%0A%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28X_i-%5Cmu%29%5E2+%0A%2B%5Cfrac%7B2%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28X_i-%5Cmu%29%28%5Cmu+-%5Cbar%7BX%7D%29%0A%2B%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cmu+-%5Cbar%7BX%7D%29%5E2+%5C%5C%0A%26%3D%26%0A%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28X_i-%5Cmu%29%5E2+%0A%2B2%28%5Cbar%7BX%7D-%5Cmu%29%28%5Cmu+-%5Cbar%7BX%7D%29%0A%2B%28%5Cmu+-%5Cbar%7BX%7D%29%5E2+%5C%5C%0A%26%3D%26%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28X_i-%5Cmu%29%5E2+%0A-%28%5Cmu+-%5Cbar%7BX%7D%29%5E2+%0A%5Cend%7Beqnarray%7D" alt="\begin{eqnarray}
\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2 &amp;=&amp;
\frac{1}{n}\sum_{i=1}^n\Big[(X_i-\mu) + (\mu -\bar{X}) \Big]^2\\
&amp;=&amp;
\frac{1}{n}\sum_{i=1}^n(X_i-\mu)^2 
+\frac{2}{n}\sum_{i=1}^n(X_i-\mu)(\mu -\bar{X})
+\frac{1}{n}\sum_{i=1}^n(\mu -\bar{X})^2 \\
&amp;=&amp;
\frac{1}{n}\sum_{i=1}^n(X_i-\mu)^2 
+2(\bar{X}-\mu)(\mu -\bar{X})
+(\mu -\bar{X})^2 \\
&amp;=&amp;\frac{1}{n}\sum_{i=1}^n(X_i-\mu)^2 
-(\mu -\bar{X})^2 
\end{eqnarray}" eeimg="1"></p>
 <p data-pid="SLLbiyP-">换言之，除非正好<img src="https://www.zhihu.com/equation?tex=%5Cbar%7BX%7D%3D%5Cmu" alt="\bar{X}=\mu" eeimg="1">，否则我们一定有</p>
 <p data-pid="Wwr67Ox7"><img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28X_i-%5Cbar%7BX%7D%29%5E2+%3C%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28X_i-%5Cmu%29%5E2+" alt="\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2 <\frac{1}{n}\sum_{i=1}^n(X_i-\mu)^2 " eeimg="1">,</p>
 <p data-pid="xP8WiAIj">而不等式右边的那位才是的对方差的“正确”估计！</p>
 <p data-pid="xHRw0_mU">这个不等式说明了，为什么直接使用<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi%3D1%7D%5En%5CBig%28X_i+-%5Cbar%7BX%7D%5CBig%29%5E2+" alt="\frac{1}{n} \sum_{i=1}^n\Big(X_i -\bar{X}\Big)^2 " eeimg="1">会导致对方差的低估。</p>
 <p data-pid="I_aDp04b">那么，在不知道随机变量真实数学期望的前提下，如何“正确”的估计方差呢？答案是把上式中的分母<img src="https://www.zhihu.com/equation?tex=n" alt="n" eeimg="1">换成<img src="https://www.zhihu.com/equation?tex=n-1" alt="n-1" eeimg="1">，通过这种方法把原来的偏小的估计“放大”一点点，我们就能获得对方差的正确估计了：</p>
 <p data-pid="k7ySrOqA"><img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5CBig%5B%5Cfrac%7B1%7D%7Bn-1%7D+%5Csum_%7Bi%3D1%7D%5En%5CBig%28X_i+-%5Cbar%7BX%7D%5CBig%29%5E2%5CBig%5D%3D%5Cmathbb%7BE%7D%5CBig%5B%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi%3D1%7D%5En%5CBig%28X_i+-%5Cmu%5CBig%29%5E2+%5CBig%5D%3D%5Csigma%5E2." alt="\mathbb{E}\Big[\frac{1}{n-1} \sum_{i=1}^n\Big(X_i -\bar{X}\Big)^2\Big]=\mathbb{E}\Big[\frac{1}{n} \sum_{i=1}^n\Big(X_i -\mu\Big)^2 \Big]=\sigma^2." eeimg="1"></p>
 <p data-pid="F2jiAtXF">至于为什么分母是<img src="https://www.zhihu.com/equation?tex=n-1%0A" alt="n-1
" eeimg="1">而不是<img src="https://www.zhihu.com/equation?tex=n-2" alt="n-2" eeimg="1">或者别的什么数，最好还是去看真正的数学证明，因为数学证明的根本目的就是告诉人们“为什么”；暂时我没有办法给出更“初等”的解释了。</p>
</body>
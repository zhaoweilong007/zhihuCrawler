# 利用爬虫技术能做到哪些很酷很有趣很有用的事情？
- 点赞数：8463
- 更新时间：2015年05月19日13时18分37秒
- 回答url：https://www.zhihu.com/question/27621722/answer/48177710
<body>
 <p data-pid="wWBGZ-4V">谢邀.</p>
 <p data-pid="5AjcfNf_">2011年夏天我在google实习的时候做了一些Twitter数据相关的开发，之后我看到了一片关于利用twitter上人的心情来预测股市的论文(</p><a href="https://link.zhihu.com/?target=http%3A//battleofthequants.net/wp-content/uploads/2013/03/2010-10-15_JOCS_Twitter_Mood.pdf" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">battleofthequants.net/w</span><span class="invisible">p-content/uploads/2013/03/2010-10-15_JOCS_Twitter_Mood.pdf</span><span class="ellipsis"></span></a>
 <p data-pid="YsHjsayr">)。实习结束后我跟几个朋友聊了聊，我就想能不能自己做一点twitter的数据挖掘，当时只是想先写个爬虫玩玩，没想最后开发了两年多，抓取了一千多万用户的400亿条tweet。</p>
 <p data-pid="5JpcryL1">上<img src="https://www.zhihu.com/equation?tex=%5Cbullet+" alt="\bullet " eeimg="1">分析篇</p>
 <p data-pid="-DPRfevU">先给大家看一些分析结果吧。大家几点睡觉呢? 我们来统计一下sleep这个词在twitter上出现的频率。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/23e22bb4494f54ee56cc2368cc7a566b_720w.jpg?source=1940ef5c" data-rawwidth="702" data-rawheight="405" data-original-token="23e22bb4494f54ee56cc2368cc7a566b" class="origin_image zh-lightbox-thumb" width="702" data-original="https://pic1.zhimg.com/23e22bb4494f54ee56cc2368cc7a566b_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="8MrExGqX">看来很多人喜欢在睡前会说一声我睡了。那我们再看一个更有意思的 :"Thursday"这个词的每天出现的频率。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/431604e4c1697d857f779fd80e402460_720w.jpg?source=1940ef5c" data-rawwidth="674" data-rawheight="426" data-original-token="431604e4c1697d857f779fd80e402460" class="origin_image zh-lightbox-thumb" width="674" data-original="https://picx.zhimg.com/431604e4c1697d857f779fd80e402460_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="UxNNVoGR">这里2月2号是周四，不出意料，这一天提到周四的频率最高。而且好像离周四越近这个频率越高。可是，为什么2月1号的频率反而低了呢？是因为2月1号大家不说周四而说明天了（有的人会说2月2号也可以说是今天，但是因为在2月2号提到当天的次数太高，因此还是有很多人用周四这个词）。</p>
 <p data-pid="MJhts6cB">做了词频统计我们还可以做一些语义分析。我们可以利用unsupervised learning来分析一条tweet的感情色彩。我们对每一条tweet的高兴程度在0至1之间打分，并对每天做平均值，就得到了下面这张图。这里最明显的特征恐怕就是周期性了。是的，大家普遍周末比较高兴。不过这张图的开始和中间有两个点与周期不吻合。如果我告诉你这两天是1月1日和2月14日，那你肯定会想到为什么了，元旦和情人节很多人是很高兴的（不排除slient majority存在的可能）。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/157aeff47a35d8731dcf4f76763f6974_720w.jpg?source=1940ef5c" data-rawwidth="712" data-rawheight="412" data-original-token="157aeff47a35d8731dcf4f76763f6974" class="origin_image zh-lightbox-thumb" width="712" data-original="https://pica.zhimg.com/157aeff47a35d8731dcf4f76763f6974_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="C8okfzx0">这很有意思，但似乎没什么用啊。那我们来看下面这张图，还是2012年的情感分析，不过这里对用户进行了过滤，只保留了来自投资人和交易员的tweet （根据用户的tweet我们可以估计他/她的职业）。蓝线是这些用户的感情色彩，红线是S&amp;P 500指数。看来行情好的时候大家都高兴啊。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/d927c42c39d3165be1716ea513a2b4c5_720w.jpg?source=1940ef5c" data-rawwidth="707" data-rawheight="421" data-original-token="d927c42c39d3165be1716ea513a2b4c5" class="origin_image zh-lightbox-thumb" width="707" data-original="https://pic1.zhimg.com/d927c42c39d3165be1716ea513a2b4c5_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="0KyTF45K">最后我们再来看两个统计图吧。2012年是美国大选年，这里统计了在所有和奥巴马相关的tweet里跟提到经济的tweet占的比例。红线是这个比例，黑线是S&amp;P 500</p>
 <figure>
  <img src="https://picx.zhimg.com/50/09d2fff37b94bc786aa3dbafbfce2a81_720w.jpg?source=1940ef5c" data-rawwidth="683" data-rawheight="372" data-original-token="09d2fff37b94bc786aa3dbafbfce2a81" class="origin_image zh-lightbox-thumb" width="683" data-original="https://picx.zhimg.com/09d2fff37b94bc786aa3dbafbfce2a81_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="x_yfS3Gz">貌似和美国经济有负相关性啊！为什么呢，我们看下面的图就明白了。这个比例和美国失业率正相关，而经济和失业率又是负相关的。换句话说，美国人（尤其是共和党的）找不到工作了就开始埋怨奥巴马了。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/ac10871e9533679eadda21ea14b97e2c_720w.jpg?source=1940ef5c" data-rawwidth="703" data-rawheight="406" data-original-token="ac10871e9533679eadda21ea14b97e2c" class="origin_image zh-lightbox-thumb" width="703" data-original="https://picx.zhimg.com/ac10871e9533679eadda21ea14b97e2c_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="YS4vxokT">除了上面的分析外我做了很多其他的研究，比如如何判断一个用户的职业，验证六度分隔理论, 以及网络扩张速度的建模，不过这里就先不赘述了。</p>
 <p data-pid="2jlhtY1S">最后要说的是以上的分析在统计上都是不严谨的，twitter上的信息杂音非常大，又有很强的demographic bias，有很多因素都没有考虑。我们只能希望大数定律能过弥补一些误差。写在这里只是抛砖引玉，给大家看一下爬虫可以做什么。大家感兴趣的话之后我可以补充一下这两个话题：</p>
 <p data-pid="S6lwDw_L">1. 怎样判断一条tweet的感情色彩</p>
 <p data-pid="DI4-l1Vo">2. 怎样估计一个twitter用户的职业</p>
 <p data-pid="fO7_U6gi">下<img src="https://www.zhihu.com/equation?tex=%5Cbullet+" alt="\bullet " eeimg="1">技术篇</p>
 <p data-pid="-DTBWE9l">当时Twitter用户大概已经有上亿了，每天新的tweet也有几千万甚至上亿。能不能把这些数据全部抓取下来呢？这是可能的。Twitter是有API的，不过每个IP地址每小时可以抓取150个用户最近的tweet，以这个速度要把几亿个用户抓取一遍需要近一百年。但是，大部分Twitter用户是不活跃甚至从来不发tweet的，还有很多用户是印尼等国家（不是他们不重要，我真的看不懂他们发的tweet），如果我们把不说英语，不发tweet以及follow人数不超过5个（好像注册twitter后用户会被要求follow 5个人）的用户过滤掉，我们就剩下了大约10,000,000个用户，十年就可以搞定了。</p>
 <p data-pid="EZhtGbfO">十年好像还是太长了。。。不过twitter的访问限制是基于IP地址的，只要我从多个IP访问twitter不久好了(我真的没有DDOS twitter的意思啊)？那么下一步就是搜集大量代理服务器来访问twitter api。为了做twitter的爬虫我专门做了一个爬虫去搜集免费代理服务器。免费的东西总是有代价的，这些服务器非常不稳定。因此我又建立了一套代理服务器管理系统，定期更新IP地址，删除不能用的服务器。最后这套系统平均每天有几百个可用的服务器，大约半个月就可以把一千万个用户抓取一遍了。</p>
 <p data-pid="3t3NgvAT">此外我又做了一些动态优化，根据twitter用户的follower数量决定他们的抓取频率，以提高重要用户tweet的实时性。</p>
 <p data-pid="QnunkCtd">在一年半的时间里，这套系统一共抓取了400亿条tweet，加起来得有10TB，估计占来自美国tweet数量的一半左右。那么问题来了，怎么存贮这些tweet呢？如果要做分析的话恐怕把数据读一遍就要好几天了。很多人马上会说hadoop, cassandra, spark等等。不过作为一个穷学生我哪里有钱去做一个cluster呢？这些数据存在AWS上就得每月1000刀了。</p>
 <p data-pid="2D5taDEZ">自己动手，丰衣足食。解决方案就是自己组装一个服务器，买了8块3T硬盘做了一个12TB的磁盘矩阵放在寝室里。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/c6825840bd66b91168422cfae89e18cf_720w.jpg?source=1940ef5c" data-rawwidth="578" data-rawheight="408" data-original-token="c6825840bd66b91168422cfae89e18cf" class="origin_image zh-lightbox-thumb" width="578" data-original="https://pica.zhimg.com/c6825840bd66b91168422cfae89e18cf_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="H_7kVZYI">软件使用了最为传统的MySQL，这是一个存了400亿条数据的MySQL数据库。我花了大量时间去做优化，尝试了各种各样的partition, ordering, indexing。最后可以实现一天之内对100-200亿条数据进行线型搜索或过滤，或者几秒钟内调取某一天的或某一条tweet。</p>
 <p data-pid="2i3RllLj">这台服务器现在留在了MIT，毕业后我把它提供给了一位教授做研究。</p>
 <p data-pid="Bhf64RT4">PS:</p>
 <p data-pid="ljwGtjXD">这个项目在2013年停止了，因为social media已经不在火，而且twitter于2013年中关闭了相关的API接口。</p>
 <p data-pid="gNRLcDAc">这个项目的初衷是学术性质的，我不想违反twitter的服务条款，因此这些数据没有被出售或者用来谋求商业价值，而是留给了MIT做研究。</p>
 <p data-pid="EBy4lERY">在这期间与几个朋友进行了很愉快的合作，未征得他们允许就不在此提名了。</p>
 <p data-pid="FQIMUsW2">暂时没有开源的打算，因为当时水平有限，代码写得太丑了（用java写的）。</p>
 <p data-pid="CH785S4Y">PS2：</p>
 <p data-pid="Sy3jPqSP">很多人问怎么找代理服务器，请大家google一下吧。当然如果不能翻墙的话有代理服务器恐怕也不能用。</p>
 <p data-pid="z_vmW8nO">谢绝转载。</p>
</body>
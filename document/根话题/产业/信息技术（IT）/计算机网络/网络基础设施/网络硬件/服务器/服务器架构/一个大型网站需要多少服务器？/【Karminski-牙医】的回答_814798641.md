# 一个大型网站需要多少服务器？
- 点赞数：5131
- 更新时间：2020年07月27日14时04分47秒
- 回答url：https://www.zhihu.com/question/27641736/answer/814798641
<body>
 <p data-pid="7EbXxdT2">我来分享<b>社区型网站</b>的大概服务器需求吧。<br><br>
  不知道各位开发者听没听说过<a href="https://link.zhihu.com/?target=https%3A//juejin.im/" class=" wrap external" target="_blank" rel="nofollow noreferrer">掘金</a><b>, </b>我2016-2019年在掘金担任技术总监(现已离职), 从0开始设计了掘金现有的整体架构 (包括软件架构和硬件基础设施, 所有开发和技术相关的业务均由我负责).<br><br>
  掘金到目前为止(2019-09-06), Alexa 全中国排名为626 (曾经最好成绩在230左右. 作为对比segmentfault是101, OSChina是154), similarweb 全中国排名为399 (作为对比segmentfault是329, OSChina是314). 不知道这样的成绩能不能算是"大型网站".<br><br>
  就业务类型来讲，社区业务本身的复杂性更多是产品功能之间的依赖造成的逻辑复杂。比如你给别人点个赞这个数字要反映到被点赞的文章上，还要给被点赞的作者发送通知，还要把点赞这个动作显示到你的timeline上，还要让关注你的人读取到你的这个动态等等。但说到底只不过是web业务而已。因此CPU，内存，磁盘等资源的使用密度都不算特别显著。</p>
 <h2>线上<br><br></h2>
 <p data-pid="oHUof8v3">我们先定义这个服务器是"一个运行操作系统的实体"吧. 毕竟现在全是虚拟化, 不太好计算到底用了多少物理服务器. <br><br>
  因为全是web业务, 所以相对来说掘金不是很复杂.</p>
 <p data-pid="ThB9Dny0"><br><b>web端 </b>是由 3 个 8core16G 的云服务器组成. 前面接了4个负载均衡每个负载均衡绑定了一裤兜IP用来应对DDoS.<br><br><b>微服务层</b> 由4个 16core32G 的云服务器组成. 同样, 前面也有4个负载均衡.<br><br><b>cronjob(定时任务) </b>2 个 4core 8g云服务器.</p>
 <p data-pid="_Qr0Z_07"><b>数据库</b> 2个MySQL实例(4机), 5个MongoDB实例(总计20机), 14个Redis实例(14机).<br><br><b>中间件</b> zookeeper(6机), kafka(6机), ELK(3机).<br><br><b>大数据</b> CDH全家桶(10机)<br><br><b>杂项</b> 认证服务器, DNS, 冷备份等(6机)<br><br>
  以上就是承载在线业务的所有机器了, 不包含负载均衡等直接提供服务的云服务商实例, <b>总计78个实例</b>. <br><br>
  如果极限压缩的话, 比如数据库不弄的那么复杂, 尽可能复用实例, 砍掉大数据等供运营的组件, 估计40以内实例就能完成一个这样的网站. <br><br>
  也就是说, 实现一个在中国排名500左右(世界大概3000排名左右)的社区网站, 40台服务器差不多可以完成了(当然其他业务类型可能会更多也可能会少一些, 不过一个社区类型的网站, 应该大家都差不多).</p>
 <h2>线下</h2>
 <p data-pid="PA2k-cSm"><br><br>
  但, 这只是冰山的一部分, 我们还有测试环境和日常供工程师使用的本地机房服务器等:<br><br>
  线下CDH全家桶 14 实例<br><br>
  开发用服务器 6 实例</p>
 <p data-pid="XFK-7hvs">代码托管, CI,CD 6 实例<br><br>
  容器环境 16 实例<br><br>
  CEPH 6 实例<br><br>
  数据冷备 3 实例<br><br>
  杂项 6 实例<br><br>
  总计 57 实例.<br><br>
  即最终掘金在用的服务器是 135 实例. 按照 4 实例一台物理机去计算，物理服务器应该在 34 台服务器左右(2个机柜就全装下了).</p>
 <p class="ztext-empty-paragraph"><br></p>
 <h2>一些有意思的事情</h2>
 <p data-pid="wEsHPkjJ"><br><br>
  由于我在这方面比较有经验, 所以从省钱的角度, 我们的<b>本地服务器都是二手服务器</b>。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-4265038fcf5262ec567cc2e9af9dd5da_720w.jpg?source=1940ef5c" data-rawwidth="3024" data-rawheight="4032" data-size="normal" data-original-token="v2-1d49d0e1d04c1b9ca77a8f7796a8acde" data-default-watermark-src="https://pic1.zhimg.com/50/v2-77d0adea55b7ad4e72ef3c636bc31def_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="3024" data-original="https://pica.zhimg.com/v2-4265038fcf5262ec567cc2e9af9dd5da_r.jpg?source=1940ef5c">
  <figcaption>
   我们的本地服务器
  </figcaption>
 </figure>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-523b7d807ef59ffea6678f0883e5daba_720w.jpg?source=1940ef5c" data-rawwidth="3024" data-rawheight="4032" data-size="normal" data-original-token="v2-e25ffa2894eb2ed3b710acbe42e2f383" data-default-watermark-src="https://pic1.zhimg.com/50/v2-200d9a101a17bd0c27b7e2d718e011f4_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="3024" data-original="https://picx.zhimg.com/v2-523b7d807ef59ffea6678f0883e5daba_r.jpg?source=1940ef5c">
  <figcaption>
   得益于虚拟化，50+实例的虚拟机需要的服务器一个小板车就能运走了
  </figcaption>
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-3be80bb8956b9132d60c4716c8d3b988_720w.jpg?source=1940ef5c" data-rawwidth="4032" data-rawheight="3024" data-size="normal" data-original-token="v2-20e0f30acfcb07dc9c0775c2d4f141ff" data-default-watermark-src="https://pic1.zhimg.com/50/v2-7ef735801173e635e958eaa095b0cd5e_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4032" data-original="https://pic1.zhimg.com/v2-3be80bb8956b9132d60c4716c8d3b988_r.jpg?source=1940ef5c">
  <figcaption>
   开机BIOS画面是百度的IBM X3650M4服务器
  </figcaption>
 </figure>
 <p data-pid="uUkqXToc">是的你没看错, 都是淘宝货【手动滑稽】甚至有一台服务器还是百度下架的。<br><br>
  感谢这些行业龙头淘汰的服务器, 对于一个初创公司, 能买到廉价的设备来节省资金实在是一件幸事。当然, 有一个好老板的支持也很重要. 我们在采购服务器这一件事情上就能节约接近30万.</p>
 <p data-pid="289ojHdi">(google在刚开始成立的时候, 也是靠着一大堆二手设备来提供服务的). <br><br></p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-554031bf717e50c0e3c8f48663dcf9dd_720w.jpg?source=1940ef5c" data-rawwidth="731" data-rawheight="1024" data-size="normal" data-original-token="v2-ecccf8a9466cbd961d26cd12bc2ecad6" data-default-watermark-src="https://pic1.zhimg.com/50/v2-2e903254f8a19bd04f72be5afacfabc9_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="731" data-original="https://picx.zhimg.com/v2-554031bf717e50c0e3c8f48663dcf9dd_r.jpg?source=1940ef5c">
  <figcaption>
   google最初的生产用服务器
  </figcaption>
 </figure>
 <p data-pid="tb0JKLk0"><br>
  有的朋友可能会担心用二手服务器会不会出问题？这的确是个隐患，所以我们只在本地使用。线上仍然是直接用云服务。<br><br>
  熟悉我的朋友可能知道，我家里的机器数量其实比我公司的还要多。所以经验方面对我来说不是问题。哈哈。<br><br></p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-9e99d68ab4e14ebd507cc07d26a39c35_720w.jpg?source=1940ef5c" data-rawwidth="1600" data-rawheight="1067" data-size="normal" data-caption="" data-original-token="v2-03efde71e32dbc28703f5104bcd34bbc" data-default-watermark-src="https://pic1.zhimg.com/50/v2-e8c919629959d3e7cf23322ad1943264_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1600" data-original="https://picx.zhimg.com/v2-9e99d68ab4e14ebd507cc07d26a39c35_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="PZFXIRJG"><br><br>
  以上就是我在掘金的实践经验了。</p>
 <h2><br><br>
  其他</h2>
 <p data-pid="gw9IG1S8"><b>搜索业务</b>还是十分吃资源的，我在<b>360搜索</b>的时候, 仅仅用来展示搜索结果的web机，就达到了5机房每机房12机。一二级引擎机器的数量都在几千台以上。<br><br><b>直播业务</b>的就会少一些了，更多是在CDN费用上会更贵。本身的业务不怎么吃机器。以<b>PandaTV</b>举例，在我离开的时候(2016年下旬)，估计机器应该在1000台之内。我负责的数据业务实际上也就一套大一点的CDH全家桶，不到20台机器，以及一些平时用的业务机器，也是20台左右。<br><br>
  以上。</p>
</body>
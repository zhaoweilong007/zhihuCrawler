# 有没有一段代码，让你为人类的智慧击节叫好？
- 点赞数：9205
- 更新时间：2021年10月22日12时44分18秒
- 回答url：https://www.zhihu.com/question/30262900/answer/253192946
<body>
 <p data-pid="b2tyqoEq">分享几个第一次看到就被它的优美深深震撼到的代码：</p>
 <p data-pid="FuElKrZp">1、线性求逆元：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAXN</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">inv</span><span class="p">[</span><span class="n">mod</span><span class="o">%</span><span class="n">i</span><span class="p">],</span> <span class="n">mod</span> <span class="o">-</span> <span class="n">mod</span> <span class="o">/</span> <span class="n">i</span><span class="p">,</span> <span class="n">mod</span><span class="p">);</span>
</code></pre>
 </div>
 <p data-pid="PWSCAc-i">仅仅两行代码，就实现了在$O(n)$的时间内求出1到n对模m的逆元有木有！？</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="8lTrJXDm">2、求最大公因数：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="kt">int</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">y</span> <span class="o">?</span> <span class="n">gcd</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">%</span><span class="n">y</span><span class="p">)</span> <span class="o">:</span> <span class="n">x</span><span class="p">;}</span>
</code></pre>
 </div>
 <p data-pid="dbg4f2rC">第一次接触到这样的代码时，我的内心是这样的：</p>
 <p data-pid="01DbklGy">wtf???黑人问号.jpg</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="BtLZ-vHb">3、树状数组</p>
 <p data-pid="ytSsJuRH">对于单点修改区间求和，树状数组可谓达到了时空复杂度的极限，甚至不多用额外一字节存储空间。来看看它的实现：</p>
 <p data-pid="2q97zUOW">修改：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
	<span class="k">for</span> <span class="p">(;</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
 </div>
 <p data-pid="6o5a8A10">查询：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="kt">int</span> <span class="nf">sum</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(;</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">-=</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="n">ret</span> <span class="o">+=</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
 </div>
 <p data-pid="EqADMSu0">表示记性不好的我看完一遍也记住了呢。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="EfMLO3-e">4、zkw线段树</p>
 <p data-pid="vlieHjbQ">对于单点修改区间查询的线段树，zkw大神实力教你如何1分钟内码出代码：</p>
 <p data-pid="g0gZ7bg-">修改：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="kt">void</span> <span class="nf">set</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">value</span><span class="p">){</span>
	<span class="n">val</span><span class="p">[</span><span class="n">x</span> <span class="o">+=</span> <span class="n">treeLen</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">)</span><span class="n">pushUp</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
 </div>
 <p data-pid="SaVm--NC">查询：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">l</span> <span class="o">+=</span> <span class="n">treeLen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">+=</span> <span class="n">treeLen</span> <span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">l</span> <span class="o">^</span> <span class="n">r</span> <span class="o">^</span> <span class="mi">1</span><span class="p">;</span> <span class="n">l</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">){</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">l</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span><span class="n">ret</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="n">l</span><span class="o">^</span><span class="mi">1</span><span class="p">]);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span><span class="n">ret</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="n">r</span> <span class="o">^</span> <span class="mi">1</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
 </div>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="Q293lsi3">以上都是一些十分基础但真的让你赞不绝口的算法和数据结构。还有一些稍微复杂一些的栗子，由于手机码代码太不方便了，就以后再更吧。（如果有笔误打错的地方欢迎指正哈）</p>
 <p data-pid="G98OrvkT">5、后缀数组的DC3算法，反正学完它的一瞬间我是明白了，天才和普通人的智商差距简直比人和狗还大啊。。。</p>
 <p data-pid="KFxkVhfD">6、快速傅里叶变换的数论版本（即NTT）：学完后有种想去数学系的冲动（还好后来冷静下来了）。费马素数群的性质居然和复数完美吻合，不得不说是一种奇迹啊。</p>
 <p data-pid="xUXaHDWp">7、主席树：这是fotile巨佬考场上发明这种数据结构，用于在$O(log n)$的时间复杂度内解决序列区间第k大问题，以及区间内元素的排名。个人感觉他比划分树的设计巧妙多了，有一种自然的美感。</p>
 <p data-pid="LDKeRytX">8、Pollard因数分解算法：如果你真的把关于时间复杂度的证明一步步看完后，相信你会有一种豁然开朗的感觉。这个算法真正高的地方在于把生日悖论和递推式循环节巧妙的结合在一起，最后运用递推方程主定理的理论，使得时间复杂度达到了看似不可能的期望$n^0.25$的数量级。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="W7vshvfn">其实现在感觉一切和数据结构或数学有关的算法都是非常优美的，前者在于设计的精巧性，后者在于证明的环环相扣，达到引人入胜的效果。</p>
</body>
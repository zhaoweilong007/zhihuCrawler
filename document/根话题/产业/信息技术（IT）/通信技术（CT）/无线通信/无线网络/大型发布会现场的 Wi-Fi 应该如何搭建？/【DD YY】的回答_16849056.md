# 大型发布会现场的 Wi-Fi 应该如何搭建？
- 点赞数：5823
- 更新时间：2013年05月16日18时10分08秒
- 回答url：https://www.zhihu.com/question/20890194/answer/16849056
<body>
 <p data-pid="lVjU6Msw">WiFi网络的部署要远远比一般人想象的复杂，不是说放上几十个AP带宽就自动增加几十倍，恰恰相反，简单放几十个AP带宽会由于AP之间的竞争而迅速使带宽下降为几乎不可用。实际上这个问题完全可以写一本书了，此处只有挂一漏万，简明扼要地讲个大概。对于大型活动做WiFi的规划，要按照这几步来做：</p>
 <ul>
  <li data-pid="0o7ylOZv"><b>情况调查</b>：首先从主办方取得场地大小和人数、分布，包括场地地图。对于网络的规模和部署有个大概的估计。一般来讲要为每个人规划至少1个客户端设备，以往经验值可以按0.5个客户端来规划，由于智能手机和平板的普及，未来估计要往1.5~2个客户端靠拢了。手机和笔记本或者平板电脑有可能同时在上网。
   <figure>
    <img src="https://picx.zhimg.com/50/b1a09e0425d8f0977a125d2fc3c2f9e5_720w.jpg?source=1940ef5c" data-rawwidth="233" data-rawheight="497" data-original-token="b1a09e0425d8f0977a125d2fc3c2f9e5" class="content_image" width="233">
   </figure></li>
  <li data-pid="eF1eA0AF"><b>带宽估计</b>：发布会要保证参与者能正常使用比较轻量级的互联网应用，最基本每个设备要分配500kbps的可用带宽。在这个基础上要考虑大型活动的特点。如果是新闻发布会，那么会有很多人上传视频，带宽分配需要重新考虑，每个人至少有一个设备应保证1Mbps带宽。如果是小组讨论会，那么带宽需求就会小得多。下图是一些典型应用通常需要的带宽。
   <figure>
    <img src="https://picx.zhimg.com/50/42c50eb4a178fbd2cb32ec5f9d53acc7_720w.jpg?source=1940ef5c" data-rawwidth="271" data-rawheight="284" data-original-token="42c50eb4a178fbd2cb32ec5f9d53acc7" class="content_image" width="271">
   </figure></li>
  <li data-pid="4n7NO0as">根据如上两点可以算出每个区域的带宽需求，下一步就是<b>AP规划</b>。虽然11g号称54Mbps带宽，实际可用的最多只有25Mbps，也就是说最多能保证50个设备同时浏览网页（在这个情况下由于客户端相互竞争，用户体验已经非常糟糕了，一般打个对折）。11n对于大部分手机只能保证35Mbps，对于笔记本电脑等支持MIMO的可以保证到70Mbps甚至更高。按照这个原则相应地在图上标出每个AP应该覆盖的区域。为了保证通信质量，为了保证比较好的体验，实际上应该控制每个AP接入的设备不超过刚才计算出的数目的一半。
   <figure>
    <img src="https://pic1.zhimg.com/50/3ffd3674aa5a4000f82deeca86fd640b_720w.jpg?source=1940ef5c" data-rawwidth="233" data-rawheight="497" data-original-token="3ffd3674aa5a4000f82deeca86fd640b" class="content_image" width="233">
   </figure></li>
  <li data-pid="JyFgFeIc">下一步就是<b>分配信道</b>。由于国内只能用2.4GHz的频段，这个频段虽然号称有11个信道（有的国家有13个），实际上只有1，6，11三个互相不重叠的信道可以用。把这三个信道尽可能互不重叠地在上图中覆盖起来（见上图）。有时候如果无法做到不重叠地覆盖，那么还要考虑用扇区天线把覆盖区域细分成几个扇区。
   <figure>
    <img src="https://picx.zhimg.com/50/881314dfe9fdd83e2b2b36d29356c234_720w.jpg?source=1940ef5c" data-rawwidth="1618" data-rawheight="403" data-original-token="881314dfe9fdd83e2b2b36d29356c234" class="origin_image zh-lightbox-thumb" width="1618" data-original="https://picx.zhimg.com/881314dfe9fdd83e2b2b36d29356c234_r.jpg?source=1940ef5c">
   </figure></li>
  <li data-pid="FkUJ78a7">信道分配完成后就要<b>实地部署无线网络</b>了（实际上在上述理论工作之前就应该做实地勘探，考虑墙壁和各种反射物的影响，此处为了简化略去）。部署时应该考虑用高增益天线，但是降低每个AP的发射功率，让其覆盖区域基本与规划的区域吻合。注意这里功率不是越大越好，应该让每个AP只覆盖规划好的区域，别越俎代庖。部署时可能需要用一些现场测量工具对于部署的效果进行评价，防止由于多径干扰出现死角。下图就是用11g部署和11n网络部署后整片区域的差异。红色区域表示覆盖不理想的情况，可以看出11n网络对于多径干扰抑制非常好。再过几年尽量就不要考虑兼容问题，部署时不要开启11g模式了。目前看起来还是需要通过11g接入点自身功率和天线调整，甚至增加额外接入点来弥补。
   <figure>
    <img src="https://picx.zhimg.com/50/b64119f527c300f2cb1cc86358a870a6_720w.jpg?source=1940ef5c" data-rawwidth="980" data-rawheight="372" data-original-token="b64119f527c300f2cb1cc86358a870a6" class="origin_image zh-lightbox-thumb" width="980" data-original="https://pica.zhimg.com/b64119f527c300f2cb1cc86358a870a6_r.jpg?source=1940ef5c">
   </figure></li>
  <li data-pid="vOUpQP52"><b>有线网络规划部署</b>：每个11g的AP应该接入至少百兆上行口，11n的AP应该接入千兆上行口。最后出口也要保证足够上下行带宽，上行传现场资料，下行供大家无聊或者需要查相关资料用，也要按上面第二步计算的总结果的按一定比例保留（取决于活动性质）。若是国内还要考虑多个运营商的出口。</li>
  <li data-pid="Du-x53ZA"><b>SSID的分配</b>：实际上除了少数情况用户实现已经分配好座位，大部分情况没有办法把用户固定在某个AP上，所以更常见的做法是所有AP设置同一个SSID。这里实际上涉及到瘦AP和AP控制器的管理问题，由于各家方案都不相同，就不细数了。<br></li>
  <li data-pid="KahVrOM2"><b>用户认证和带宽控制</b>：为了防止恶意蹭网，最好能对用户做基本的认证，比如凭入场券领取账号名和密码。同时对于每个账号要限制带宽使用，这也会涉及到用户认证和带宽管理，通常需要额外的服务器来处理。</li>
  <li data-pid="snvEy33b"><b>拒绝弱信号客户端接入</b>：谢谢<a class="member_mention" data-editable="true" data-title="@魏冰然" data-hash="f41a86d69b1d71754a2c94b951c556d3" href="https://www.zhihu.com/people/f41a86d69b1d71754a2c94b951c556d3" data-hovercard="p$b$f41a86d69b1d71754a2c94b951c556d3">@魏冰然</a>和<a class="member_mention" data-editable="true" data-title="@曹梦迪" data-hash="0b353e06613f70e18a41b791415dfe5b" href="https://www.zhihu.com/people/0b353e06613f70e18a41b791415dfe5b" data-hovercard="p$b$0b353e06613f70e18a41b791415dfe5b">@曹梦迪</a>，通过和他们互动我觉得这点也非常重要，所以单独补充一下。通过AP测量到的客户端信号强度给客户端分配合适的AP，如果某个AP能接收到客户端信号，但是强度太弱不足以支持某个门限速率，就拒绝客户端从这个AP的接入，防止这个猪一样的队友占有过多带宽（他传1bit时间你能传54bit！），用最低速率把整个AP性能拉低。
   <figure>
    <img src="https://picx.zhimg.com/50/c0a056114e5c6c1e2ed0195c8a56a8af_720w.jpg?source=1940ef5c" data-rawwidth="570" data-rawheight="432" data-original-token="c0a056114e5c6c1e2ed0195c8a56a8af" class="origin_image zh-lightbox-thumb" width="570" data-original="https://pic1.zhimg.com/c0a056114e5c6c1e2ed0195c8a56a8af_r.jpg?source=1940ef5c">
   </figure></li>
 </ul>
 <p data-pid="ve1PjfF-">至此一个较简单的WiFi网络才部署完毕。你给的链接找不到原文，我只能根据新闻说有3000人到场，猜测主办方低估了参会者带宽需求，原因无非是</p>
 <ul>
  <li data-pid="5SO1VjJ_">AP数目不足（应该100个左右，至少50个）</li>
  <li data-pid="JSbqhp47">AP规划不合理（太多包碰撞）</li>
  <li data-pid="wulz04Zd">或者AP崩溃（每个AP接入用户太多）</li>
  <li data-pid="dOp48wHg">或者AP控制器崩溃（无法同时响应这么多AP接入/断开请求）</li>
  <li data-pid="XGQlYQki">或者认证服务器崩溃（无法同时认证这么多用户）</li>
  <li data-pid="GnO9RVQD">或者出口带宽太窄（按我的估计需要至少300MB上行，300MB下行）<br></li>
  <li data-pid="BkaKFDMA">管理混乱（没有控制每个客户端设备流量）。</li>
 </ul>
 <p data-pid="p3Ugk60w">实际上这个发布会远不是最有挑战的无线接入，真正有挑战的是这个：</p><a href="https://link.zhihu.com/?target=http%3A//arstechnica.com/information-technology/2013/02/super-bowl-plans-to-handle-30000-wi-fi-users-at-once-and-sniff-out-rogue-devices/" class=" wrap external" target="_blank" rel="nofollow noreferrer">Super Bowl plans to handle 30,000 Wi-Fi users at once</a>
 <figure>
  <img src="https://pic1.zhimg.com/50/d06425986efa1458b5c13641f3a7bae0_720w.jpg?source=1940ef5c" data-rawwidth="640" data-rawheight="425" data-original-token="d06425986efa1458b5c13641f3a7bae0" class="origin_image zh-lightbox-thumb" width="640" data-original="https://picx.zhimg.com/d06425986efa1458b5c13641f3a7bae0_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Ljd4BD1b">超级碗的主办方需要对付73208个用户，安排了700多个个接入点，能够同时支持30000个连接（比例低一点儿，这么热烈的比赛，用户花在看手机上的时间应该比新闻发布会少得多）。</p>
 <p data-pid="Thffh7EQ">美国人的课堂也很可怕，清一水的苹果笔记本，还不包括他们包包里的平板和手机！！！！！（存疑，</p><a class="member_mention" data-hash="df8eb67f87ceade140b6ab995d047457" href="https://www.zhihu.com/people/df8eb67f87ceade140b6ab995d047457" data-hovercard="p$b$df8eb67f87ceade140b6ab995d047457">@文刀</a>
 <p data-pid="xhFnCuKs">说是WWDC大会的照片）</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/09c6d93e4fee2273f6a88545cdbb7dd3_720w.jpg?source=1940ef5c" data-rawwidth="758" data-rawheight="417" data-original-token="09c6d93e4fee2273f6a88545cdbb7dd3" class="origin_image zh-lightbox-thumb" width="758" data-original="https://picx.zhimg.com/09c6d93e4fee2273f6a88545cdbb7dd3_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="SWUHP5iH">有兴趣的可以看看CIsco的这个报告（PDF格式），</p><a href="https://link.zhihu.com/?target=http%3A//files.meetup.com/1698110/Cisco%252520presentation.pdf" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">files.meetup.com/169811</span><span class="invisible">0/Cisco%2520presentation.pdf</span><span class="ellipsis"></span></a>
</body>
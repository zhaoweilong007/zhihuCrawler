# Vim 有什么奇技淫巧？
- 点赞数：6973
- 更新时间：2019年04月02日21时16分21秒
- 回答url：https://www.zhihu.com/question/27478597/answer/639544215
<body>
 <p data-pid="tbVCAEet">有人用vim纯手打1700页数学笔记。</p>
 <p data-pid="hkGnRUoH">速度紧追老师板书，公式、图形一个不落。效果？请看下图：</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-c035af31f0e2fd432809fb4a52157d1d_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="345" data-original-token="v2-c035af31f0e2fd432809fb4a52157d1d" data-thumbnail="https://pic1.zhimg.com/50/v2-c035af31f0e2fd432809fb4a52157d1d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="640" data-original="https://picx.zhimg.com/v2-c035af31f0e2fd432809fb4a52157d1d_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="g2Wq2EE9">不仅排版媲美教科书，而且还能够批注，检索关键词……</p>
 <p data-pid="sgQQRupZ">笔记被他Po到网上之后，便引来大量围观。</p>
 <p data-pid="YEN2aMFN">不到一天，相关推文就已经有2000多赞，Hacker News论坛上盖了200多楼。</p>
 <p data-pid="81VHCPsT">甚至有网友评论称：“你就是我们需要的英雄！”</p>
 <p data-pid="iA9LWQAt">他是怎么做到的呢？秘密武器就是：<b>LaTeX</b>+<b>Vim</b>！</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-4ee36ef41c17f1ded1fffe13ba32b60d_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="618" data-original-token="v2-4ee36ef41c17f1ded1fffe13ba32b60d" data-thumbnail="https://pica.zhimg.com/50/v2-4ee36ef41c17f1ded1fffe13ba32b60d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="900" data-original="https://pic1.zhimg.com/v2-4ee36ef41c17f1ded1fffe13ba32b60d_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="qSeLD5dF">下面就让我们看一下他完成这一壮举的具体流程，文中提到的工具下载地址，我们都附在了最后。</p>
 <h2><b>快速上手教程</b></h2>
 <p data-pid="k7S7tp5L">我们先看看小哥的工作环境配置。</p>
 <p data-pid="TBUD4GjU">他用Vim编辑LaTeX的场景，就像下面这样：</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-6d5aa3dae43c0991e8f21908226df3b2_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-original-token="v2-6d5aa3dae43c0991e8f21908226df3b2" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic1.zhimg.com/v2-6d5aa3dae43c0991e8f21908226df3b2_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="wJ3Gj2Nr">左边是Vim，右边是pdf阅读器Zathura，它也有类似Vim的快捷键。<br></p>
 <p data-pid="J4IsEEU-">小哥用的操作系统是Ubuntu，使用bspwm作为窗口管理器。在Vim中，使用的LaTex插件是vimtex，它有语法高亮显示、目录视图、同步对象等功能。</p>
 <p data-pid="mLzmG4C1">然后，使用vim-plug做如下配置：</p>
 <div class="highlight">
  <pre><code class="language-powershell"><span class="n">Plug</span> <span class="s1">'lervag/vimtex'</span>
<span class="n">let</span> <span class="n">g:tex_flavor</span><span class="p">=</span><span class="s1">'latex'</span>
<span class="n">let</span> <span class="n">g:vimtex_view_method</span><span class="p">=</span><span class="s1">'zathura'</span>
<span class="n">let</span> <span class="n">g:vimtex_quickfix_mode</span><span class="p">=</span><span class="n">0</span>
<span class="nb">set </span><span class="n">conceallevel</span><span class="p">=</span><span class="n">1</span>
<span class="n">let</span> <span class="n">g:tex_conceal</span><span class="p">=</span><span class="s1">'abdmg'</span>
</code></pre>
 </div>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="yzCSZ1PF">最后两行控制的是“隐藏”功能。开启了这个功能，除了你光标所在的那一行之外，文本里夹杂的LaTeX代码就都会隐藏或者替换成其他符号。<br></p>
 <p data-pid="aFnbW-Iw">比如说在下面动图里，隐藏了[，]，$之后，没有了它们的干扰，整个文档就更易读。这个功能还会用∩替代\bigcap，∈替代\in等等。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-de95087ef0062875cd9a4c0334c689f2_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="192" data-original-token="v2-de95087ef0062875cd9a4c0334c689f2" data-thumbnail="https://picx.zhimg.com/50/v2-de95087ef0062875cd9a4c0334c689f2_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="640" data-original="https://picx.zhimg.com/v2-de95087ef0062875cd9a4c0334c689f2_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="UHV8LEeZ">设置完成，接下来就到了整个教程的精华所在：<br></p>
 <p data-pid="7Vm9dTfO"><b>用LaTeX记笔记，怎么才能像老师写板书一样快？</b></p>
 <p data-pid="9XVLjGv6">这就是片段（snippets）发挥作用地方了。</p>
 <h3><b>片段</b></h3>
 <p data-pid="FeM7Gedl"><b>片段是什么？</b></p>
 <p data-pid="ofCrZgJH">片段是一小段可复用的文本，由其他文本触发。</p>
 <p data-pid="Z3VJsIfY">例如，输入sign，再按下Tab键，这个单词就会自动扩展为一段签名：</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-1ae3bf15602df18504e31ef996bcbf4c_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="192" data-original-token="v2-1ae3bf15602df18504e31ef996bcbf4c" data-thumbnail="https://picx.zhimg.com/50/v2-1ae3bf15602df18504e31ef996bcbf4c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="640" data-original="https://pic1.zhimg.com/v2-1ae3bf15602df18504e31ef996bcbf4c_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="Jz1ZWnYC">片段也可以是动态的：输入today并按下Tab键，它就会变成当前的日期。<br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-18e6cb7440ec2e833780d0fe2feab725_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="192" data-original-token="v2-18e6cb7440ec2e833780d0fe2feab725" data-thumbnail="https://picx.zhimg.com/50/v2-18e6cb7440ec2e833780d0fe2feab725_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="640" data-original="https://pica.zhimg.com/v2-18e6cb7440ec2e833780d0fe2feab725_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="M9k6TZW4">而输入box按Tab，就会出现一个框，还会随着输入文字自动变大。<br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-380e167127080f0a25e849e7e6a6ab4d_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="192" data-original-token="v2-380e167127080f0a25e849e7e6a6ab4d" data-thumbnail="https://picx.zhimg.com/50/v2-380e167127080f0a25e849e7e6a6ab4d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="640" data-original="https://pic1.zhimg.com/v2-380e167127080f0a25e849e7e6a6ab4d_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="t9azAlS-">片段，甚至可以嵌套在另一个片段里用：<br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-cdd1fded48947d163c2e5e6b974cfec0_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-cdd1fded48947d163c2e5e6b974cfec0" data-thumbnail="https://picx.zhimg.com/50/v2-cdd1fded48947d163c2e5e6b974cfec0_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-cdd1fded48947d163c2e5e6b974cfec0_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="UoUk085l"><b>怎么创建片段？使用UltiSnips</b><br></p>
 <p data-pid="Cq-s1FaL">管理片段的插件UltiSnips，小哥是这样配置的：</p>
 <div class="highlight">
  <pre><code class="language-text">Plug 'sirver/ultisnips'
let g:UltiSnipsExpandTrigger = '&lt;tab&gt;'
let g:UltiSnipsJumpForwardTrigger = '&lt;tab&gt;'
let g:UltiSnipsJumpBackwardTrigger = '&lt;s-tab&gt;'
</code></pre>
 </div>
 <p data-pid="etnnYlDO">关于sign片段的代码如下：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet sign "Signature"
Yours sincerely,

Gilles Castel
endsnippet
</code></pre>
 </div>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="wZpqPcEC">对于动态的片段，你可以将代码放在``之间， 在片段扩展的时候，就会运行。下面的例子，就是用 bash 格式化当前日期：date+%f。<br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <div class="highlight">
  <pre><code class="language-text">snippet today "Date"
`date +%F`
endsnippet</code></pre>
 </div>
 <p data-pid="2Sqi9AjH">你也可以在!p ...代码块里使用Python，比如上面box片段的代码就是这样的：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet box "Box"
`!p snip.rv = '┌' + '─' * (len(t[1]) + 2) + '┐'`
│ $1 │
`!p snip.rv = '└' + '─' * (len(t[1]) + 2) + '┘'`
$0
endsnippet
</code></pre>
 </div>
 <p data-pid="nUduYNqC">这些 Python 代码块将被变量 snip.rv 的值替换。在这些代码块中，你可以访问代码段的当前状态，例如t[1]包含第一个制表位，fn是当前文件名等等。<br></p>
 <h3><b>LaTex片段</b></h3>
 <p data-pid="jG7VtOtZ">使用片段编写LaTeX，要比纯手工编写快得多。特别有些非常复杂的片段能帮你大大节约时间，有效防止抓狂。</p>
 <p data-pid="XWVIWphR">下面是一些非常有用且容易上手的片段：</p>
 <p data-pid="SRlOIs2-"><b>环境</b></p>
 <p data-pid="nG49SdyK">想插入一个环境，只需要在一行的开头输入beg。然后键入环境的名称，这个名称在\end{}命令中也是一样。按下Tab键，就能够将光标放置在新创建的环境中。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-e6dc897cbf79432fc387130d18944a93_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="192" data-original-token="v2-e6dc897cbf79432fc387130d18944a93" data-thumbnail="https://picx.zhimg.com/50/v2-e6dc897cbf79432fc387130d18944a93_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="640" data-original="https://picx.zhimg.com/v2-e6dc897cbf79432fc387130d18944a93_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="SqnfuSpL">这个片段的代码如下：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet beg "begin{} / end{}" bA
\begin{$1}
    $0
\end{$1}
endsnippet</code></pre>
 </div>
 <p data-pid="us6LInwR">其中，b表示这个片段只会在代码行的开头展开，A代表自动展开，也就是说不用按Tab键了。制表位(Tab stop)——也就是你可以通过按Tab 和Shift+Tab跳转到的位置——用$1、 $2、......来表示，最后一个用$0。<br></p>
 <p data-pid="QUU0s60n"><b>行内和数学显示</b></p>
 <p data-pid="7yNUmMMf">在记数学笔记的过程中，最常用的两个片段是mk和dm。</p>
 <p data-pid="KZ2qhJyP">它们负责启动数学模式。第一个片段用于“行内数学”，第二个用于“显示数学”。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-12a16b6a90c4d85a887c7cde0f18bb8c_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-12a16b6a90c4d85a887c7cde0f18bb8c" data-thumbnail="https://pic1.zhimg.com/50/v2-12a16b6a90c4d85a887c7cde0f18bb8c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-12a16b6a90c4d85a887c7cde0f18bb8c_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="eHJL-1kv">代码行内的数学片段是“智能的”：它知道什么时候在$符号后面直接输入一个单词，它会自动加个空格。但如果输入一个非单词的字符，它就不会添加空格了，比如在““$p$-value”情况下，是这样的：<br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-1172a1f556fd36b42f7c3642b3952e2c_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-1172a1f556fd36b42f7c3642b3952e2c" data-thumbnail="https://picx.zhimg.com/50/v2-1172a1f556fd36b42f7c3642b3952e2c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-1172a1f556fd36b42f7c3642b3952e2c_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="QWXDQd7u">这个片段的代码如下：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet mk "Math" wA
$${1}$`!p
if t[2] and t[2][0] not in [',', '.', '?', '-', ' ']:
    snip.rv = ' '
else:
    snip.rv = ''
`$2
endsnippet</code></pre>
 </div>
 <p data-pid="GP0yOxhW">第一行末尾的w，意味着这个片段会在单词边界处扩展，例如，hellomk不会扩展，但是hello mk会。<br></p>
 <p data-pid="mfCN08x6">用于显示数学的片段更简单，也更加方便；有了它，你可能再也不会忘记用句号结束方程了。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-403f395ce48935e4750e34568e163d14_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="192" data-original-token="v2-403f395ce48935e4750e34568e163d14" data-thumbnail="https://picx.zhimg.com/50/v2-403f395ce48935e4750e34568e163d14_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="640" data-original="https://picx.zhimg.com/v2-403f395ce48935e4750e34568e163d14_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="lGNKPkGF">代码：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet dm "Math" wA
\[
$1
.\] $0
endsnippet</code></pre>
 </div>
 <p data-pid="8xMfgOkV"><b>小写和上标</b><br></p>
 <p data-pid="2VTeKfAx">另一个很有用的片段就是下标。能够把a1改为a1，把a_12改为a{12}。</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-f26633cb822c6b52d346dfbba6e1a1bd_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-f26633cb822c6b52d346dfbba6e1a1bd" data-thumbnail="https://pic1.zhimg.com/50/v2-f26633cb822c6b52d346dfbba6e1a1bd_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-f26633cb822c6b52d346dfbba6e1a1bd_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="bAonzwHk">这个片段的触发器是使用正则表达式。有两种情况会扩展片段。一是你键入一个字符，后面跟着一个数字，比如[A-Za-z]\d；另一种是，一个字符后面有并跟着两个数字，比如[A-Za-z]\d\d。</p>
 <div class="highlight">
  <pre><code class="language-text">snippet '([A-Za-z])(\d)' "auto subscript" wrA
`!p snip.rv = match.group(1)`_`!p snip.rv = match.group(2)`
endsnippet

snippet '([A-Za-z])_(\d\d)' "auto subscript2" wrA
`!p snip.rv = match.group(1)`_{`!p snip.rv = match.group(2)`}
endsnippet
</code></pre>
 </div>
 <p data-pid="CuHkoCtb">当你使用括号将正则表达式的一部分装在一个组中时，例如(\d\d)，你可以在 Python中通过match.group (i)来使用它们扩展片段。<br></p>
 <p data-pid="d0irEe5c">至于上标，可以使用td，它就会变成^{}。然而，对于平方、立方和其他一些常见的片段，可以使用专门的代码片段，如 sr、cb等等。</p>
 <p data-pid="MA9KUp2Y">效果图：</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-da855cd9e67c48f508fab5ddc8c877fe_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-da855cd9e67c48f508fab5ddc8c877fe" data-thumbnail="https://pic1.zhimg.com/50/v2-da855cd9e67c48f508fab5ddc8c877fe_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://pic1.zhimg.com/v2-da855cd9e67c48f508fab5ddc8c877fe_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="1PaBLzaV">代码：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet sr "^2" iA
^2
endsnippet

snippet cb "^3" iA
^3
endsnippet

snippet compl "complement" iA
^{c}
endsnippet

snippet td "superscript" iA
^{$1}$0
endsnippet</code></pre>
 </div>
 <p data-pid="6Un1dP07"><b>分数</b><br></p>
 <p data-pid="NIfxlpOk">分数是一个用起来最方便的一个片段，扩展的形式如下：</p>
 <p data-pid="qH5SE1zW">/ / → frac {}{}<br>
  3 / → frac {3}{}<br>
  4 pi ^ 2 / → frac {4 pi ^ 2}{}<br>
  (1 + 2 + 3) / → frac {1 + 2 + 3}{}<br>
  (1 + (2 + 3) /)→(1 + frac {2 + 3}{})<br>
  (1 + (2 + 3)) / → frac {1 + (2 + 3)}{</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-3f83f1bdc3078aa16382e80a276f199f_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-3f83f1bdc3078aa16382e80a276f199f" data-thumbnail="https://picx.zhimg.com/50/v2-3f83f1bdc3078aa16382e80a276f199f_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://pic1.zhimg.com/v2-3f83f1bdc3078aa16382e80a276f199f_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="ryExXvsy">第一个片段的代码很简单：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet // "Fraction" iA
\\frac{$1}{$2}$0
endsnippet</code></pre>
 </div>
 <p data-pid="fJ6AO_ac">第二个和第三个示例，可以使用正则表达式来匹配3/、4ac/、6pi^2/、a2/等表达式。<br></p>
 <div class="highlight">
  <pre><code class="language-text">snippet '((\d+)|(\d*)(\\)?([A-Za-z]+)((\^|_)(\{\d+\}|\d))*)/' "Fraction" wrA
\\frac{`!p snip.rv = match.group(1)`}{$1}$0
endsnippet
</code></pre>
 </div>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="bCDR6kDP">看了上边这些，你可能觉得正则表达式太难了。没关系，下面有一个解释得非常直观的图表：<br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-72a240603b093a6bc5bfc8fad594a075_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="661" data-rawheight="168" data-original-token="v2-72a240603b093a6bc5bfc8fad594a075" class="origin_image zh-lightbox-thumb" width="661" data-original="https://picx.zhimg.com/v2-72a240603b093a6bc5bfc8fad594a075_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="c-QCE0IU">在第四和第五种示例下，要换一种方法。使用UltiSnips的正则表达式引擎解决不了的，Python可以：</p>
 <div class="highlight">
  <pre><code class="language-text">priority 1000
snippet '^.*\)/' "() Fraction" wrA
`!p
stripped = match.string[:-1]
depth = 0
i = len(stripped) - 1
while True:
    if stripped[i] == ')': depth += 1
    if stripped[i] == '(': depth -= 1
    if depth == 0: break;
    i -= 1
snip.rv = stripped[0:i] + "\\frac{" + stripped[i+1:-1] + "}"
`{$1}$0
endsnippet</code></pre>
 </div>
 <p data-pid="5-vinM1O">这里最后要分享的关于分数的片段，能根据你的选择，来生成一个分数。<br></p>
 <p data-pid="rqmbx4bw">你可以先选择一些文本，然后按Tab键，继续输入、然后再按Tab键。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-0da01b9566dc437fabf0c563ed14941f_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-0da01b9566dc437fabf0c563ed14941f" data-thumbnail="https://picx.zhimg.com/50/v2-0da01b9566dc437fabf0c563ed14941f_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-0da01b9566dc437fabf0c563ed14941f_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="-N_V_wnc">代码中，使用${VISUAL}变量来表示所选的内容。</p>
 <div class="highlight">
  <pre><code class="language-text">snippet / "Fraction" iA
\\frac{${VISUAL}}{$1}$0
endsnippet
</code></pre>
 </div>
 <p data-pid="eiWyuZOc"><b>Sympy和Mathematica</b><br></p>
 <p data-pid="s5Kpu6mr">还有一个很酷但用得不多的片段，是使用Sympy来计算数学表达式。例如，输入sympy，然后按下Tab，可以扩展为sympy | sympy，输入sympy 1 + 1 sympy，按下Tab，可以扩展为2。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-8c8f143fdcdc2f3e6de9853cf7ea3def_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-8c8f143fdcdc2f3e6de9853cf7ea3def" data-thumbnail="https://picx.zhimg.com/50/v2-8c8f143fdcdc2f3e6de9853cf7ea3def_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://pica.zhimg.com/v2-8c8f143fdcdc2f3e6de9853cf7ea3def_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="mBikGKQW">片段代码：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet sympy "sympy block " w
sympy $1 sympy$0
endsnippet

priority 10000
snippet 'sympy(.*)sympy' "evaluate sympy" wr
`!p
from sympy import *
x, y, z, t = symbols('x y z t')
k, m, n = symbols('k m n', integer=True)
f, g, h = symbols('f g h', cls=Function)
init_printing()
snip.rv = eval('latex(' + match.group(1).replace('\\', '') \
    .replace('^', '**') \
    .replace('{', '(') \
    .replace('}', ')') + ')')
`
endsnippet</code></pre>
 </div>
 <p data-pid="qFfhAYPt">用Mathematica，也可以做类似的事情：</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-82f7f187a685a52ed7665fded563f936_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-82f7f187a685a52ed7665fded563f936" data-thumbnail="https://pic1.zhimg.com/50/v2-82f7f187a685a52ed7665fded563f936_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-82f7f187a685a52ed7665fded563f936_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="SbEv_0Xc">片段代码：</p>
 <div class="highlight">
  <pre><code class="language-text">priority 1000
snippet math "mathematica block" w
math $1 math$0
endsnippet

priority 10000
snippet 'math(.*)math' "evaluate mathematica" wr
`!p
import subprocess
code = 'ToString[' + match.group(1) + ', TeXForm]'
snip.rv = subprocess.check_output(['wolframscript', '-code', code])
`
endsnippet</code></pre>
 </div>
 <p data-pid="axEqF6W6"><b>后缀片段</b><br></p>
 <p data-pid="9Zo9TzBN">除了上边这些之外，后缀片段也很值得分享。例如phat→hat{p}和zbar→overline{z}。还有类似的后缀向量，例如v,.→vec{v}和v.,→vec{v}。.和,的顺序没关系，所以可以同时按下它们两个。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-7c2e62aae292bc4d65eae363c816e206_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-7c2e62aae292bc4d65eae363c816e206" data-thumbnail="https://pic1.zhimg.com/50/v2-7c2e62aae292bc4d65eae363c816e206_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://pic1.zhimg.com/v2-7c2e62aae292bc4d65eae363c816e206_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="QAR-8HRR">这些片段真的可以节省时间，可以按照和老师写板书一样的顺序来记。</p>
 <p data-pid="ITJ48iDM">注意，bar和hat前缀也依然可以用，只要以较低的优先级添加它们就行。</p>
 <p data-pid="rmTHD2on">这些片段的代码是：</p>
 <div class="highlight">
  <pre><code class="language-text">priority 10
snippet "bar" "bar" riA
\overline{$1}$0
endsnippet

priority 100
snippet "([a-zA-Z])bar" "bar" riA
\overline{`!p snip.rv=match.group(1)`}
endsnippet
</code></pre>
 </div>
 <p class="ztext-empty-paragraph"><br></p>
 <div class="highlight">
  <pre><code class="language-text">priority 10
snippet "hat" "hat" riA
\hat{$1}$0
endsnippet

priority 100
snippet "([a-zA-Z])hat" "hat" riA
\hat{`!p snip.rv=match.group(1)`}
endsnippet
</code></pre>
 </div>
 <p class="ztext-empty-paragraph"><br></p>
 <div class="highlight">
  <pre><code class="language-text">snippet "(\\?\w+)(,\.|\.,)" "Vector postfix" riA
\vec{`!p snip.rv=match.group(1)`}
endsnippet </code></pre>
 </div>
 <p data-pid="9B6pWn8R"><b>其他片段</b><br></p>
 <p data-pid="YXFxKILX">此外，小哥还有大约100个常用的片段（下载地址附于文末），大多数都很简单。比如，输入!&gt;变成\mapsto，输入-&gt;变成\to等等。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-4ee36ef41c17f1ded1fffe13ba32b60d_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="900" data-rawheight="618" data-original-token="v2-4ee36ef41c17f1ded1fffe13ba32b60d" data-thumbnail="https://pic1.zhimg.com/50/v2-4ee36ef41c17f1ded1fffe13ba32b60d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="900" data-original="https://picx.zhimg.com/v2-4ee36ef41c17f1ded1fffe13ba32b60d_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="GAQWahZZ">fun变成f: \R \to \R :，!&gt;变成\mapsto，-&gt;变成\to，cc变成\subset。<br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-a45092c95d91059b779f74cedda840e1_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="903" data-rawheight="621" data-original-token="v2-a45092c95d91059b779f74cedda840e1" data-thumbnail="https://pic1.zhimg.com/50/v2-a45092c95d91059b779f74cedda840e1_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="903" data-original="https://picx.zhimg.com/v2-a45092c95d91059b779f74cedda840e1_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="dV6XjCSv">lim变成\lim{n \to \infty}，sum变成\sum{n = 1}^{\infty}，ooo变成\infty。<br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-2be9c99e6ab5787fc5196bbf4ce525a7_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="904" data-rawheight="622" data-original-token="v2-2be9c99e6ab5787fc5196bbf4ce525a7" data-thumbnail="https://pica.zhimg.com/50/v2-2be9c99e6ab5787fc5196bbf4ce525a7_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="904" data-original="https://pic1.zhimg.com/v2-2be9c99e6ab5787fc5196bbf4ce525a7_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-3be522f5e6e5ca7f871138732ba1b14d_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="902" data-rawheight="617" data-original-token="v2-3be522f5e6e5ca7f871138732ba1b14d" data-thumbnail="https://pica.zhimg.com/50/v2-3be522f5e6e5ca7f871138732ba1b14d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="902" data-original="https://picx.zhimg.com/v2-3be522f5e6e5ca7f871138732ba1b14d_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="ilbHDsVc"><b>特定课程的片段</b><br></p>
 <p data-pid="Nngpd6s0">除了一些常用的片段，也可以针对特定的课程设定片段。例如，在量子力学这门课中，可以设定一些关于bra/ket符号的片段。</p>
 <p data-pid="M-iZcm5v">&lt;a|→\bra{a} &lt;ψ|→\bra{\psi}="" a=""&gt;→\ket{a}<br>
  |ψ&gt;→\ket{\psi}<br>
  →\braket{a}{b}</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-268d331fdb83b6fa3563b6f2b0baac66_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-268d331fdb83b6fa3563b6f2b0baac66" data-thumbnail="https://pic1.zhimg.com/50/v2-268d331fdb83b6fa3563b6f2b0baac66_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-268d331fdb83b6fa3563b6f2b0baac66_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="Xp9ew-nU">代码：</p>
 <div class="highlight">
  <pre><code class="language-text">snippet "\&lt;(.*?)\|" "bra" riA
\bra{`!p snip.rv = match.group(1).replace('q', f'\psi').replace('f', f'\phi')`}
endsnippet

snippet "\|(.*?)\&gt;" "ket" riA
\ket{`!p snip.rv = match.group(1).replace('q', f'\psi').replace('f', f'\phi')`}
endsnippet

snippet "(.*)\\bra{(.*?)}([^\|]*?)\&gt;" "braket" riA
`!p snip.rv = match.group(1)`\braket{`!p snip.rv = match.group(2)`}{`!p snip.rv = match.group(3).replace('q', f'\psi').replace('f', f'\phi')`}
endsnippet</code></pre>
 </div>
 <p data-pid="-mBYx_7L"><b>上下文</b><br></p>
 <p data-pid="CHQauqkL">在编写这些片段时需要考虑的一件事是,“这些片段会与长与常用的文本冲突吗?”</p>
 <p data-pid="RuzLl7Ao">例如，在英语中大约有72个单词包含sr，这意味着当输入disregard这个词时，sr会扩展到^2，出现一个di^2egard。</p>
 <p data-pid="rdGCCk8U">这个问题的解决方案是，为代码片段添加上下文。</p>
 <p data-pid="XFjBdsk3">通过使用 Vim 的语法突出显示，可以确定UltiSnips是否应该扩展片段，这取决于你使用的是数学还是文本。</p>
 <div class="highlight">
  <pre><code class="language-text">global !p
texMathZones = ['texMathZone'+x for x in ['A', 'AS', 'B', 'BS', 'C',
'CS', 'D', 'DS', 'E', 'ES', 'F', 'FS', 'G', 'GS', 'H', 'HS', 'I', 'IS',
'J', 'JS', 'K', 'KS', 'L', 'LS', 'DS', 'V', 'W', 'X', 'Y', 'Z']]

texIgnoreMathZones = ['texMathText']

texMathZoneIds = vim.eval('map('+str(texMathZones)+", 'hlID(v:val)')")
texIgnoreMathZoneIds = vim.eval('map('+str(texIgnoreMathZones)+", 'hlID(v:val)')")

ignore = texIgnoreMathZoneIds[0]

def math():
    synstackids = vim.eval("synstack(line('.'), col('.') - (col('.')&gt;=2 ? 1 : 0))")
    try:
        first = next(
            i for i in reversed(synstackids)
            if i in texIgnoreMathZoneIds or i in texMathZoneIds
        )
        return first != ignore
    except StopIteration:
        return False
endglobal</code></pre>
 </div>
 <p data-pid="w5cnp8in">现在，你可以将context “math()”添加到只希望在数学上下文中展开的片段中。</p>
 <div class="highlight">
  <pre><code class="language-text">context "math()"
snippet sr "^2" iA
^2
endsnippet</code></pre>
 </div>
 <p data-pid="pc0DqUF3">请注意,“数学上下文”是一个微妙的东西。 有时你可以使用\text{…}在数学环境中添加一些文本。在这种情况下，你不需要扩展片段。但是，在以下情况下: \[ \text{$...$} \]，它们可以扩展。 这就是为什么math上下文的代码有点复杂。下面的动图说明了这些微妙之处。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-e1b3ca2dd4fc1f5fe39679fb6ba38aad_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1012" data-rawheight="304" data-original-token="v2-e1b3ca2dd4fc1f5fe39679fb6ba38aad" data-thumbnail="https://picx.zhimg.com/50/v2-e1b3ca2dd4fc1f5fe39679fb6ba38aad_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1012" data-original="https://picx.zhimg.com/v2-e1b3ca2dd4fc1f5fe39679fb6ba38aad_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="or8hS55i">除了上述一些片段，你也可以根据自己的需要，来自己添加一些插件或者片段，来提高自己的效率。<br></p>
 <h2><b>用笔还是用电脑？</b></h2>
 <p data-pid="DdHK1l2A">纯手打记下1700页数学笔记，awesome都不够形容了这位小哥了，堪称理工科学生中的“英雄”。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-6adb89f2d69ea608381bd7fea1df0f5a_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="766" data-rawheight="218" data-original-token="v2-6adb89f2d69ea608381bd7fea1df0f5a" class="origin_image zh-lightbox-thumb" width="766" data-original="https://picx.zhimg.com/v2-6adb89f2d69ea608381bd7fea1df0f5a_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="ggkXsJPe">并非所有人都赞同小哥的做法，强大的高科技工具在传统面前常常会被质疑。</p>
 <p data-pid="L8mTc_pp">有部分网友认为手写比电脑打字印象深刻，而且要达到这位小哥的熟练程度，恐怕LaTeX和Vim得练习好几年。</p>
 <p data-pid="HLnpCsE9">既然用笔更方便，为什么还要用电脑来记笔记呢？原因很简单：字太丑！</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-d2eb7dfc8ff1fd82232021a2ee05adc2_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="155" data-original-token="v2-d2eb7dfc8ff1fd82232021a2ee05adc2" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic1.zhimg.com/v2-d2eb7dfc8ff1fd82232021a2ee05adc2_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="F8ums_nM">如果记下来的内容连自己看的欲望都没有，怎么复习课堂笔记呢？至少用电脑记下来的排版工整，让人赏心悦目。</p>
 <p data-pid="BYAVFtWA">虽然国外网友争论不休，但在国内只要一个条件就可以彻底否决这个方法：不让带电脑进课堂。</p>
 <p data-pid="7IuN_P_4">对此，你怎么看？</p>
 <h2><b>工具传送门：</b></h2>
 <p data-pid="faPtNlMS">Linux和Mac系统自带Vim。</p>
 <p data-pid="nHK_QIkP">Windows用户安装Vim：<br><a href="https://link.zhihu.com/?target=https%3A//ftp.nluug.nl/pub/vim/pc/gvim81.exe" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">ftp.nluug.nl/pub/vim/pc</span><span class="invisible">/gvim81.exe</span><span class="ellipsis"></span></a></p>
 <p data-pid="BhMg4-GS">Vim插件管理：<br><a href="https://link.zhihu.com/?target=https%3A//github.com/junegunn/vim-plug" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/junegunn/vim</span><span class="invisible">-plug</span><span class="ellipsis"></span></a></p>
 <p data-pid="9c8tzuwj">Vim上的LaTeX插件：<br><a href="https://link.zhihu.com/?target=https%3A//github.com/lervag/vimtex" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/lervag/vimte</span><span class="invisible">x</span><span class="ellipsis"></span></a></p>
 <p data-pid="Uww8ydWl">窗口平铺管理器：<br><a href="https://link.zhihu.com/?target=https%3A//github.com/baskerville/bspwm" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/baskerville/</span><span class="invisible">bspwm</span><span class="ellipsis"></span></a></p>
 <p data-pid="KrCs5xEn">管理Vim片段工具：<br><a href="https://link.zhihu.com/?target=https%3A//github.com/SirVer/ultisnips" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/SirVer/ultis</span><span class="invisible">nips</span><span class="ellipsis"></span></a></p>
 <p data-pid="MyouADqh">LaTeX常见数学符号输入方法：<br><a href="https://link.zhihu.com/?target=https%3A//en.wikibooks.org/wiki/LaTeX/Mathematics" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">en.wikibooks.org/wiki/L</span><span class="invisible">aTeX/Mathematics</span><span class="ellipsis"></span></a></p>
 <p data-pid="OARo_TPj">想要熟悉更多的LaTeX使用方法，就需要系统地学习，平时多加练习也必不可少。</p>
 <p data-pid="_i0aUAv5">博文链接：</p><a href="https://link.zhihu.com/?target=https%3A//castel.dev/post/lecture-notes-1/" data-draft-node="block" data-draft-type="link-card" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">castel.dev/post/lecture</span><span class="invisible">-notes-1/</span><span class="ellipsis"></span></a>
 <p data-pid="RSFi1wQT">— <b>完</b> —</p>
 <p data-pid="tCfFiLCS">量子位 · QbitAI<br>
  վ'ᴗ' ի 追踪AI技术和产品新动态</p><a href="https://www.zhihu.com/org/liang-zi-wei-48" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-ca6e7ffc10a0d10edbae635cee82d007_ipico.jpg" data-image-width="250" data-image-height="250" class="internal">量子位</a>
 <p data-pid="h4ctefxM">欢迎大家关注我们，以及订阅<a href="https://zhuanlan.zhihu.com/qbitai" class="internal">我们的知乎专栏</a></p>
</body>
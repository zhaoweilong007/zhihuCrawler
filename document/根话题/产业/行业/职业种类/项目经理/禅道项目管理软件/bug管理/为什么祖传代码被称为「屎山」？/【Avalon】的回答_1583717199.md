# 为什么祖传代码被称为「屎山」？
- 点赞数：5795
- 更新时间：2022年02月07日15时32分30秒
- 回答url：https://www.zhihu.com/question/272065178/answer/1583717199
<body>
 <p data-pid="gJYTrvYA">有网友觉得我们技术总监水平太差，搞个脚本都要好几天，是什么野鸡总监……</p>
 <p data-pid="VPynlEe5">这就不得不提到屎山里的另一个大坑，最初大家想的很简单，从生产上拿一份数据放到本地库里，再修改一下代码逻辑循环生成合同……但尴尬的是我们svn上的合同模板和生产上的不一样！</p>
 <p data-pid="cMn2LPF8">进操作间动生产数据不是吗那么容易的……大量的时间都浪费在和甲方勾心斗角上，留给写脚本、测试脚本的时间并不多……</p>
 <hr>
 <p data-pid="_WxWW2PB">说一个亲身经历的一座「屎山」，曾入职一家成立15年的软件公司，我当时应聘的是中级程序员，但在入职几个月后，我的岗级和薪资调整到了高级程序员，这并不是因为我在这几个月中技术水平跨越式提升，而是因为这三个月中发生了以下事情：</p>
 <p data-pid="PAvCvMP5">前任组员一号和我完成交接之后<b>跑路了</b>！<br>
  前任组长和新招来的组长交接之后<b>跑路了</b>！<br>
  前任组员二号和新招来的初级程序员交接之后<b>跑路了</b>！<br>
  新任组长和我交接之后<b>跑路了</b>！<br>
  新人组员（女）在工位掩面痛哭之后，<b>换组了！</b>（捂着脸掉眼泪不发出声音的那种哭）<br>
  组内人手严重不足，我白天解决生产bug，晚上写新需求！</p>
 <p data-pid="AQQ8iLHf">这是一座年轻的「屎山」，我是第三批接手者，历时几个月后我成了项目组中，资历最老的员工！实习生和初级程序员写出来的bug和低级错误我就忍了，都是从菜鸟过来的，勉强可以理解。</p>
 <p data-pid="oalP602E">但是框架因为“高程”、“架构组”、“大手子”等人的填填补补，已经到了严重影响用户体验的程度！！！</p>
 <p data-pid="wwoGrBu6"><b>For example！</b>当时项目的工作流很奇葩，不论出现什么错误，都会统一提示“发生未知错误”。哪怕我照着“公司祖传框架使用手册”，在配置中填写「核算系统接口调用失败」、「当前时间不允许操作」、「xxx号风险模型校验失败」等提示信息，但客户用的时候还是统一提示“发生未知错误”！</p>
 <p data-pid="7YdmCajI">起初因为运维人员每天都在帮客户解决这种问题，客户倒是没有多大的怨气。某一天，因为很复杂的原因，客户为了此事大发雷霆，我被要求解决这个问题。</p>
 <p data-pid="UHh7IKZE">在一顿忙碌之后，问题定位到了一个公司自己封装的jar包，反编译后发现里面的逻辑有问题。我就联系外地的架构组，让他们给我一个新的jar包，第二天我收到了回复：“这个框架很早就重构了，公司新框架不兼容老框架，使用老框架的项目都交给项目组自己维护了，你们项目组的框架应该是xxx在维护。”</p>
 <p data-pid="g2WG8u-p">xxx是一个很陌生的名字，几番打听之后才知道，xxx是我们组的第一任组长，离职两年多了！我只能在svn上继续摸索，愣是没有找到jar包的源码。几经波折之后才知道，svn之前是几个外包厂商共用的，后来因为外包厂商多了，就给每个厂商重新配置了一个svn，迁移的时候这个jar包的源码因为没有厂商认领，就被丢到了公用的svn上。</p>
 <p data-pid="gjsqJgq5">然而故事并没有结束，从公用svn找到的源码，和我通过反编译出来的代码，很多地方对不上！源码里的注释在我眼中都变成了「年轻人，千万不要动这坨屎！」</p>
 <p data-pid="disUKLZ-">最后我只能在工作流外面，又封装了一套组件，专门用于代替工作流提示信息，并且留下了一行注释「<b>如果你不幸看到了这行注释，不要怪我，我也不想的！</b>」</p>
 <hr>
 <p data-pid="Bbn4cBCg">以上只是「屎山」一角，「屎」是因为祖传代码里面有很多问题是真的臭，「山」是因为屎太多了。最讽刺的是，你可能为了治理「屎山」，也在里面拉了几次「屎」......</p>
 <hr>
 <p data-pid="S7xbi6zn">昨天答完问题，晚上做梦梦到了当时做项目填坑的苦逼生活，<b>气醒了！！！</b>今天再跟大家分享一个关于这座「屎山」的一角。</p>
 <p data-pid="_dvIrpam">项目组负责的几个系统中，有一个负责放款的系统（<b>前置业务系统，并不涉及记账和转款</b>），放款是甲方爸爸非常核心的功能之一，上线之前肯定是重点测试的，所以我接手的时候已经平稳运行了数年。接手之后也没有出什么问题，整个放款业务也没有什么新需求，我也就没有深入研究，直到那一天......</p>
 <p data-pid="WyL86fRn">背景是甲方爸爸接了个一个大单，但是因为量太大，其中几笔合同的合同号录差了，导致纸质合同和线上合同对不上，甲方爸爸就找到了我们组的一个组员去做数据处理。处理了一下午，线上合同的合同号还是没有变，组员来找我的时候已经满头大汗，我心中隐隐猜到，又要踩屎了。</p>
 <p data-pid="Jj6Fl6KP">我发现组员按照数据库文档修改了合同号，但是系统上还是显示旧合同号。因为已经踩了几次屎，我就直接去翻代码了。然后大量“中文拼音”命名的变量和无数意义不明的注释，看的我太阳穴一跳一跳的。</p>
 <p data-pid="u7nEBv9u">原来生成电子合同功能跟我们<b>想象</b>的不太一样，在完成放款操作时系统会生成一个以合同信息主键（36位UUID）命名的PDF存在<b>本地，</b>每一次点击下载合同其实就是根据主键ID下载这个文件，所以数据库里不论怎么修改对电子合同都没有影响，当时捋明白这个逻辑的时候我惊出了一身冷汗，但并不是因为这个设计多么的反人类......</p>
 <p data-pid="4X2-xoSK"><b>前方高能！！！前方高能！！！前方高能！！！</b></p>
 <p data-pid="Jtbe3Uzy">前任运维人员交接的时候，说放款系统上线一年没啥问题，唯一要注意的就是因为与外部系统交互产生的交易文件很多，所以要定时<b>清理</b>，还当着我的面，删掉了一批日期比较早的文件。操作生产环境有指定的电脑，那台电脑上看pdf文件是没有后缀的，图标也是一张白纸，加上当时在场的人也都没有太在意，根本没有发现这些“交易文件”不太对劲。看着大概就长下面这样，谁也没有好奇的去看看里面是什么。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-0bd3b16ff251a6245dddeb9c429d9f2e_720w.jpg?source=1940ef5c" data-rawwidth="598" data-rawheight="53" data-size="normal" data-caption="" data-original-token="v2-0bd3b16ff251a6245dddeb9c429d9f2e" class="origin_image zh-lightbox-thumb" width="598" data-original="https://picx.zhimg.com/v2-0bd3b16ff251a6245dddeb9c429d9f2e_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="PqXbGF8H"><b>所以新任运维人员会定期去删除老旧文件，也就是以前的电子合同！！！</b></p>
 <p data-pid="zbW-vkye">我当时就给技术总监和项目经理打电话，三个大老爷们大半夜跑到单位附近的肯德基研究对策。好在数据都在数据库里，技术总监捅咕了几天，写出来个脚本把所有被删的文件重新生成了一遍。但是服务器空间不够又传不上去，就跟甲方爸爸说电子合同这块设计不够完善（<b>前任技术总监背锅</b>），我们想要优化一下，不要钱的那种。</p>
 <p data-pid="IjutfmDg">“事故”尘埃落定之后，项目经理想要追责却发现这锅只能他自己背，除了他全都是后来的......</p>
 <p data-pid="HwCVk5jy">在那个公司干了一年多，工资涨了三次，但我还是离职了，毕竟「屎」是真的难吃......当我把项目交接出去的时候，我就想起我在项目里留下的注释（屎），露出了和（幸）蔼（灾）亲（乐）切（祸）的笑容。</p>
 <hr>
 <p data-pid="YIJHI6i7">知乎第一个过百的评论，心情十分复杂[捂脸哭]</p>
 <p data-pid="BhyjEiB6">评论区很多朋友提出重构或重写系统，关于这一点本苦逼打工人又要吐槽了！</p>
 <p data-pid="TJjw3zse">曾经在某一个外包项目上苦苦挣扎了一年半，除了春节基本没完整休过节假日，精神和肉体都处在崩溃的边缘，一度准备离职。项目经理苦口婆心地挽留我，发生了如下对话：</p>
 <p data-pid="5RA_qoa1">“小孙啊，这个项目明年就要重写了，到时候你就是这个业务条线的leader，其他公司哪有这个机会。”<br><b>（别走啊，现在这个摊子磨走了多少人，就你钱要得最少还干得最长）</b></p>
 <p data-pid="EDTgUbbq">“我敲代码还行，我这年纪轻轻的当不了领导，而且重写项目这事说了一年了，也没看到动静。”<b>（当时参与系统原始需求的甲方，要么高升要么跳槽了，重写个鸡儿，那就是新做个系统！别以为我不知道，就是因为价钱没谈拢，重写的事儿才一直没开工，不要给我画大饼！）</b></p>
 <p data-pid="JpYVkP8h">“那你再等半年，年底往上申报调薪的时候，我给你多涨点，你要是不满意再走也不迟，现在这时间段工作也不好找。”<br><b>（年底先给你涨500，现在这时间段人不好招，等年后招来人了，谁还管你走不走。）</b></p>
 <p data-pid="wYVrodjd">“现在工作还挺好找的吧，已经谈好两个下家了，薪资都比现在高不少。”<br><b>（别跟我画饼！）</b></p>
 <p data-pid="C3pGeEYJ">“你这是早就准备好了啊？不再考虑考虑？”<br><b>（年轻人不讲武德！再给你最后一次机会，耗子尾汁！）</b></p>
 <p data-pid="OSTouhGM">“也考虑挺长时间了，可能是我不适合这份工作吧，希望公司能越做越好。”<br><b>（绿水青山，永不相见！垃圾公司，赶紧倒闭！）</b></p>
 <p data-pid="L8xTlB6f"><b>很多系统是不具备重构、重写条件的，原始需求早就没有影了，能找到操作手册都算是不错了。总不能让程序员根据屎山倒推需求吧，那得推出个啥来？！</b></p>
 <p data-pid="M5ZWg3hE">最后脱离苦海，摆脱了一座屎山！后来找工作的时候，就尽量避免外包了，外包公司的屎山是最高最臭的，因为上面拉屎的人来自天南海北！</p>
</body>
# 如何自己制作一个 divergense meter（辉光管时钟）？
- 点赞数：6328
- 更新时间：2020年07月11日14时36分00秒
- 回答url：https://www.zhihu.com/question/34564116/answer/595153466
<body>
 <p data-pid="VQWJ2O8t">2019.2.25更新<br>
  竟然3K赞了，那就回答一下大家的问题吧。</p>
 <ol>
  <li data-pid="TzQgNv2T">哪里买的到/答主卖不卖？</li>
 </ol>
 <p data-pid="zRqaQ4tT">Emmmmm...这个东西是在圣诞节和新年假期里挤时间弄的，平时答主天天忙着搬砖没时间......所以不会再做，也不考虑量产或者商业合作之类的。因为TB上有很多比答主强一万倍的成品可以买得到。</p>
 <p data-pid="N5-hHNYa">2. 成本多少？</p>
 <ul>
  <li data-pid="c_ubG-B4">PCB打样是300（沉金会贵一点，5块起做）</li>
  <li data-pid="l2Sqx1bt">外壳是35（亚克力定做+螺丝之类的）</li>
  <li data-pid="O1mnl1MV">元器件总共大概是100吧</li>
  <li data-pid="NWWwUDVS">IN-14辉光管是400（6个）</li>
 </ul>
 <p data-pid="XlZSOnBu">所以差不多就是800RMB左右的样子。</p>
 <p data-pid="Fj4-W2a2">3. 要学点啥才能做这个？</p>
 <ul>
  <li data-pid="L9_o9-s9">模拟/数字电路基础。最起码得知道boost电路是什么，PWM是怎么回事。</li>
  <li data-pid="-ZsGAegA">C语言。</li>
  <li data-pid="79ClGrrX">软件的熟练使用。像绘制原理图/PCB的AD，嵌入式开发的Keil，外壳设计的CAD等。</li>
  <li data-pid="DZ5KAQaP">焊接基础。像多引脚的stm32，或者是0603封装的阻容件。要焊好它们还是需要一点点基础的。</li>
 </ul>
 <p data-pid="7EizZAAe">Emmmmm...如果你不想追求原理上的东西的话，我觉得只要能熟练操作各类软件，<b>熟练github的搜索功能</b>加上基本的焊接就能做了。但是想要实现一些个性化的软件模式/硬件设计还是得学一学的。</p>
 <hr>
 <p data-pid="TWdCT_QZ">别收藏了，喜欢就点个赞呗！！</p>
 <hr>
 <p data-pid="q_ag83WV">关于辉光管本身就不做介绍了，其他答案已经描述的很详尽了。</p>
 <p data-pid="yBcnUCOG">先上完成图~</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-7c3a6d0ddac4d21f496c0e992c445343_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-original-token="v2-f1f4b4b350e66729541efd4a00f86aa1" data-default-watermark-src="https://pica.zhimg.com/50/v2-f8b79d7f0bd72d27eb37fdafdc37a1b0_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-7c3a6d0ddac4d21f496c0e992c445343_r.jpg?source=1940ef5c">
  <figcaption>
   团子镇楼
  </figcaption>
 </figure>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-0d208ae30d45fa6b0a8a3c62de0c1906_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-caption="" data-original-token="v2-ffc50b3f539c8c7f71ec813c33e91bf3" data-default-watermark-src="https://pica.zhimg.com/50/v2-c6e569c58f1212dc5ecb82a344848ac5_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-0d208ae30d45fa6b0a8a3c62de0c1906_r.jpg?source=1940ef5c">
 </figure>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-5bdc5022b058a33bb64252e747e29483_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-caption="" data-original-token="v2-39cf6102a2c88c217738e2eab39a257f" data-default-watermark-src="https://pica.zhimg.com/50/v2-801bbacd061ddbfdd1a178a3efbcc351_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://pic1.zhimg.com/v2-5bdc5022b058a33bb64252e747e29483_r.jpg?source=1940ef5c">
 </figure>
 <blockquote data-pid="tEkKaL6i">
  <b>关灯效果</b>
 </blockquote>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-03e541a63a276007466583dd0d5c7abe_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-caption="" data-original-token="v2-784db5c652582b602a9e8b749b328124" data-default-watermark-src="https://pic1.zhimg.com/50/v2-60721c9886d3242c16ca13f17b5e07de_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://pica.zhimg.com/v2-03e541a63a276007466583dd0d5c7abe_r.jpg?source=1940ef5c">
 </figure>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-553567111fcb906cd599caa0ba7a375f_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-caption="" data-original-token="v2-86b217954dd5966c5426a7c7a67af6ef" data-default-watermark-src="https://pic1.zhimg.com/50/v2-b15448ebd4c9ee86ae02dd475c680e95_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://pic1.zhimg.com/v2-553567111fcb906cd599caa0ba7a375f_r.jpg?source=1940ef5c">
 </figure>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-617e98c80608dcb809724957acc9ba5e_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-caption="" data-original-token="v2-3a9c7baa6f6a35e700d41e26b3053ae5" data-default-watermark-src="https://picx.zhimg.com/50/v2-e6fef2ee416a187c7253786bba8fd8aa_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-617e98c80608dcb809724957acc9ba5e_r.jpg?source=1940ef5c">
 </figure>
 <h2>功能</h2>
 <ol>
  <li data-pid="wWqOGFHh">6位数字的时间/日期显示。</li>
  <li data-pid="pQPpwI1G">4位有效数字的温度/湿度显示。</li>
  <li data-pid="ejzHngcU">RGB全彩显示/呼吸灯。</li>
  <li data-pid="oSV_uaor">微信Airkiss/ESPTouch配网。</li>
  <li data-pid="1nngCDg3">APP切换/控制/主动校时。</li>
  <li data-pid="40P9ta21">高精度时钟+断电锂电池供电。</li>
  <li data-pid="DG7WMS3i">Crossfade数字切换效果。</li>
 </ol>
 <h2>设计</h2>
 <ul>
  <li data-pid="N4UJsO_6">辉光管：IN-14</li>
  <li data-pid="ehSbuocK">主控：STM32F103</li>
  <li data-pid="0VgSwnnI">辉光管控制芯片：HV57708</li>
  <li data-pid="KlHJEc81">Wi-Fi模块：ESP-12s</li>
  <li data-pid="dDy_16_r">时钟芯片：DS3231</li>
  <li data-pid="z8PAd_tD">湿温传感器：SHT30</li>
  <li data-pid="B56lUVpL">RGB：WS2812C</li>
  <li data-pid="yIqP6mL-">双层沉金PCB</li>
  <li data-pid="pdK6aTkX">可替换脚座</li>
 </ul>
 <blockquote data-pid="FZHQoidu">
  <b>升压部分</b>
 </blockquote>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-987d8417d210fecc299d98c1fb2f06b0_720w.jpg?source=1940ef5c" data-rawwidth="904" data-rawheight="496" data-size="normal" data-original-token="v2-fc074bfe6efe07560bcdac1aba7cef04" data-default-watermark-src="https://pic1.zhimg.com/50/v2-1a993b6b641e52a326143610cd24347e_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="904" data-original="https://picx.zhimg.com/v2-987d8417d210fecc299d98c1fb2f06b0_r.jpg?source=1940ef5c">
  <figcaption>
   170V升压电路
  </figcaption>
 </figure>
 <p data-pid="HASCltUo">参考<a class="member_mention" href="https://www.zhihu.com/people/c7dd607d3cb2f4cc20c05ac01ddee024" data-hash="c7dd607d3cb2f4cc20c05ac01ddee024" data-hovercard="p$b$c7dd607d3cb2f4cc20c05ac01ddee024">@Sadudu</a>的电源设计，不知道为什么10mΩ的限流电阻会导致过流，烧坏一块HV57708......将限流电阻提高到50mΩ解决问题。同时将电感值降到150uH（完全听不到啸叫）以提高驱动力。</p>
 <p data-pid="Eu8r-wFG">一开始输出电容使用的是MLCC电容，但发现带上负载之后会产生不太能够接受的啸叫......本着完美主义的精神，试了一大圈不同的电容，最后发现还是电解电容比较靠谱，毕竟这次设计中对体积要求不高。</p>
 <blockquote data-pid="A9linkdw">
  <b>主控部分</b>
 </blockquote>
 <p data-pid="q70uZsMF">STM32似乎没有什么好说的......</p>
 <blockquote data-pid="3LXqeGbk">
  <b>辉光管控制部分</b>
 </blockquote>
 <p data-pid="8bdznRIt">用了大家都在用的57708，效果很棒。值得一说的是57708的引脚连接在辉光管的阴极，芯片必须工作在<b>反向模式</b>。信号为低电平时引脚输出为高电平（80V），这样阴极与阳极之间就无法产生170V左右的压差而熄灭，反之亦然。</p>
 <blockquote data-pid="DjOKjz8o">
  <b>Wi-Fi模块</b>
 </blockquote>
 <p data-pid="2KSw6wtd">基于AT开发，用的乐鑫官方AT库。</p>
 <blockquote data-pid="eL7CH5h8">
  <b>时钟</b>
 </blockquote>
 <p data-pid="_59TOwrq">使用了一块CR1220锂电池供电，保证断电依然能够精准走时。</p>
 <blockquote data-pid="89T-OeD-">
  <b>湿温传感器</b>
 </blockquote>
 <p data-pid="eYSGK3Eb">用了Sensirion公司的一个湿温传感器。因为是板载设计，所以在布局上也避开了其他元器件，同时不在其下方铺铜，打孔至背面形成一个孤岛，尽量能够更好更准确的测量湿度/温度。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-45015a42d1021176a3724b6fb11e94c8_720w.jpg?source=1940ef5c" data-rawwidth="1211" data-rawheight="712" data-size="normal" data-caption="" data-original-token="v2-eb80088eec48f3ae37f27714db860b78" data-default-watermark-src="https://pica.zhimg.com/50/v2-359be39039ee11fce1769de7d581c204_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1211" data-original="https://picx.zhimg.com/v2-45015a42d1021176a3724b6fb11e94c8_r.jpg?source=1940ef5c">
 </figure>
 <blockquote data-pid="jQDCJLdf">
  <b>RGB</b>
 </blockquote>
 <p data-pid="eL1CqZI2">特意使用了WS2812的低亮度版本，毕竟作为氛围灯无需太亮。</p>
 <h2>制作</h2>
 <blockquote data-pid="t3BR3xu8">
  <b>PCB</b>
 </blockquote>
 <p data-pid="uc-sO5FW">画板子还是比较累人的，前前后后用了好几天。</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-9d50106f60a6d91367f99a26d25afba7_720w.jpg?source=1940ef5c" data-rawwidth="1874" data-rawheight="1015" data-size="normal" data-caption="" data-original-token="v2-8d66962d65d8810a68f8aeec6ff86ab8" data-default-watermark-src="https://pic1.zhimg.com/50/v2-650f9fa868e36fe484e48ce3395881c1_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1874" data-original="https://pica.zhimg.com/v2-9d50106f60a6d91367f99a26d25afba7_r.jpg?source=1940ef5c">
 </figure>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-aa4a0c973c8c28c57c97fb3bd0920b23_720w.jpg?source=1940ef5c" data-rawwidth="1323" data-rawheight="727" data-size="normal" data-caption="" data-original-token="v2-f1e76eedfe92652a25cbfa3e0862e249" data-default-watermark-src="https://pica.zhimg.com/50/v2-bcb187588e9b1332adedc1e3de3da33b_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1323" data-original="https://picx.zhimg.com/v2-aa4a0c973c8c28c57c97fb3bd0920b23_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="k6dNrdZX">然后在捷X打样。阻焊颜色是消光黑，沉金工艺。实际效果还是不错的。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-a52d0e31bfe216f658bf85ff4a5a9977_720w.jpg?source=1940ef5c" data-rawwidth="4032" data-rawheight="3024" data-size="normal" data-caption="" data-original-token="v2-11eb729186cd8e7bee19a2e8979be441" data-default-watermark-src="https://pica.zhimg.com/50/v2-784b3070b2a15f128579f3ad433fda1a_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4032" data-original="https://picx.zhimg.com/v2-a52d0e31bfe216f658bf85ff4a5a9977_r.jpg?source=1940ef5c">
 </figure>
 <blockquote data-pid="D9JGRdNy">
  <b>焊接</b>
 </blockquote>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-46c33cdffea65c6b8fedd4251a4576a9_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-caption="" data-original-token="v2-4296ad05d5d0bf3afd7109e63e86a09b" data-default-watermark-src="https://picx.zhimg.com/50/v2-2850e0884180b24a2f7b5ab4d1c914db_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-46c33cdffea65c6b8fedd4251a4576a9_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="EPGK33GO">F103拖焊就行了，没想象中这么难。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-7a26e10b71a833842bc7551daaf1c8dd_720w.jpg?source=1940ef5c" data-rawwidth="3024" data-rawheight="3024" data-size="normal" data-caption="" data-original-token="v2-1095f33fe6d30f89617b849288ecde31" data-default-watermark-src="https://picx.zhimg.com/50/v2-2779be96d487d7f0166fb038ba725bc4_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="3024" data-original="https://picx.zhimg.com/v2-7a26e10b71a833842bc7551daaf1c8dd_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="IYTzPPBm">相当不好焊的是SHT30。因为Datasheet说手工焊接350度必须小于5秒，又是DFN封装，手必须非常的稳。搞坏一块，还好第二块成功了。</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-a14fa12b6a511293a65ba378c2c804f1_720w.jpg?source=1940ef5c" data-rawwidth="1853" data-rawheight="1646" data-size="normal" data-caption="" data-original-token="v2-d4ee76d969e1273d1b822e98b98186fb" data-default-watermark-src="https://picx.zhimg.com/50/v2-5286d414144e6159c4dae2a212ead37f_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1853" data-original="https://picx.zhimg.com/v2-a14fa12b6a511293a65ba378c2c804f1_r.jpg?source=1940ef5c">
 </figure>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-41023bc8e710707e07dbf966acdfc1be_720w.jpg?source=1940ef5c" data-rawwidth="2716" data-rawheight="2559" data-size="normal" data-caption="" data-original-token="v2-4d0010d54d38eb284fb576b6e77bd2be" data-default-watermark-src="https://pic1.zhimg.com/50/v2-e2bdf8fb912ba446edc0f082f281fa65_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="2716" data-original="https://pica.zhimg.com/v2-41023bc8e710707e07dbf966acdfc1be_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="fwzFGEUc">控制部分</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-22725a1451ffd487d4c0891ab63f8f70_720w.jpg?source=1940ef5c" data-rawwidth="720" data-rawheight="960" data-size="normal" data-caption="" data-original-token="v2-14e03581da4f5727cbe7c3f1bbf78ec3" data-default-watermark-src="https://picx.zhimg.com/50/v2-d0c4548daedbaec9a28245993e3364b8_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="720" data-original="https://pic1.zhimg.com/v2-22725a1451ffd487d4c0891ab63f8f70_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="9nG2n8bd">高压部分</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-c1ea6a01204537db33e7024e4eb22e7c_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-caption="" data-original-token="v2-44d64e1b2eff66bef8cffdaaf5cb210d" data-default-watermark-src="https://picx.zhimg.com/50/v2-e77ee63c96961771f75e1975f8a057a6_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-c1ea6a01204537db33e7024e4eb22e7c_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="zSIpFLnk">57708</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-d7149a6f348ad067156c1c4e9bfe1b71_720w.jpg?source=1940ef5c" data-rawwidth="1080" data-rawheight="1059" data-size="normal" data-caption="" data-original-token="v2-11d0a7dc483551f7661aa580632e2033" data-default-watermark-src="https://picx.zhimg.com/50/v2-d90596b35486a991a9a8c937984463c8_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://picx.zhimg.com/v2-d7149a6f348ad067156c1c4e9bfe1b71_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="6YRqfs-R">然后是测试，万用表点一点~</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-573c49ce089ce8b54f4ed0b49c01b6ef_720w.jpg?source=1940ef5c" data-rawwidth="1080" data-rawheight="1338" data-size="normal" data-caption="" data-original-token="v2-6aa4b94a6822b3c286eea6365236ea15" data-default-watermark-src="https://pic1.zhimg.com/50/v2-ce66cfdc869d0a308c02370b2398ece5_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic1.zhimg.com/v2-573c49ce089ce8b54f4ed0b49c01b6ef_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Nje3c_g4">完成之后拿洗板水仔细擦净，搞定~</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-25e808342df8de30b2e47a1328153ca1_720w.jpg?source=1940ef5c" data-rawwidth="720" data-rawheight="540" data-size="normal" data-caption="" data-original-token="v2-ad8f4953e61fdb463969c8a68ca40470" data-default-watermark-src="https://picx.zhimg.com/50/v2-4b0d4fba915e89264080516e7597bb0d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="720" data-original="https://picx.zhimg.com/v2-25e808342df8de30b2e47a1328153ca1_r.jpg?source=1940ef5c">
 </figure>
 <blockquote data-pid="rSHHDyhK">
  <b>外壳</b>
 </blockquote>
 <p data-pid="jz4RB98q">CAD大概画一画就丢给TB做了，一共就两块亚克力板子~</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-dd76576faa9eacec41e28bf4ca105556_720w.jpg?source=1940ef5c" data-rawwidth="1339" data-rawheight="787" data-size="normal" data-caption="" data-original-token="v2-0fe8cf919d8c83b6f9a116f88ece2514" data-default-watermark-src="https://picx.zhimg.com/50/v2-3c35d7a3d2065c844ece95aca120bf44_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1339" data-original="https://picx.zhimg.com/v2-dd76576faa9eacec41e28bf4ca105556_r.jpg?source=1940ef5c">
 </figure>
 <h2><b>软件</b></h2>
 <blockquote data-pid="qJck9w9u">
  <b>时间显示</b>
 </blockquote>
 <p data-pid="m9r9uFXB">最基本的是时间显示。最早是在 <a href="https://link.zhihu.com/?target=https%3A//github.com/dekuNukem/exixe" class=" wrap external" target="_blank" rel="nofollow noreferrer">这里</a> 看到有人实现了这样的显示切换效果，就此就成了怨念，决心要实现它......</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-598288e362ab96d876c9498025e5cf01_720w.gif?source=1940ef5c" data-rawwidth="400" data-rawheight="225" data-size="normal" data-original-token="v2-598288e362ab96d876c9498025e5cf01" data-thumbnail="https://picx.zhimg.com/50/v2-598288e362ab96d876c9498025e5cf01_720w.jpg?source=1940ef5c" class="content_image" width="400">
  <figcaption>
   Github上dekuNukem的Crossfade展示
  </figcaption>
 </figure>
 <p data-pid="_tWxJxTF"><b>Crossfade</b>效果的核心就是<b>PWM Control</b>，所以对于辉光管来说，最直接的方法就是使用主控来控制三极管。所以现在绝大多数的解决方案也都是通过三极管来实现的，包括上面的例子。这就带来了问题，因为IN14的引脚很多，即使是只是用数字，6位显示也需要60个三极管。而我不想用那么多只三极管......</p>
 <p data-pid="ACfOP1yx">所以这时候就要读一读Datasheet了。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-3989461ca3f2822e258c6f6a5f7434df_720w.jpg?source=1940ef5c" data-rawwidth="812" data-rawheight="437" data-size="normal" data-caption="" data-original-token="v2-350b60fa11d4417e3ef815ef6a08d511" data-default-watermark-src="https://pic1.zhimg.com/50/v2-560deed94c26aa103a1d1a6a45de8084_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="812" data-original="https://picx.zhimg.com/v2-3989461ca3f2822e258c6f6a5f7434df_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="pE6AS2gb">打开HV57708的datasheet，发现57708的Clock速度非常快，达到了8MHz。也就是说我理论上完全可以通过串行通信调整辉光管的亮暗信号数组来模拟PWM。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-1ad21d9e6c8b7a7dd456b2ed643986f0_720w.gif?source=1940ef5c" data-rawwidth="180" data-rawheight="180" data-size="normal" data-caption="" data-original-token="v2-1ad21d9e6c8b7a7dd456b2ed643986f0" data-thumbnail="https://pic1.zhimg.com/50/v2-1ad21d9e6c8b7a7dd456b2ed643986f0_720w.jpg?source=1940ef5c" class="content_image" width="180">
 </figure>
 <p data-pid="hnK5C6TF">需要通过模拟实现PWM，就要对57708的数据传输方式进行深刻的了解。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-c7900611d35f820885550a9aa9ccbffc_720w.jpg?source=1940ef5c" data-rawwidth="961" data-rawheight="874" data-size="normal" data-caption="" data-original-token="v2-05b9b7dba88cea162764682ef97b1ed7" data-default-watermark-src="https://pic1.zhimg.com/50/v2-e23f565d060ff217d09f6d5e6e7f7839_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="961" data-original="https://pica.zhimg.com/v2-c7900611d35f820885550a9aa9ccbffc_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="yJuMzD46">57708将64位串行电平数据通过4根通道输入锁存器，然后根据时钟变化将这些数据并行输出到每个引脚。</p>
 <p data-pid="k-kWhPXz">而辉光管的每一位数字都有自己的“座位号”。根据我的硬件设计，我将64位电平数据（实际只用到60位，每个管子显示10种数字）分为两组并且列出它们位于整个数组的位置。</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-b4643aca815029a3c027ec3529e6b0d5_720w.jpg?source=1940ef5c" data-rawwidth="1229" data-rawheight="359" data-size="normal" data-original-token="v2-c223f67eeef433d7f5678192084a7101" data-default-watermark-src="https://picx.zhimg.com/50/v2-6e1c5929c3ef32f57205212551097fd4_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1229" data-original="https://picx.zhimg.com/v2-b4643aca815029a3c027ec3529e6b0d5_r.jpg?source=1940ef5c">
  <figcaption>
   辉光管数字的“座位表”
  </figcaption>
 </figure>
 <p data-pid="yzc8B0t6">那变化的本质是什么呢？例如，我要将显示秒数的个位从“5”渐渐变换很“6”，在这个过程中，其实要做这些事：</p>
 <ol>
  <li data-pid="qmYhTHRn">将“5”所在电极的导通时间（占空比）逐渐减小至零</li>
  <li data-pid="oiYqLP2M">将“6”所在电极的导通时间（占空比）逐渐增大至完全导通</li>
  <li data-pid="5pk9hr7U">1与2同时进行</li>
 </ol>
 <p data-pid="z1DZ3XVR">如果考虑到进位，切换操作等还会需要更多的管子参与进来，所以需要对整个数组进行操作。</p>
 <p data-pid="Gc9qwMJg">通过对TIM的无限次调教和不同占空比的测试，最后还是得到了很好的效果~视频放在最后~</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-c94fe0b22313efc5059d3c24e64dde55_720w.gif?source=1940ef5c" data-rawwidth="240" data-rawheight="240" data-size="normal" data-caption="" data-original-token="v2-c94fe0b22313efc5059d3c24e64dde55" data-thumbnail="https://pic1.zhimg.com/50/v2-c94fe0b22313efc5059d3c24e64dde55_720w.jpg?source=1940ef5c" class="content_image" width="240">
 </figure>
 <blockquote data-pid="XPtUgtCc">
  <b>湿度/温度显示</b>
 </blockquote>
 <p data-pid="4as93u3c">没啥特别的直接上图~最后没有装上冒号，因为觉得装上不太好看，脑补一下当中有个dot</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-678eda03844e6996d6ae8d323cecc367_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-original-token="v2-56c31dfbfbc7042f336d84876cbfa19d" data-default-watermark-src="https://pica.zhimg.com/50/v2-b46ec51d999dfe7eee85a0358b78c34d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-678eda03844e6996d6ae8d323cecc367_r.jpg?source=1940ef5c">
  <figcaption>
   14.98度的室温
  </figcaption>
 </figure>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-e08e87025d33856b89552da00b4a2237_720w.jpg?source=1940ef5c" data-rawwidth="4096" data-rawheight="2730" data-size="normal" data-original-token="v2-5264447eeb2379de77a60041c5b06adf" data-default-watermark-src="https://pic1.zhimg.com/50/v2-1995da1896def6d098757be3ef57fabe_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://pic1.zhimg.com/v2-e08e87025d33856b89552da00b4a2237_r.jpg?source=1940ef5c">
  <figcaption>
   47.44%的湿度
  </figcaption>
 </figure>
 <blockquote data-pid="PhDCFptw">
  <b>Wi-Fi连接</b>
 </blockquote>
 <p data-pid="LR4svwLM">Wi-Fi是基于官方AT库开发的。基本通信过程就是ESP12S在局域网中建立一个固定IP的TCP服务器，然后手机APP作为客户端去访问，透传数据给主控，主控解包后读取数据再做相应的动作。由于AT库很强大，支持微信云，也许以后会研究一下做一些IoT的东西。</p>
 <p data-pid="UtLpUHEI">但是想了想，一个钟要访问云干什么......</p>
 <blockquote data-pid="eqjLixM8">
  <b>APP</b>
 </blockquote>
 <p data-pid="atWK1VlU">由于是基于Wi-Fi控制的，所以需要一个APP来进行时间日期切换，调整呼吸灯等操作。但是前端开发已经超出了我的能力范围，所以就用了如下巨丑的APP来凑活一下。虽然丑，但是实现功能是完全没有问题的。</p>
 <figure data-size="small">
  <img src="https://pica.zhimg.com/50/v2-e6669f2ac0f525df483c1c7ee1bf0d72_720w.jpg?source=1940ef5c" data-rawwidth="1080" data-rawheight="1920" data-size="small" data-caption="" data-original-token="v2-f5b611ccfa59b60dd25a567ef82a6940" data-default-watermark-src="https://picx.zhimg.com/50/v2-128d081a27a466d57eeda1c7572e72f5_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://picx.zhimg.com/v2-e6669f2ac0f525df483c1c7ee1bf0d72_r.jpg?source=1940ef5c">
 </figure>
 <h2>总结</h2>
 <p data-pid="u-vX1wwZ">Emmmm.....其实还是有许多方面需要改进的，如果有2.0版本的话，要做如下的升级：</p>
 <ol>
  <li data-pid="fvJiwnTj">电源部分优化做小，使整体板子小一点</li>
  <li data-pid="CE2Hm_Ar">可能会做蓝牙+Wi-Fi的通信，因为手头上正好有ESP32</li>
  <li data-pid="y3vUwV5L">做一个好看一点的APP，可能会用json来使通讯更规范</li>
  <li data-pid="M8nthuS9">可能会加入闹铃之类的</li>
  <li data-pid="HkKtWGKe">排针的设计有点愚蠢，可能之后就用焊盘了，烧录完再焊下来，这样更美观</li>
  <li data-pid="kv1szWEC">外壳可能会用木头或者铝合金之类的其他材料，依然保留顶部透明</li>
 </ol>
 <h2>最后</h2>
 <p data-pid="27QX0SbG">放一个视频吧</p><a class="video-box" href="https://link.zhihu.com/?target=https%3A//www.zhihu.com/video/1078388345306025984" target="_blank" data-video-id="" data-video-playable="" data-name="无声视频，各种效果展示~" data-poster="https://pic3.zhimg.com/v2-3023ad185308aa638fcd1fd1e01c6c0e.jpg" data-lens-id="1078388345306025984"><img class="thumbnail" src="https://pic3.zhimg.com/v2-3023ad185308aa638fcd1fd1e01c6c0e.jpg"><span class="content"><span class="title">无声视频，各种效果展示~<span class="z-ico-extern-gray"></span><span class="z-ico-extern-blue"></span></span><span class="url"><span class="z-ico-video"></span>https://www.zhihu.com/video/1078388345306025984</span></span></a>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="xo4RNziz">本次设计参考了<a class="member_mention" href="https://www.zhihu.com/people/c7dd607d3cb2f4cc20c05ac01ddee024" data-hash="c7dd607d3cb2f4cc20c05ac01ddee024" data-hovercard="p$b$c7dd607d3cb2f4cc20c05ac01ddee024">@Sadudu</a> 和 <a class="member_mention" href="https://www.zhihu.com/people/1ad32228d1acad7c253bd626de2ebb67" data-hash="1ad32228d1acad7c253bd626de2ebb67" data-hovercard="p$b$1ad32228d1acad7c253bd626de2ebb67">@silentcedar</a>的开源部分的内容，感谢！</p>
</body>
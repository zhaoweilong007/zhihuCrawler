# 最小二乘法的本质是什么？
- 点赞数：11621
- 更新时间：2024年01月05日10时40分35秒
- 回答url：https://www.zhihu.com/question/37031188/answer/411760828
<body>
 <blockquote data-pid="7GD8yLAb">
  <b>最小平方法是十九世纪统计学的主题曲。 </b>
  <br><b>从许多方面来看, 它之于统计学就相当于十八世纪的微积分之于数学。</b>
  <br>
  <br>
  ----史蒂芬·史蒂格勒的《The History of Statistics》
 </blockquote>
 <p data-pid="EpCXFiBE"><b>1 日用而不知</b></p>
 <p data-pid="PPwaAr_M">来看一个生活中的例子。比如说，有五把尺子：</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-23a39423b94ba79b34d444d996fb9d6c_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="500" data-rawheight="377" data-original-token="v2-f0476d352bf9a85c3bc34261ba47a5ca" data-default-watermark-src="https://picx.zhimg.com/50/v2-0ff137672f5f4ab576e6c09087ca9f54_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="500" data-original="https://picx.zhimg.com/v2-23a39423b94ba79b34d444d996fb9d6c_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="wyVTISva">用它们来分别测量一线段的长度，得到的数值分别为（颜色指不同的尺子）：</p>
 <p data-pid="MRV3ucvt"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7Cc%7D%5Cqquad%5Cqquad%26%5Cqquad%E9%95%BF%E5%BA%A6%5Cqquad%5C%5C%5Chline%5Ccolor%7Bred%7D%E7%BA%A2%26+10.2+%5C%5C%5Chline+%5Ccolor%7Bblue%7D%E8%93%9D%26+10.3+%5C%5C%5Chline+%5Ccolor%7Borange%7D%E6%A9%99%269.8%5C%5C%5Chline+%5Ccolor%7BGoldenrod%7D%E9%BB%84%269.9%5C%5C%5Chline+%5Ccolor%7Bgreen%7D%E7%BB%BF%269.8%5C%5C%5Cend%7Barray%7D%5C%5C" alt="\begin{array}{c|c}\qquad\qquad&amp;\qquad长度\qquad\\\hline\color{red}红&amp; 10.2 \\\hline \color{blue}蓝&amp; 10.3 \\\hline \color{orange}橙&amp;9.8\\\hline \color{Goldenrod}黄&amp;9.9\\\hline \color{green}绿&amp;9.8\\\end{array}\\" eeimg="1"></p>
 <p data-pid="AcF-Qt8o">之所以出现不同的值可能因为：</p>
 <ul>
  <li data-pid="dmsdONem">不同厂家的尺子的生产精度不同</li>
  <li data-pid="ps7J_Hit">尺子材质不同，热胀冷缩不一样</li>
  <li data-pid="Oc0cFdM8">测量的时候心情起伏不定</li>
  <li data-pid="AWaee5pP">......</li>
 </ul>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="E-KPccaJ">总之就是有误差，这种情况下，一般取平均值来作为线段的长度：</p>
 <p data-pid="R1p4rGLT"><img src="https://www.zhihu.com/equation?tex=%5Coverline%7Bx%7D%3D%5Cfrac%7B10.2%2B10.3%2B9.8%2B9.9%2B9.8%7D%7B5%7D%3D10%5C%5C" alt="\overline{x}=\frac{10.2+10.3+9.8+9.9+9.8}{5}=10\\" eeimg="1"></p>
 <p data-pid="rQU77Elz">日常中就是这么使用的。可是作为很事'er的数学爱好者，自然要想下：</p>
 <ul>
  <li data-pid="tI7idNKR">这样做有道理吗？</li>
  <li data-pid="FsRhHNR4">用调和平均数行不行？</li>
  <li data-pid="oECZw6Lf">用中位数行不行？</li>
  <li data-pid="-YNpVMpz">用几何平均数行不行？</li>
 </ul>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="mGq144vp"><b>2 最小二乘法</b></p>
 <p data-pid="tlhlto0q">换一种思路来思考刚才的问题。</p>
 <p data-pid="Mo-898Uf">首先，把测试得到的值画在笛卡尔坐标系中，分别记作<img src="https://www.zhihu.com/equation?tex=y_i" alt="y_i" eeimg="1"> ：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-74cba09e0c95a2f1971421c9a1e2e56c_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="547" data-rawheight="402" data-original-token="v2-4f73fbd281ba3535246c622f2fb0c368" data-default-watermark-src="https://picx.zhimg.com/50/v2-96136963b7280a37c25229d164ece86c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="547" data-original="https://pic1.zhimg.com/v2-74cba09e0c95a2f1971421c9a1e2e56c_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="d9CJssXo">其次，把要猜测的线段长度的真实值用平行于横轴的直线来表示（因为是猜测的，所以用虚线来画），记作<img src="https://www.zhihu.com/equation?tex=y" alt="y" eeimg="1"> ：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-485551e624a5679d3e12d89e38844a30_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="548" data-rawheight="402" data-original-token="v2-7a61090578eb716db12f0fd29ef3c92d" data-default-watermark-src="https://picx.zhimg.com/50/v2-de806e951e925b2134f1b7ebee55614d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="548" data-original="https://picx.zhimg.com/v2-485551e624a5679d3e12d89e38844a30_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="ZREEsBUb">每个点都向<img src="https://www.zhihu.com/equation?tex=y" alt="y" eeimg="1"> 做垂线，垂线的长度就是<img src="https://www.zhihu.com/equation?tex=%7Cy-y_i%7C" alt="|y-y_i|" eeimg="1"> ，也可以理解为测量值和真实值之间的误差：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-68fd43d677198036136ae721234d12eb_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="570" data-rawheight="402" data-original-token="v2-7e92911138d2c638e9bc9ee147690453" data-default-watermark-src="https://pic1.zhimg.com/50/v2-aa518686d31072b79a90fd159af3005c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="570" data-original="https://pica.zhimg.com/v2-68fd43d677198036136ae721234d12eb_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="54o5yetR">因为误差是长度，还要取绝对值，计算起来麻烦，就干脆用平方来代表误差：</p>
 <p data-pid="UfMkE27s"><img src="https://www.zhihu.com/equation?tex=%7Cy-y_i%7C%5Cto+%28y-y_i%29%5E2%5C%5C" alt="|y-y_i|\to (y-y_i)^2\\" eeimg="1"></p>
 <p data-pid="iDF_hvAr">误差的平方和就是（<img src="https://www.zhihu.com/equation?tex=%5Cepsilon" alt="\epsilon" eeimg="1"> 代表误差）：</p>
 <p data-pid="iBBxvtD1"><img src="https://www.zhihu.com/equation?tex=S_%7B%5Cepsilon%5E2%7D%3D%5Csum+%28y-y_i%29%5E2%5C%5C" alt="S_{\epsilon^2}=\sum (y-y_i)^2\\" eeimg="1"></p>
 <p data-pid="odQuCziR">因为<img src="https://www.zhihu.com/equation?tex=y" alt="y" eeimg="1"> 是猜测的，所以可以不断变换：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-0bbff14fc4305c9f66d84ea5de78beb4_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="698" data-rawheight="445" data-original-token="v2-0bbff14fc4305c9f66d84ea5de78beb4" data-thumbnail="https://picx.zhimg.com/50/v2-0bbff14fc4305c9f66d84ea5de78beb4_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="698" data-original="https://pic1.zhimg.com/v2-0bbff14fc4305c9f66d84ea5de78beb4_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="jDFp9YjT">自然，误差的平方和<img src="https://www.zhihu.com/equation?tex=S_%7B%5Cepsilon%5E2%7D" alt="S_{\epsilon^2}" eeimg="1"> 在不断变化的。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-79ffab93973248da566569f5b7e73276_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="440" data-rawheight="550" data-original-token="v2-3b9e91d056b20ad912c24df6d484952d" data-default-watermark-src="https://picx.zhimg.com/50/v2-b538729f74a1751d0ae8abf1951602cb_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="440" data-original="https://pica.zhimg.com/v2-79ffab93973248da566569f5b7e73276_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="-JBErbVc">法国数学家，阿德里安-马里·勒让德（1752－1833，这个头像有点抽象）提出让总的误差的平方最小的<img src="https://www.zhihu.com/equation?tex=y" alt="y" eeimg="1"> 就是真值，这是基于，如果误差是随机的，应该围绕真值上下波动（关于这点可以看下“<a href="https://link.zhihu.com/?target=https%3A//www.matongxue.com/madocs/808.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">如何理解无偏估计？</a>”）。</p>
 <p data-pid="YbNHIADJ">勒让德的想法变成代数式就是：</p>
 <p data-pid="gYJypeXl"><img src="https://www.zhihu.com/equation?tex=S_%7B%5Cepsilon%5E2%7D%3D%5Csum+%28y-y_i%29%5E2%E6%9C%80%E5%B0%8F%5Cimplies+%E7%9C%9F%E5%80%BCy%5C%5C" alt="S_{\epsilon^2}=\sum (y-y_i)^2最小\implies 真值y\\" eeimg="1"></p>
 <p data-pid="kfdqR_0m">这个猜想也蛮符合直觉的，来算一下。</p>
 <p data-pid="Sv4m-5mu">这是一个二次函数，对其求导，导数为0的时候取得最小值：</p>
 <p data-pid="LX7jVPxK"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7Bd%7D%7Bdy%7DS_%7B%5Cepsilon%5E2%7D%26%3D%5Cfrac%7Bd%7D%7Bdy%7D%5Csum+%28y-y_i%29%5E2%3D2%5Csum+%28y-y_i%29%5C%5C+%5Cquad%5C%5C%26%3D2%28%28y-y_1%29%2B%28y-y_2%29%2B%28y-y_3%29%2B%28y-y_4%29%2B%28y-y_5%29%29%3D0+%5Cquad%5C%5C%5Cend%7Baligned%7D%5C%5C" alt="\begin{aligned} \frac{d}{dy}S_{\epsilon^2}&amp;=\frac{d}{dy}\sum (y-y_i)^2=2\sum (y-y_i)\\ \quad\\&amp;=2((y-y_1)+(y-y_2)+(y-y_3)+(y-y_4)+(y-y_5))=0 \quad\\\end{aligned}\\" eeimg="1"></p>
 <p data-pid="k074A2uH">进而：</p>
 <p data-pid="u9ReRsiy"><img src="https://www.zhihu.com/equation?tex=+5y%3Dy_1%2By_2%2By_3%2By_4%2By_5%5Cimplies+y%3D%5Cfrac%7By_1%2By_2%2By_3%2By_4%2By_5%7D%7B5%7D%5C%5C" alt=" 5y=y_1+y_2+y_3+y_4+y_5\implies y=\frac{y_1+y_2+y_3+y_4+y_5}{5}\\" eeimg="1"></p>
 <p data-pid="nokaxqnE">正好是算术平均数。</p>
 <p data-pid="Eog-kXaQ">原来算术平均数可以让误差最小啊，这下看来选用它显得讲道理了。</p>
 <p data-pid="qEnxAhuf">以下这种方法：</p>
 <p data-pid="rOgEUTyL"><img src="https://www.zhihu.com/equation?tex=S_%7B%5Cepsilon%5E2%7D%3D%5Csum+%28y-y_i%29%5E2%E6%9C%80%E5%B0%8F%5Cimplies+%E7%9C%9F%E5%80%BCy%5C%5C" alt="S_{\epsilon^2}=\sum (y-y_i)^2最小\implies 真值y\\" eeimg="1"></p>
 <p data-pid="uFeig8Ka">就是<b>最小二乘法</b>，所谓“二乘”就是平方的意思，台湾直接翻译为最小平方法。</p>
 <p data-pid="INtHQDdG"><b>3 推广</b></p>
 <p data-pid="gf4QfSts">算术平均数只是最小二乘法的特例，适用范围比较狭窄。而最小二乘法用途就广泛。</p>
 <p data-pid="Vzl-dznK">比如温度与冰淇淋的销量：</p>
 <p data-pid="i7j7cc-t"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7Cc%7D+%5Cqquad%5Cqquad%26%5Cqquad%E9%94%80%E9%87%8F%5Cqquad%5C%5C%5Chline%5Ccolor%7Bred%7D%7B25%5E%5Ccirc%7D%26+110+%5C%5C%5Chline%5Ccolor%7Bblue%7D%7B27%5E%5Ccirc%7D%26+115+%5C%5C%5Chline%5Ccolor%7Borange%7D%7B31%5E%5Ccirc%7D%26155%5C%5C%5Chline+%5Ccolor%7BGoldenrod%7D%7B33%5E%5Ccirc%7D%26160%5C%5C%5Chline%5Ccolor%7Bgreen%7D%7B35%5E%5Ccirc%7D%26180%5C%5C%5Cend%7Barray%7D%5C%5C" alt="\begin{array}{c|c} \qquad\qquad&amp;\qquad销量\qquad\\\hline\color{red}{25^\circ}&amp; 110 \\\hline\color{blue}{27^\circ}&amp; 115 \\\hline\color{orange}{31^\circ}&amp;155\\\hline \color{Goldenrod}{33^\circ}&amp;160\\\hline\color{green}{35^\circ}&amp;180\\\end{array}\\" eeimg="1"></p>
 <p data-pid="KgeYRCZo">看上去像是某种线性关系：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-dcc861af2de0c946a241cfb3710a2ded_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="701" data-rawheight="402" data-original-token="v2-134467c2162a8a6a29235b740244eb30" data-default-watermark-src="https://picx.zhimg.com/50/v2-ff394a927c06a0349bdcdd45b0de7393_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="701" data-original="https://picx.zhimg.com/v2-dcc861af2de0c946a241cfb3710a2ded_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="sw_eBeYM">可以假设这种线性关系为：</p>
 <p data-pid="hv0AgAIK"><img src="https://www.zhihu.com/equation?tex=f%28x%29%3Dax%2Bb%5C%5C" alt="f(x)=ax+b\\" eeimg="1"></p>
 <p data-pid="QhReja_q">通过最小二乘法的思想：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-89eb746dfa213a547c26f78afcde0884_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="592" data-rawheight="402" data-original-token="v2-55663af525f27694fc3d02ee876e404b" data-default-watermark-src="https://pica.zhimg.com/50/v2-ccb386758171c9659748fe5caf80d1d0_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="592" data-original="https://picx.zhimg.com/v2-89eb746dfa213a547c26f78afcde0884_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="IqUVzbGn">上图的<img src="https://www.zhihu.com/equation?tex=i%2Cx%2Cy" alt="i,x,y" eeimg="1"> 分别为：</p>
 <p data-pid="BQWdTn7S"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7Cc%7Cc%7D%5Cqquad+i%5Cqquad%26%5Cqquad+x%5Cqquad%26%5Cqquad+y%5Cqquad%5C%5C%5Chline+1%2625%26+110+%5C%5C%5Chline2%2627%26+115+%5C%5C%5Chline3%2631%26155%5C%5C%5Chline+4%2633%26160%5C%5C%5Chline+5%2635%26180%5C%5C%5Cend%7Barray%7D%5C%5C" alt="\begin{array}{c|c|c}\qquad i\qquad&amp;\qquad x\qquad&amp;\qquad y\qquad\\\hline 1&amp;25&amp; 110 \\\hline2&amp;27&amp; 115 \\\hline3&amp;31&amp;155\\\hline 4&amp;33&amp;160\\\hline 5&amp;35&amp;180\\\end{array}\\" eeimg="1"></p>
 <p data-pid="2pg3OH2N">总误差的平方为：</p>
 <p data-pid="SLuIpGA9"><img src="https://www.zhihu.com/equation?tex=S_%7B%5Cepsilon%5E2%7D%3D%5Csum+%28f%28x_i%29-y_i%29%5E2%3D%5Csum+%28ax_i%2Bb-y_i%29%5E2%5C%5C" alt="S_{\epsilon^2}=\sum (f(x_i)-y_i)^2=\sum (ax_i+b-y_i)^2\\" eeimg="1"></p>
 <p data-pid="vPpxWryN">不同的<img src="https://www.zhihu.com/equation?tex=a%2Cb" alt="a,b" eeimg="1"> 会导致不同的<img src="https://www.zhihu.com/equation?tex=S_%7B%5Cepsilon%5E2%7D" alt="S_{\epsilon^2}" eeimg="1"> ，根据多元微积分的知识，当：</p>
 <p data-pid="AF6IAY3o"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+a%7DS_%7B%5Cepsilon%5E2%7D%3D2%5Csum+%28ax_i%2Bb-y_i%29x_i%3D0%5C%5C%5Cquad%5C%5C%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+b%7DS_%7B%5Cepsilon%5E2%7D%3D2%5Csum+%28ax_i%2Bb-y_i%29%3D0%5Cend%7Bcases%7D%5C%5C" alt="\begin{cases} \frac{\partial}{\partial a}S_{\epsilon^2}=2\sum (ax_i+b-y_i)x_i=0\\\quad\\\frac{\partial}{\partial b}S_{\epsilon^2}=2\sum (ax_i+b-y_i)=0\end{cases}\\" eeimg="1"></p>
 <p data-pid="1Nfvlu87">这个时候<img src="https://www.zhihu.com/equation?tex=S_%7B%5Cepsilon%5E2%7D" alt="S_{\epsilon^2}" eeimg="1"> 取最小值。</p>
 <p data-pid="mLfQqugW">对于<img src="https://www.zhihu.com/equation?tex=a%2Cb" alt="a,b" eeimg="1"> 而言，上述方程组为线性方程组，用之前的数据解出来：</p>
 <p data-pid="lW_Tnet7"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+a%5Capprox+7.2%5C%5C%5Cquad%5C%5C+b%5Capprox+-73%5Cend%7Bcases%7D%5C%5C" alt="\begin{cases} a\approx 7.2\\\quad\\ b\approx -73\end{cases}\\" eeimg="1"></p>
 <p data-pid="_OKGClYu">也就是这根直线：</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-0897a16878cd1db316aa0217314b7630_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="592" data-rawheight="402" data-original-token="v2-72f56c45db0fe3920756dfaf2f5b0783" data-default-watermark-src="https://picx.zhimg.com/50/v2-deb559e452c84233a27543fd752055a6_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="592" data-original="https://picx.zhimg.com/v2-0897a16878cd1db316aa0217314b7630_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="KSJOyb2W">其实，还可以假设：</p>
 <p data-pid="H0i15hy2"><img src="https://www.zhihu.com/equation?tex=f%28x%29%3Dax%5E2%2Bbx%2Bc%5C%5C" alt="f(x)=ax^2+bx+c\\" eeimg="1"></p>
 <p data-pid="EWOloQQT">在这个假设下，可以根据最小二乘法，算出<img src="https://www.zhihu.com/equation?tex=a%2Cb%2Cc" alt="a,b,c" eeimg="1"> ，得到下面这根红色的二次曲线：</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-ed6527380505fa144d52c34dcec9fb71_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="755" data-rawheight="402" data-original-token="v2-6b30114135ca2dfdc9f37e075ac7fbbd" data-default-watermark-src="https://pica.zhimg.com/50/v2-3114f8a5139d4bb6a69e9c800246c39d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="755" data-original="https://pica.zhimg.com/v2-ed6527380505fa144d52c34dcec9fb71_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="vEq27GTJ">同一组数据，选择不同的<img src="https://www.zhihu.com/equation?tex=f%28x%29" alt="f(x)" eeimg="1"> ，通过最小二乘法可以得到不一样的拟合曲线（<a href="https://link.zhihu.com/?target=https%3A//de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate" class=" wrap external" target="_blank" rel="nofollow noreferrer">出处</a>）：</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-856389824914aa9eace688855c13d870_720w.gif?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="450" data-rawheight="350" data-original-token="v2-856389824914aa9eace688855c13d870" data-thumbnail="https://picx.zhimg.com/50/v2-856389824914aa9eace688855c13d870_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="450" data-original="https://pic1.zhimg.com/v2-856389824914aa9eace688855c13d870_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="erMi4zG1">不同的数据，更可以选择不同的<img src="https://www.zhihu.com/equation?tex=f%28x%29" alt="f(x)" eeimg="1"> ，通过最小二乘法可以得到不一样的拟合曲线：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-db5a0af10f452a877e00126e948a7789_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="500" data-rawheight="319" data-original-token="v2-0dd2189f20682e06ecbd0462322ffab3" data-default-watermark-src="https://pic1.zhimg.com/50/v2-e950bffe8edb1a20ec2562e56993ff03_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="500" data-original="https://pic1.zhimg.com/v2-db5a0af10f452a877e00126e948a7789_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="ftPd0_W2"><img src="https://www.zhihu.com/equation?tex=f%28x%29" alt="f(x)" eeimg="1"> 也不能选择任意的函数，还是有一些讲究的，这里就不介绍了。</p>
 <p data-pid="uArJfAaP"><b>4 最小二乘法与正态分布</b></p>
 <p data-pid="98JTEXwz">我们对勒让德的猜测，即最小二乘法，仍然抱有怀疑，万一这个猜测是错误的怎么办？</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-4cb58a4fd4dc265e344a7fe8445a7b6f_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="373" data-rawheight="479" data-original-token="v2-ad404a3c8df6773aefc89e2ceac697e3" data-default-watermark-src="https://pica.zhimg.com/50/v2-e16ac00d825a1b17879903063bcc83b5_720w.jpg?source=1940ef5c" class="content_image" width="373">
 </figure>
 <p data-pid="i69Z5mV9">数学王子高斯（1777－1855）也像我们一样心存怀疑。</p>
 <p data-pid="CW3n1IG_">高斯换了一个思考框架，通过概率统计那一套来思考。</p>
 <p data-pid="FxywBUuS">让我们回到最初测量线段长度的问题。高斯想，通过测量得到了这些值：</p>
 <p data-pid="ej2NqUQT"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Barray%7D%7Bc%7Cc%7D%5Cqquad%5Cqquad%26%5Cqquad%E9%95%BF%E5%BA%A6%5Cqquad%5C%5C%5Chline%5Ccolor%7Bred%7D%E7%BA%A2%26+10.2+%5C%5C%5Chline%5Ccolor%7Bblue%7D%E8%93%9D%26+10.3+%5C%5C%5Chline%5Ccolor%7Borange%7D%E6%A9%99%269.8%5C%5C%5Chline%5Ccolor%7BGoldenrod%7D%E9%BB%84%269.9%5C%5C%5Chline+%5Ccolor%7Bgreen%7D%E7%BB%BF%269.8%5C%5C%5Cend%7Barray%7D%5C%5C" alt="\begin{array}{c|c}\qquad\qquad&amp;\qquad长度\qquad\\\hline\color{red}红&amp; 10.2 \\\hline\color{blue}蓝&amp; 10.3 \\\hline\color{orange}橙&amp;9.8\\\hline\color{Goldenrod}黄&amp;9.9\\\hline \color{green}绿&amp;9.8\\\end{array}\\" eeimg="1"></p>
 <p data-pid="_fhLVkn5">每次的测量值<img src="https://www.zhihu.com/equation?tex=x_i" alt="x_i" eeimg="1"> 都和线段长度的真值<img src="https://www.zhihu.com/equation?tex=x" alt="x" eeimg="1"> 之间存在一个误差：</p>
 <p data-pid="vGE2rG9u"><img src="https://www.zhihu.com/equation?tex=%5Cepsilon_i%3Dx-x_i%5C%5C" alt="\epsilon_i=x-x_i\\" eeimg="1"></p>
 <p data-pid="B2KPwMyO">这些误差最终会形成一个概率分布，只是现在不知道误差的概率分布是什么。假设概率密度函数为：</p>
 <p data-pid="tnv9Wfbr"><img src="https://www.zhihu.com/equation?tex=p%28%5Cepsilon%29%5C%5C" alt="p(\epsilon)\\" eeimg="1"></p>
 <p data-pid="d5anu_bv">再假设一个联合概率，这样方便把所有的测量数据利用起来：</p>
 <p data-pid="C5rpObU_"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+L%28x%29+%26%3Dp%28%5Cepsilon_1%29p%28%5Cepsilon_2%29%5Ccdots+p%28%5Cepsilon_5%29%5C%5C%5Cquad%5C%5C%26%3Dp%28x-x_i%29p%28x-x_2%29%5Ccdots+p%28x-x_5%29%5Cend%7Baligned%7D%5C%5C" alt="\begin{aligned} L(x) &amp;=p(\epsilon_1)p(\epsilon_2)\cdots p(\epsilon_5)\\\quad\\&amp;=p(x-x_i)p(x-x_2)\cdots p(x-x_5)\end{aligned}\\" eeimg="1"></p>
 <p data-pid="L7v35IyC">把<img src="https://www.zhihu.com/equation?tex=x" alt="x" eeimg="1"> 作为变量的时候，上面就是似然函数了（关于似然函数以及马上要讲到的极大似然估计，可以参考“<a href="https://link.zhihu.com/?target=https%3A//www.matongxue.com/madocs/447.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">如何理解极大似然估计法？</a>”）。</p>
 <p data-pid="FSIPMDaY"><img src="https://www.zhihu.com/equation?tex=L%28x%29" alt="L(x)" eeimg="1"> 的图像可能是这样的（随便画的）：</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-26710caadf821ddab473a23f500bba34_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="467" data-rawheight="402" data-original-token="v2-800c165010cd0781f9ce52acd876cb6f" data-default-watermark-src="https://picx.zhimg.com/50/v2-91e3b95b1302c1d7255aee8a48faed00_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="467" data-original="https://picx.zhimg.com/v2-26710caadf821ddab473a23f500bba34_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="S6gMn48t">根据极大似然估计的思想，联合概率最大的最应该出现（既然都出现了，而我又不是“天选之子”，那么自然不会是发生了小概率事件），也就是应该取到下面这点：</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-7353f0614e6554e1cf7c49cfdbd09f6b_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="467" data-rawheight="402" data-original-token="v2-b58f0eb082206240315f4b84f5c52539" data-default-watermark-src="https://picx.zhimg.com/50/v2-589657de901971eb36608a866acc9d7f_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="467" data-original="https://pica.zhimg.com/v2-7353f0614e6554e1cf7c49cfdbd09f6b_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="axZsB-t3">当下面这个式子成立时，取得最大值：</p>
 <p data-pid="NwPwQSC3"><img src="https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%7D%7Bdx%7DL%28x%29%3D0%5C%5C" alt="\frac{d}{dx}L(x)=0\\" eeimg="1"></p>
 <p data-pid="bzcVNbEl">然后高斯想，最小二乘法给出的答案是：</p>
 <p data-pid="jIAeio03"><img src="https://www.zhihu.com/equation?tex=x%3D%5Coverline%7Bx%7D%3D%5Cfrac%7Bx_1%2Bx_2%2Bx_3%2Bx_4%2Bx_5%7D%7B5%7D%5C%5C" alt="x=\overline{x}=\frac{x_1+x_2+x_3+x_4+x_5}{5}\\" eeimg="1"></p>
 <p data-pid="9B68Mxjf">如果最小二乘法是对的，那么<img src="https://www.zhihu.com/equation?tex=x%3D%5Coverline%7Bx%7D" alt="x=\overline{x}" eeimg="1"> 时应该取得最大值，即：</p>
 <p data-pid="irTJQred"><img src="https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%7D%7Bdx%7DL%28x%29%7C_%7Bx%3D%5Coverline%7Bx%7D%7D%3D0%5C%5C" alt="\frac{d}{dx}L(x)|_{x=\overline{x}}=0\\" eeimg="1"></p>
 <p data-pid="fjqV6lOs">好，现在可以来解这个微分方程了。最终得到：</p>
 <p data-pid="KmHK9Cu4"><img src="https://www.zhihu.com/equation?tex=p%28%5Cepsilon%29%3D%7B1+%5Cover+%5Csigma%5Csqrt%7B2%5Cpi%7D+%7D%5C%2Ce%5E%7B-+%7B%7B%5Cepsilon%5E2+%5Cover+2%5Csigma%5E2%7D%7D%7D%5C%5C" alt="p(\epsilon)={1 \over \sigma\sqrt{2\pi} }\,e^{- {{\epsilon^2 \over 2\sigma^2}}}\\" eeimg="1"></p>
 <p data-pid="vcwNQxHE">这是什么？这就是正态分布啊。</p>
 <p data-pid="bVr7E25J">并且这还是一个充要条件：</p>
 <p data-pid="z8GGDc0S"><img src="https://www.zhihu.com/equation?tex=x%3D%5Coverline%7Bx%7D%5Ciff+p%28%5Cepsilon%29%3D%7B1+%5Cover+%5Csigma%5Csqrt%7B2%5Cpi%7D+%7D%5C%2Ce%5E%7B-+%7B%7B%5Cepsilon%5E2+%5Cover+2%5Csigma%5E2%7D%7D%7D%5C%5C" alt="x=\overline{x}\iff p(\epsilon)={1 \over \sigma\sqrt{2\pi} }\,e^{- {{\epsilon^2 \over 2\sigma^2}}}\\" eeimg="1"></p>
 <p data-pid="p71sqq4R">也就是说，如果误差的分布是正态分布，那么最小二乘法得到的就是最有可能的值。</p>
 <p data-pid="2hlSDAmy">那么误差的分布是正态分布吗？</p>
 <p data-pid="B8GM4heT">如果误差是由于随机的、无数的、独立的、多个因素造成的，比如之前提到的：</p>
 <ul>
  <li data-pid="soapTi0h">不同厂家的尺子的生产精度不同</li>
  <li data-pid="QW3v5hkU">尺子材质不同，热胀冷缩不一样</li>
  <li data-pid="oCCe9Qlw">测量的时候心情起伏不定</li>
  <li data-pid="8fPCQemu">......</li>
 </ul>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="S-DQK2Df">那么根据中心极限定理（参考“<a href="https://link.zhihu.com/?target=https%3A//www.matongxue.com/madocs/589.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">为什么正态分布如此常见？</a>”），误差的分布就应该是正态分布。</p>
 <p data-pid="FT2nnGl-">虽然勒让德提出了最小二乘法（高斯说他最早提出最小二乘法，只是没有发表），但是高斯的努力，才真正奠定了最小二乘法的重要地位。</p>
 <p data-pid="54dBTBTM">文章最新版本在（有可能会有后续更新）：<a href="https://link.zhihu.com/?target=https%3A//www.matongxue.com/madocs/818.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">如何理解最小二乘法？</a></p>
 <p data-pid="SKH5Zivl">更多内容查看<b>马同学图解数学</b>系列教程</p><a data-draft-node="block" data-draft-type="mcn-link-card" data-mcn-id="1726553428585848833"></a><a data-draft-node="block" data-draft-type="mcn-link-card" data-mcn-id="1726553435271565312"></a><a data-draft-node="block" data-draft-type="mcn-link-card" data-mcn-id="1726553494843109376"></a>
 <p></p>
</body>
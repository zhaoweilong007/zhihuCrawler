# 如果人说他/她集齐了十二个星座的前任，我们应该如何估计他/她前任的数量？
- 点赞数：21504
- 更新时间：2016年10月11日13时18分50秒
- 回答url：https://www.zhihu.com/question/38331955/answer/125686675
<body>
 <figure>
  <img src="https://pic1.zhimg.com/50/92f0aaa35817cf6d022bf2ed6a5b6723_720w.jpg?source=1940ef5c" data-rawwidth="524" data-rawheight="424" data-original-token="92f0aaa35817cf6d022bf2ed6a5b6723" class="origin_image zh-lightbox-thumb" width="524" data-original="https://pic1.zhimg.com/92f0aaa35817cf6d022bf2ed6a5b6723_r.jpg?source=1940ef5c">
 </figure>
 <br>
 <p data-pid="9chYPBne">公式:<img src="https://www.zhihu.com/equation?tex=%5C%5BE%5Cleft%28+T+%5Cright%29+%3D+n%7BH_n%7D%5C%5D" alt="\[E\left( T \right) = n{H_n}\]" eeimg="1"></p>
 <p data-pid="Utg9vhya">数据:</p>
 <div class="highlight">
  <pre><code class="language-text">{白羊座, 金牛座, 双子座, 巨蟹座, 狮子座, 处女座, 天秤座, 天蝎座, 射手座, 摩羯座, 水瓶座, 双鱼座}</code></pre>
 </div>
 <p data-pid="Gb7qlvuw">实现:</p>
 <div class="highlight">
  <pre><code class="language-text">N@# HarmonicNumber@# &amp;@12
</code></pre>
 </div>
 <blockquote data-pid="k6PkVkaF">
  <b>答案:37.2385<br></b>
 </blockquote>
 <p data-pid="lS6F5BCZ">----------------------------------------------------------------------------------------------------------------</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/180e4efbf7390450cfbcf20234ae5fa9_720w.jpg?source=1940ef5c" data-rawwidth="563" data-rawheight="500" data-original-token="180e4efbf7390450cfbcf20234ae5fa9" class="origin_image zh-lightbox-thumb" width="563" data-original="https://pic1.zhimg.com/180e4efbf7390450cfbcf20234ae5fa9_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="NQx7VK_P">公式: <img src="https://www.zhihu.com/equation?tex=%5C%5B%7Bp%5Ec%7D%5Cleft%28+n+%5Cright%29+%3D+%5Cfrac%7B%7Bc%21S_%7Bn+-+1%7D%5E%7B%5Cleft%28+%7Bc+-+1%7D+%5Cright%29%7D%7D%7D%7B%7B%7Bc%5En%7D%7D%7D%5C%5D" alt="\[{p^c}\left( n \right) = \frac{{c!S_{n - 1}^{\left( {c - 1} \right)}}}{{{c^n}}}\]" eeimg="1"></p>
 <p data-pid="Lz2YVq12">数据:</p>
 <div class="highlight">
  <pre><code class="language-text">n=12</code></pre>
 </div>
 <p data-pid="qEFzNAei">实现:</p>
 <div class="highlight">
  <pre><code class="language-text">DiscretePlot[c!StirlingS2[n-1,c-1]/c^n/.c-&gt;12,{n,1,100}]</code></pre>
 </div>
 <p data-pid="Cy9JIzh7">答案:</p>
 <figure>
  <img src="https://picx.zhimg.com/50/424407568218ea0f68a3a12e0b221d7e_720w.jpg?source=1940ef5c" data-rawwidth="380" data-rawheight="233" data-original-token="424407568218ea0f68a3a12e0b221d7e" class="content_image" width="380">
 </figure>
 <blockquote data-pid="4K-OeK01">
  有10%的把握少于17个,有50%的把握少于35个.
  <br>
  有90%的把握少于55个,有99%的把握少于82个.
 </blockquote>
 <p data-pid="D_i8WUuy">----------------------------------------------------------------------------------------------------------------</p>
 <figure>
  <img src="https://pica.zhimg.com/50/d39b15c11fe335f4587b66a9fda9dffa_720w.jpg?source=1940ef5c" data-rawwidth="560" data-rawheight="496" data-original-token="d39b15c11fe335f4587b66a9fda9dffa" class="origin_image zh-lightbox-thumb" width="560" data-original="https://picx.zhimg.com/d39b15c11fe335f4587b66a9fda9dffa_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="yt6lds64">公式 <img src="https://www.zhihu.com/equation?tex=%5C%5B%5Cint_0%5E%5Cinfty++%7B1+-+%5Cmathop+%5Cprod+%5Climits_%7Bi+%3D+1%7D%5En+%5Cleft%28+%7B1+-+%7Be%5E%7B+-+%7Bp_i%7Dt%7D%7D%7D+%5Cright%29%7B%5Ctext%7Bd%7D%7Dt%7D+%5C%5D" alt="\[\int_0^\infty  {1 - \mathop \prod \limits_{i = 1}^n \left( {1 - {e^{ - {p_i}t}}} \right){\text{d}}t} \]" eeimg="1"></p>
 <p data-pid="I5z0QV1r">数据</p>
 <div class="highlight">
  <pre><code class="language-text">额外假设1:题主是中国人,所以使用中国的星座分布数据
额外假设2:题主是适龄青年,所以使用年龄18-36的星座分布数据
第一个是白羊座,然后是金牛,以此类推...
p={0.1028,0.0911,0.0843,0.0822,0.0848,0.085,0.0857,0.0795,0.0753,0.0761,0.0808,0.073}
注1:不要吐槽总和不是1,因为有舍入误差...</code></pre>
 </div>
 <p data-pid="WHctTKPR">实现</p>
 <div class="highlight">
  <pre><code class="language-text">NIntegrate[1-Fold[Times,1,1-E^(-#t)&amp;/@p],{t,0,9527}]</code></pre>
 </div>
 <blockquote data-pid="kfcJ58Jx">
  答案:37.7424,就比均匀分布多了0.5个....
  <br>
  可以类比均值不等式理解为何分布默认均匀的时候最小
 </blockquote>
 <p data-pid="QSlKffsG">----------------------------------------------------------------------------------------------------------------</p>
 <figure>
  <img src="https://picx.zhimg.com/50/09acf2be9fb963cdb1d583e3bf8acf81_720w.jpg?source=1940ef5c" data-rawwidth="588" data-rawheight="455" data-original-token="09acf2be9fb963cdb1d583e3bf8acf81" class="origin_image zh-lightbox-thumb" width="588" data-original="https://pic1.zhimg.com/09acf2be9fb963cdb1d583e3bf8acf81_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Yign0pFe">比如....哦不...显然</p>
 <p data-pid="nTs-hm2h">上任是处女,估摸着下任怎么着也不会是处女了...</p>
 <p data-pid="kxKPr_Tg">上任是天蝎,那么我打包票,你不会也不敢有下任了.......</p>
 <p data-pid="qg-Kq9Z-">然后顺便把上面的星座分布不均也考虑进去...</p>
 <p data-pid="RT-iIGQP">所以我们可以用一个转移矩阵来刻画这个情况.</p>
 <p data-pid="6FkYpmL3">或者画成12个节点的加权有向图...</p>
 <figure>
  <img src="https://picx.zhimg.com/50/f91a4eb0c895ea1906c1b9bdc43691b2_720w.jpg?source=1940ef5c" data-rawwidth="497" data-rawheight="496" data-original-token="f91a4eb0c895ea1906c1b9bdc43691b2" class="origin_image zh-lightbox-thumb" width="497" data-original="https://picx.zhimg.com/f91a4eb0c895ea1906c1b9bdc43691b2_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="PjLG8QOK">然后求这个加权图G的随机游走覆盖时间(Cover Time)</p>
 <p data-pid="oNu0dgj7">考虑到严谨性我应该证明一下上面的一堆公式,不过上面三个公式每个都能写篇大论文,知乎短短篇幅说不清,所以解释就化归到这个问题一并解决...</p>
 <p data-pid="Tw5BNXVl">随机游走</p>
 <ul>
  <li data-pid="enfRQ2WX">把12星座画成12个节点,然后可以作为下任的话就画个箭头<br></li>
  <li data-pid="2LgwW7Mo">箭头有个粗细程度,这个叫加权,加权决定了选这个下任的概率有多大,实际概率波动不大所以不明显<br></li>
  <li data-pid="dYdERN6F">分析这144个关系全都画出来就是上面这张图<br></li>
  <li data-pid="Tz7N5sz3">选男友的过程数学上被称为图G上的随机游走</li>
 </ul>
 <p data-pid="HN6SxZxL">Cover Time</p>
 <ul>
  <li data-pid="Yh-umIeK">这些节点全部经过至少一遍所需要的时间叫做<b>Cover Time</b></li>
  <li data-pid="E3u3tT6F">子问题包括各种<b><u>著名概率问题</u></b>,生日问题啊,赠券收集啊等等...<br></li>
  <li data-pid="D19Zui8V">衍生问题还有复遍历,多重遍历什么的,可以有效用于<b><u>氪金估计</u></b>...<br></li>
  <li data-pid="UKDYPoBY">退化问题,退化为Tree的话可以相当有效的进行<b><u>爬虫策略优化</u></b>...</li>
 </ul>
 <p data-pid="JEbfTz-4">显然上面三个公式都是这个问题的特例</p>
 <ol>
  <li data-pid="FQLblmoI">小学生:12阶非加权完全图的Cover Time</li>
  <li data-pid="iPtiMkvS">初中生:12阶非加权完全图指定Cover程度后的Time分布</li>
  <li data-pid="i74YVzPd">高中生:12阶加权完全图的Cover Time</li>
 </ol>
 <p data-pid="jG_TNu6p">这个问题数学上来说的话不难,穷举所有路径首次通过时间的分布的平均值的交错和就行了...写成公式就是这样:</p>
 <p data-pid="NpHBnDyA">记A为G的所有可能通过的路径</p>
 <p data-pid="yWgl8Am3"><img src="https://www.zhihu.com/equation?tex=%5C%5B%7B%5Ctau+_G%7D+%3D+%5Csum%5Climits_A+%7B%7B%7B%5Cleft%28+%7B+-+1%7D+%5Cright%29%7D%5E%7B%5Cleft%7C+A+%5Cright%7C+-+1%7D%7DE%5Cleft%28+%7B%7BT_A%7D%7D+%5Cright%29%7D+%5C%5D" alt="\[{\tau _G} = \sum\limits_A {{{\left( { - 1} \right)}^{\left| A \right| - 1}}E\left( {{T_A}} \right)} \]" eeimg="1"></p>
 <p data-pid="zk6EIXZI">虽然能写出公式然而并没有什么用,求解精确值还是个世界难题...</p>
 <p data-pid="tLKIRXH7">写成代码是这个样子的,复杂度足够让算法学家爆气...</p>
 <p data-pid="F_N9Xs2I">幸好星座只有12个我的小CPU还能踉跄跑完...56个民族的话到宇宙灭亡也跑不完</p>
 <div class="highlight">
  <pre><code class="language-text">(*M表示转移矩阵,i表示起始节点编号*)
CoverTime[M_,i_]:=Module[{Start,Roads,Ex,Si},
	Start=ConstantArray[0,Length[M]];Start[[i]]=1;
	Roads=Subsets[DeleteCases[Range@Length[M],i]][[2;;-1]];
	Ex=Mean@FirstPassageTimeDistribution[
		DiscreteMarkovProcess[Start,M],#]&amp;/@Roads;
	Si=If[Length[#]~Mod~2==1,1,-1]&amp;/@Roads;
	Total[Ex*Si]];
CoverTime[M,#]&amp;/@Range[12]</code></pre>
 </div>
 <p data-pid="-pmI2xhj">而且蒙特卡洛效果也不太好,小规模精度不够,大规模基本跑不完...</p>
 <p data-pid="MhROXfjm">一般可以用Matthews逼近来稍稍有效的求一下上下界...</p>
 <p data-pid="dn380LUf">见Markov Chains and Mixing Times一书</p>
 <p data-pid="MA_KRNOk">哦,忘记说计算结果了,初始节点对最后的结果影响不小,所以第一个男友很重要啊</p>
 <p data-pid="5ZKHqlTw">第一任是处女座的话最小,只要31.64个,其他都在在35-38之间...</p>
 <p data-pid="1x-i6bYg">----------------------------------------------------------------------------------------------------------------</p>
 <figure>
  <img src="https://picx.zhimg.com/50/13e2483894001135666ee1af40d3ca72_720w.jpg?source=1940ef5c" data-rawwidth="521" data-rawheight="366" data-original-token="13e2483894001135666ee1af40d3ca72" class="origin_image zh-lightbox-thumb" width="521" data-original="https://picx.zhimg.com/13e2483894001135666ee1af40d3ca72_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="-iF9yhKZ">某些数理邪教组织啊,宣传什么<img src="https://www.zhihu.com/equation?tex=%5C%5B%5Cfrac%7B1%7D%7Be%7D%5C%5D" alt="\[\frac{1}{e}\]" eeimg="1">法则,就那个传说中能找到最理想男友的法则...</p><a href="https://link.zhihu.com/?target=http%3A//www.kylen314.com/archives/5234" class=" wrap external" target="_blank" rel="nofollow noreferrer">无责任超链接: 关于配偶选择理论的详细解释以及推广</a>
 <p data-pid="RHR7H0ur">人一生中会遇到大约40有可能进行交往的对象,然后可以取前<img src="https://www.zhihu.com/equation?tex=%5C%5B%5Cfrac%7B1%7D%7Be%7D%5C%5D" alt="\[\frac{1}{e}\]" eeimg="1">也就是13个人为实验组,考察下质量然后放弃掉,然后后面27个只要有超过前13个中最强的就嫁了吧....</p>
 <p data-pid="P1Zcpg9v">Well.....So,Reasons to believe that you are the 13th rebound guy...</p>
 <p data-pid="ttITWDKS">简单地说就是找12个星座的男生采样比较均匀...</p>
 <br>
 <br>
 <br>
 <br>
 <br>
 <br>
 <p data-pid="2TgcCNKu">----------------------------------------------------------------------------------------------------------------</p>
 <p data-pid="LkkcypTB">唔,如果你相信真爱的话,说不定是这种情况:</p>
 <figure>
  <img src="https://pica.zhimg.com/50/051aa4c1a4a1358956bbb4ca17e10de2_720w.jpg?source=1940ef5c" data-rawwidth="565" data-rawheight="467" data-original-token="051aa4c1a4a1358956bbb4ca17e10de2" class="origin_image zh-lightbox-thumb" width="565" data-original="https://pic1.zhimg.com/051aa4c1a4a1358956bbb4ca17e10de2_r.jpg?source=1940ef5c">
 </figure>
</body>
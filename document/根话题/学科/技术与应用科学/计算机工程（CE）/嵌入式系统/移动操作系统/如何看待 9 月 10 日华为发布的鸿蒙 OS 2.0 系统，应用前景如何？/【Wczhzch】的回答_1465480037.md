# 如何看待 9 月 10 日华为发布的鸿蒙 OS 2.0 系统，应用前景如何？
- 点赞数：12280
- 更新时间：2020年09月15日01时33分06秒
- 回答url：https://www.zhihu.com/question/420404904/answer/1465480037
<body>
 <blockquote data-pid="GpLX6tHe">
  感谢美国，把中国逼迫成无所不能的国家，把华为逼迫成无所不能的企业。
 </blockquote>
 <p data-pid="gpIdMaWd">很荣幸收到码云邀请参加鸿蒙系统源码解读征文，我呼吁程序员中的有识之士都应该踊跃参加！贡献出我们对中国开源事业的一份力量！链接在图里。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-2d3368ebd67642c4dab95ab67e4a89fb_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1436" data-rawheight="788" data-original-token="v2-2d3368ebd67642c4dab95ab67e4a89fb" data-default-watermark-src="https://picx.zhimg.com/50/v2-94373e9cccc3eea2ec00eddcb1b7b75c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1436" data-original="https://pica.zhimg.com/v2-2d3368ebd67642c4dab95ab67e4a89fb_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="eJPFwfSq">=====</p>
 <p data-pid="GIKmlxB1">专业人士来了，我从事安卓开发也有不少年头了，在那之前还参与开发了pintos等知名系统kernel，在os界摸爬滚打多年，给pintos系统贡献过不少代码，自认为对这行比较熟悉。这次鸿蒙真的是打了所有质疑人的脸了，因为这次真的发力了，先上图</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-80157e69831e45b5c2b4cc290e1672bd_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1440" data-rawheight="781" data-original-token="v2-b58ef8965727b8f7f6c0f1e0705a8ded" data-default-watermark-src="https://picx.zhimg.com/50/v2-a5d2ad2adf0cdcf1e470664f394e9424_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1440" data-original="https://picx.zhimg.com/v2-80157e69831e45b5c2b4cc290e1672bd_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="L0iQd2XJ">这是鸿蒙的ide界面，可以看到完善度已经很高了，基本已经达到了上线的水平了。我看了一下鸿蒙的代码，发现竟然我们鸿蒙已经实现了在cpu的ISA给全部替换为我们自主研发的html语言，这真的是件非常大的创新！鸿蒙实现了英特尔还在探索中的东西，估计是下一步要上麒麟芯片，这样一搞，实现了从芯片层面直接运行Javascript bytecode和rendering DOM，实在是太精妙了，估计还跟分布式类小程序系统有关，拭目以待吧！我认为我们在os研发和微应用绝对已经领先了！中华有为，我真的为鸿蒙工程师所付出的努力感到骄傲！</p>
 <p data-pid="20TAHI8o">===第n+2次更新</p>
 <p data-pid="8_-OVecJ">看了下鸿蒙os的process creation部分，发现华为也优化了很多常见unix kernel存在的漏洞与不足，先上图。</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-0d11b7425fbd2a900a105e71ed5fa312_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1745" data-rawheight="857" data-original-token="v2-0d11b7425fbd2a900a105e71ed5fa312" data-default-watermark-src="https://pica.zhimg.com/50/v2-937774e89a6dfdeb8d0c0c9113e7f933_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1745" data-original="https://picx.zhimg.com/v2-0d11b7425fbd2a900a105e71ed5fa312_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="sLKfV6UN">图中可以清晰的看到，高亮部分代码是检查ret这个变量是否小于0的。这是个非常聪明的选择，因为ret是type UINT32，也就是说是unsigned的。但是因为咱们鸿蒙系统对稳定性的要求很高，因为可能未来会用在外太空或者高辐射场景，为了防止SEU，也就是single-event upset，高辐射环境可能会导致内存bit flip，鸿蒙为了确保万无一失，多次确认此变量是大于0的。我觉得这方法很保险！</p>
 <p data-pid="Cw70oIJ4">第二点，上图</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-646f431214e871922e26139f51454bd9_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1480" data-rawheight="397" data-original-token="v2-646f431214e871922e26139f51454bd9" data-default-watermark-src="https://pic1.zhimg.com/50/v2-eb4ac7446e762df91a3ba9fa70ceaddc_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1480" data-original="https://picx.zhimg.com/v2-646f431214e871922e26139f51454bd9_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="AZHCi9Nm">图中体现了方舟编译器配合鸿蒙系统的强大，完美的支持return type polymorphism，直接可以把int32自动化分布式的转变为uint32 type，非常的智能化了。</p>
 <p data-pid="qI-KkVhx">===第n+1次更新</p>
 <p data-pid="x6JNp1bx">看代码看的眼花了，来更新下，先解答下关于代码里面有安卓的争议，先上图。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-362b8060588ed14780d159cf5d11e76f_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="671" data-rawheight="894" data-original-token="v2-2b13b3c0a62a9612789ac27e03b90f2b" data-default-watermark-src="https://pic1.zhimg.com/50/v2-160446cf28b7c7f16123eb7ee1f96646_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="671" data-original="https://picx.zhimg.com/v2-362b8060588ed14780d159cf5d11e76f_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Y6V7_eM0">外行的朋友可能看不懂，我来给大家解释一下，这张图是鸿蒙分布式内核hdc和普通安卓adb disassemble操作后的函数列表。大家可以清晰的看到，尽管鸿蒙os为了兼容安卓的写法和idiom所以一部分的函数名非常像，但这相似仅仅止步于名字而已，这图下面的两个红框内可以明显的看出，很多method的signature其实完全是不同的，进一步印证了鸿蒙系统是一个自主研发和编写的os。</p>
 <p data-pid="KLidSrE2">进一步来看，我认为鸿蒙兼容安卓软件的方法也是首屈一指，对class内method名称执行了经典PCRE操作，也就是regex.replace，确实是现阶段最快速的兼容方法了，为工程师点赞！</p>
 <p data-pid="fMDnC-Bg">所以，我认为可以很明确的看出，他们确实投入了非常多的人力物力来撑起我们国家os研发的一片天，让我们拭目以待吧。</p>
 <p data-pid="wvT2HsPB">===第n次更新</p>
 <p data-pid="D4I7o8I7">亮点来了！鸿蒙采用最近业界比较新颖的switch采样率转化算法来处理音频，我个人认为这是个非常新颖的想法，估计能比传统方法快上一些，但是确实还需要优化一下，可能导致.c文件代码行数过多的问题，先上图</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-e3e89cce217df1ba0ac3f60b32a49aa8_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1142" data-rawheight="1259" data-original-token="v2-5ec78ccdc9c311f44f1f0fc5df8e9cdf" data-default-watermark-src="https://pic1.zhimg.com/50/v2-e0637b377a6184af0c64fca075bc355e_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1142" data-original="https://pic1.zhimg.com/v2-e3e89cce217df1ba0ac3f60b32a49aa8_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="aHoLUGIi">红框内大家可以明显地看到，32000采样率的音频被通过鸿蒙系统转化为24000采样率了，这里科普一下，采样率越高，内存占用越大，估计鸿蒙内存还能省！太强了吧，没想到学术界的想法这么快就被华为应用了！，一个字， 牛！</p>
 <p data-pid="6MjDImpV">===第一次更新</p>
 <p data-pid="V3Dv-jCY">我刚刚看到了鸿蒙os的演示代码，先上图</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-87de64adccc58abbb4db9a408d16a4d5_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="720" data-rawheight="537" data-original-token="v2-3430e474302790f523d302e4533dabfb" data-default-watermark-src="https://pica.zhimg.com/50/v2-bba19f1548f546baed6b32bb9abde1b2_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="720" data-original="https://pic1.zhimg.com/v2-87de64adccc58abbb4db9a408d16a4d5_r.jpg?source=1940ef5c">
 </figure>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-71081b9df1919a92247c016adc49c36d_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="850" data-rawheight="601" data-original-token="v2-258ff701880b4e8ba5c04fd9f9bfb4c2" data-default-watermark-src="https://picx.zhimg.com/50/v2-d686e1a678b4c2ff4fdb46040ae066b7_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="850" data-original="https://pic1.zhimg.com/v2-71081b9df1919a92247c016adc49c36d_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="pVlvMt6g">果然不出所料，鸿蒙果然是走的路线在isa level直接支持java的运行，这结合了刚刚看到的html，完美的实现了javascript！十分的巧妙！</p>
 <p data-pid="R0Xb95It">=====</p>
 <p data-pid="w2tLtDdO">下面来个具体的例子，鸿蒙这次真的成了！</p>
 <p data-pid="IFuiZx1x">这是鸿蒙系统mem.c内核代码文件</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-5a1f72c530da05d3479fed353d7b8e04_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1142" data-rawheight="920" data-original-token="v2-5ba830bcebc8be34aaec5ecefb1f77b5" data-default-watermark-src="https://pica.zhimg.com/50/v2-aedd05890ee3a8459fca23b6eefd47e4_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1142" data-original="https://pic1.zhimg.com/v2-5a1f72c530da05d3479fed353d7b8e04_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="vk4DnGb0">外行用户可能看不懂，我讲解讲解，鸿蒙系统简化了以往linux系统有很多file descriptor的弊端，直接分布式的把所有descriptor设置为0（打开文件速度显著提升），极大的简化了打开文件的heap内存开销，至少减少内存使用一半！</p>
 <p data-pid="UjHd7ITH">第二，所有read操作都会很快的返回0值，意思就是读写操作速度的巨大提升！</p>
 <p data-pid="OS8e2YPx">我觉得真不错！</p>
 <p data-pid="gpfA2uKN">很多人说这里return 0有啥用呢？我来补充一点，其实在鸿蒙的assembly里面，返回值已经存在了register里面。</p>
 <blockquote data-pid="MM6Ac6HK">
  那几个内存操作的函数，看起来只是return 0，
  <br>
  其实是把整个内存操作塞在return这个instruction里面了。因为在底层的isa里，一个指令就能搞定内存操作。
 </blockquote>
 <p data-pid="-a-DkD-e">说的挺好的。</p>
 <p data-pid="sJmEZdBq">=====</p>
 <p data-pid="ZsWCRdoo">评论看到工程师对mmu和调度器的优化也非常大，我有时间继续更新，先研究研究代码。</p>
 <p data-pid="w8P8UvSX">免责声明：以上仅代表个人意见，本人不对内容的可靠性，正确性以及任何引用，截图，代码等任何引申内容做出任何具有法律约束力的保障。上文所有Harmony，鸿蒙，方舟，麒麟等词汇均指代各自中英文词汇本意，并无它指。</p>
</body>
# 用 Python 自动化办公能做到哪些有趣或有用的事情？
- 点赞数：5361
- 更新时间：2019年03月04日14时05分42秒
- 回答url：https://www.zhihu.com/question/313671299/answer/613206743
<body>
 <p data-pid="oQaJ9p_L">利益相关：Python办公自动化课程的讲师</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="8ObmfOgS">我想介绍一下我是如何从每天工作<b>8小时</b>，进化成每天工作<b>10分钟</b>的。</p>
 <p data-pid="Nw_5LlfK">不涉及太多的技术细节，毕竟知乎是一个分（现）享（编）知（故）识（事）的地方</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-0e6d3c2e607a67c79eba058d509196a3_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="422" data-rawheight="196" data-original-token="v2-4e273ab66d58998bc32e072309de291b" data-default-watermark-src="https://pic1.zhimg.com/50/v2-fc6f72c1734cc61deab88af4a49068fc_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="422" data-original="https://pica.zhimg.com/v2-0e6d3c2e607a67c79eba058d509196a3_r.jpg?source=1940ef5c">
 </figure>
 <h3>0.先自我介绍一下：</h3>
 <p data-pid="ojpXZDjr">我不是程序员，大学学的也<b>不是IT</b>专业。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-a2c5c7ddab82b736150c9bffcb76d255_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="220" data-rawheight="229" data-original-token="v2-bdf9da1a8a10cae98173931b2ec14b24" data-default-watermark-src="https://pic1.zhimg.com/50/v2-6a5d5116041467d074d55e5601fa1d50_720w.jpg?source=1940ef5c" class="content_image" width="220">
 </figure>
 <p data-pid="uoi1OUS7">我在一个主要业务是成品粮交易的企业工作，我的岗位的主要工作就是制作各类数据统计报表、台账、数据图表等等，反正就是各类日报，每天都要做一遍，此外还有什么周报月报什么的……这个岗位之前的同事，每天至少要花3.5到4个小时去折腾Excel，使用数据透视图、vlookup、其他各类函数去做出一份内含3000多个数据的日报。如果领导临时安排什么工作的话，那就要加班从浩如烟海的数据里找领导要的东西了。</p>
 <h3>1.噩梦开始时：</h3>
 <p data-pid="m95eysl-">我刚接手工作时，我们有一个巨大的，达70多M的Excel文件，每次公司配发的破电脑打开就需要小二十分钟，里面存着我们近十年的采购的每一车的详细信息……然后里面的数据格式还都是混乱的，</p>
 <p data-pid="dMecj7-7">打个比方，比如我们有个供货商全名叫：ABCD有限责任公司，</p>
 <p data-pid="utO80qpe">那么这个Excel中会存有</p>
 <p data-pid="MWBQSLlS">AB公司、</p>
 <p data-pid="Gsk0lp9q">AB有限公司、</p>
 <p data-pid="dgAWVr6y">CD有限责任公司、</p>
 <p data-pid="cg9qHwqA">CD责任有限公司、</p>
 <p data-pid="AVuXMWNR">ACBD有限公司</p>
 <p data-pid="ogyvu8W2">ABD公司</p>
 <p data-pid="_jzISEx0">等等等等名字</p>
 <p data-pid="71w9Oblc">在我第一天看到这个Excel的时候</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-53330ab066e0698d76bb10883b665f47_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="299" data-rawheight="280" data-original-token="v2-d4192d7db957ee84ce8ad5ee631f6bfa" data-default-watermark-src="https://pic1.zhimg.com/50/v2-3bc66eb8fb511c7d7ae4ab09c50f68be_720w.jpg?source=1940ef5c" class="content_image" width="299">
 </figure>
 <p data-pid="448wyqAL">后来交接的同事告诉我，她用的Excel的 vlookup 函数，当匹配不上的时候，就手工搜索……</p>
 <p data-pid="D2alvrbt">然后……我……</p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-d49a9e77ac69fb7ff1dbb67d2b72a69f_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="310" data-rawheight="265" data-original-token="v2-f007601134984d847d6451f082406168" data-default-watermark-src="https://picx.zhimg.com/50/v2-10f06832e3cddacf36ce5ae7c197573b_720w.jpg?source=1940ef5c" class="content_image" width="310">
 </figure>
 <p data-pid="0IisSwqF">就这样，经历了噩梦般的几个月……</p>
 <p data-pid="9cWAVQnU">等到了2017年年初，看到一个词:</p>
 <p data-pid="9g9GiAIE">图灵完备。</p>
 <p data-pid="fA6lnpIv">一个图灵完备的语言理论上能解决任何算法。</p>
 <p data-pid="hBLEEYtM">|</p>
 <p data-pid="Q5wivZeG">|</p>
 <p data-pid="i14ww3zC">V</p>
 <p data-pid="7HyFfFYR">显然，Python是一种图灵完备的语言。</p>
 <p data-pid="ZmCN5m1M">|</p>
 <p data-pid="XJn7fXpk">|</p>
 <p data-pid="gXssxn1N">V</p>
 <p data-pid="va2g6DQL">那Python应该在理论上能替我处理所有事情（生孩子应该不行~~）</p>
 <p data-pid="B7ziSA0z">|</p>
 <p data-pid="XL1hVnKC">|</p>
 <p data-pid="utzgsvor">V</p>
 <p data-pid="Nl9xOByz">我为什么不试着用Python去替我完成工作呢？</p>
 <h3>2.走了一些弯路，但胜过原地踏步</h3>
 <p data-pid="pXteJofy">我的第一步是从数据清洗开始的。（当然那时并不知道这个叫数据清洗）</p>
 <p data-pid="0sMgElnz">先把刚才说的那个70M的Excel导成csv，去掉了其中不必要的格式、样式、对象等。</p>
 <p data-pid="kymtQ5HF">然后我想统一一下各个数据的标准名称，刚才说了，由于经手的人太多，同一个数据，怎么表述的都有，几十万的数据量，人工交叉比对的话显然是不现实的。（后来才知道了笛卡尔积这个词）</p>
 <p data-pid="_93o-LFr">我第一步先使用了Excel自身的去重功能，将所有的供货商名称进行了一个去重，剩下了大概5000个左右的名称。</p>
 <p data-pid="ICbU7mMj">然后，作为一个懒人，我肯定不会用人工去比对了。</p>
 <p data-pid="Dr3omOOQ">Python有一个库，叫做fuzzywuzzy，用它来进行模糊匹配。</p>
 <div class="highlight">
  <pre><code class="language-text">from fuzzywuzzy import fuzz
print( fuzz.ratio("内容1", "内容2")）</code></pre>
 </div>
 <p data-pid="H4EIg704">会输出一个0——100的数字，数字越大代表这两个内容越相似。</p>
 <p data-pid="DSRxMknU">所以我就写了一个循环，把这5000多个项目里面，匹配度超过70%以上的数据组都筛了出来，再去Excel里面手工替换（没办法，那时候还不会操作Excel）</p>
 <p data-pid="FBNf4wOE">然后整理了一下各个行列的位置，这样我就有了一个相对准确的数据源。</p>
 <p data-pid="07iXsu1l">后来思考了一下，把数据存在Excel里面不是个长久之计啊，毕竟几十万数据呢，就想把数据导入到数据库里。大学时候考过计算机二级的Access（当然，虽然我考过，但是没考过……），就想导入Access，可是那个Python库没弄明白，硬是读不出来，就卡死了。</p>
 <p data-pid="Mk3G8Vzl">后来想到，之前自己从网上下载的某某私服的一键端里，有个MySQL数据库的一键启动方式，试了试居然能用，就把那个MySQL程序整个拷出来、清干净，作为了我的数据库。（当时想学怎么自己配置MySQL来着，没研究明白……这个数据库也就是我们现在提供的MySQL数据库的前身，当然了，我们现在提供的是重新制作的无毒的船新版本）</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-79168eff8d152cee27ee64957726945c_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="534" data-rawheight="576" data-original-token="v2-44d75467c582f860a23c9b68a10fa393" data-default-watermark-src="https://picx.zhimg.com/50/v2-03f683149ae9667b9ad65be08b571138_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="534" data-original="https://pic1.zhimg.com/v2-79168eff8d152cee27ee64957726945c_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Hn5PRy4X">然后就是使用Navicat导入Excel，使用pymysql库进行读取，这样，咱也是趁数据库的人了~</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-fefaf0c0c8350abe75e272e79600ecf5_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="248" data-rawheight="293" data-original-token="v2-fb1c585626fe80e3733d97e6723ac273" data-default-watermark-src="https://pica.zhimg.com/50/v2-493f68d50d5d79b51b2cf74a82ecf9f5_720w.jpg?source=1940ef5c" class="content_image" width="248">
 </figure>
 <p data-pid="HUBFbCeE">接下来，就是要进行数据分析了，由于当时没学会pandas，数据透视图的效果死活做不出来，不得已，只好新建N个列表，用一堆if...else... ，把同类数据存入同一个列表中，求和，求平均值之类的（<b>笨办法也是办法，能抓住耗子就是好猫，先把程序跑起来能用就好</b>）</p>
 <p data-pid="hlc9sSps">分析出了结果，要写入excel了，但是由于没有研究明白怎么进行追加写入（xlutils库各种限定太多了……），只好使用xlwt把数据写到一个空Excel中，然后手工把一整片复制粘贴过去……反正也是解决了……能用了……</p>
 <p data-pid="uXxTxEJg">因为每天的仓库返回的数据还要向数据库里追加，就写了个录入程序，先用xlrd读取、然后fuzzywuzzy模糊匹配、最后pymysql写入。</p>
 <p data-pid="vCT4E_FD">这时候，我的工作已由每天<b>七八个小时</b>，进化到了每天<b>4小时左右</b>。</p>
 <p data-pid="rmwRhCku">（这一部分代码就不贴了，祖传代码向来被称为屎山，这些代码也是简陋的过分的那种……）</p>
 <h3>3.走上杂务工作的快车道</h3>
 <blockquote data-pid="d4_0zT51">
  罗伯特·清琦写的那本《富爸爸穷爸爸》提出过一个概念，当你实现财务自由以后，你的财富积累就会走上良性循环的快车道，你的就会越来越容易提高被动收入。
 </blockquote>
 <h2>同理，<b>当你实现一部分的工作自动化以后，你就会走上一个“工作自由”的快车道，因为你有更多的时间能用来研究如何去更高效的完成余下的那堆工作，然后，每天工作的时间就会越来越短。</b></h2>
 <p data-pid="zPggf2At">为什么上文中我有那么多括号写的各种搞不定？因为没时间啊！</p>
 <p data-pid="wYSguBRi">现在好了，每天的工作时间已经被我砍了一半了，那么我就可以思考，如何解决各类的技术问题。</p>
 <p data-pid="aA8VG8Y8">我学会了Excel的各种库，比如xlrd、xlwt、xlsxwriter、openpyxl、xlwings、win32com，能根据自己的需要选择需要用的库；还学会了同属Office系列的python-docx和python-pptx，开始尝试自动制作Word和PPT；学会了自动发邮件的stmp库、zmail库；学会了能操作微信发消息的itchat；学了爬虫、学了解压缩、学了调整图片大小、学了Word转pdf等等等等很多库或者功能。</p>
 <p data-pid="UwDBHBKi">随着学习，每天的工作时间越来越短……</p>
 <p data-pid="Qk5JISIl">现在，我每天的工作，只需要十分钟，最快记录四分钟，就能完成。</p>
 <p data-pid="oSkfWDUK">每天上班，第一件事，优雅的运行一个py文件，一堆import后面，只有</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-559eae4d15c26c2a460f129985e232d3_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1138" data-rawheight="657" data-original-token="v2-31e4583e0737e9c9981def2b3f84c159" data-default-watermark-src="https://picx.zhimg.com/50/v2-4c88a2ba9f5e9835832eac439c171216_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1138" data-original="https://pica.zhimg.com/v2-559eae4d15c26c2a460f129985e232d3_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="7oC4v_JE">就完成了日常工作，然后就是需要打印，手签，送各领导审阅的过程了。</p>
 <p data-pid="0mDvWu1q">一个保守的、传统的、几十年都不会起一丝波澜的国有企业，硬生生被我干出来了一个IT岗，升职加薪都已达成。</p>
 <h2>4、后续的思考</h2>
 <p data-pid="OKkt7ByB">现在，我能极快的完成每天的工作，而后就是大片的学习思考的时间。</p>
 <p data-pid="iYDWZRt5">如今，</p>
 <p data-pid="qGRF4hqB">我已经，</p>
 <p data-pid="NSe4ZtiC">我已经，</p>
 <p data-pid="ueID1Gfe">我已经，</p>
 <p data-pid="60Y1CQ5-">把数据库移到了一台淘汰下来的办公电脑上，又用另外一台热备，作为公共联网数据库；</p>
 <p data-pid="kh_Z0BSf">我已经，</p>
 <p data-pid="pcznghTA">用pyqt写了一个带gui的数据输出软件，所有同事都可以自由输出数据进行分析了；</p>
 <p data-pid="ixqHR8-3">我已经，</p>
 <p data-pid="wC7ck3UZ">用pandas、matplotlib写了一个自动生成数据分析图片的软件，再做月报、周报什么的汇报材料，不用再通过Excel手工作图了；</p>
 <p data-pid="ay06plW3">我已经，</p>
 <p data-pid="mfzXU8-U">用pandas、matplotlib配合pyqt写了一个入库分析软件，大家输入时间段和限定条件后一键进行数据分析了，不会有同事老找我要数据了；</p>
 <p data-pid="_iNxtNf_">我已经，</p>
 <p data-pid="WOB2hMCS">用xlrd、python-docx写了一个合同生成器，旺季采购的同事不用焦头烂额的改合同了；</p>
 <p data-pid="yK2GkvZb">我已经，</p>
 <p data-pid="aAs4ICHT">用numpy配合pyqt做了一个购销存平衡软件，可以让领导们在决策时通过拖动滑块就可以实时展现不同购、销情况下库存情况了；</p>
 <p data-pid="ysmG2g1m">我已经，</p>
 <p data-pid="G8x9Eb9A">用爬虫配合pymysql写了一个实时粮价获取数据库，告别了浏览网页逐行复制价格的方式；</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="sLIL83XS">未来，</p>
 <p data-pid="PXE-xY4Q">未来，</p>
 <p data-pid="C1mNa09E">未来，</p>
 <p data-pid="dDk7nYmO">未来，</p>
 <p data-pid="g0mceud6">我计划做一个公司内部网站，把之前的所有C/S架构的软件都改成B/S。</p>
 <p data-pid="itD0x0gw">未来，</p>
 <p data-pid="eny9PIxV">我计划做一个数据驾驶舱，供领导决策使用。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-5f7b79a2115b881c03094ab9bb020f5e_720w.jpg?source=1940ef5c" data-size="normal" data-rawwidth="600" data-rawheight="337" data-original-token="v2-de8240b0ef9582edd019d5b7f5a8d11c" data-default-watermark-src="https://picx.zhimg.com/50/v2-67bf985cbc0708cda7899071da0ad09c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="600" data-original="https://picx.zhimg.com/v2-5f7b79a2115b881c03094ab9bb020f5e_r.jpg?source=1940ef5c">
  <figcaption>
   图片来自网上，我就是想做成这样子
  </figcaption>
 </figure>
 <p data-pid="C25iwHCx">未来，</p>
 <p data-pid="TttG0-_3">我计划做一个访客人脸识别，方便在重要客户进大门以后提醒领导到门口迎接。</p>
 <p data-pid="69XtG4Ed">未来，</p>
 <p data-pid="V4NM_eDi">我计划做一个更智能的爬虫，能在网上自动收集市场信息。</p>
 <p data-pid="BAWui1NM">未来，</p>
 <p data-pid="0_E0xmZd">我计划做一个更智能的进销存平衡软件，能使用最优化进行购销平衡计算。</p>
 <p data-pid="O4AcZ2uz">未来，</p>
 <p data-pid="9RXko7f2">我计划做一套发票管理系统给财务、一套物料管理系统给物资、一套工资系统给HR……</p>
 <h2><br>
  那么，你的未来，是每天继续做着重复的工作，还是从工作中解放自己，去拥抱更大的世界呢。</h2>
</body>
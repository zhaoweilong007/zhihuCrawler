# 为什么我时不时会看到「珍惜生命，远离 C++」？
- 点赞数：5035
- 更新时间：2020年06月05日18时46分33秒
- 回答url：https://www.zhihu.com/question/30806886/answer/163198839
<body>
 <p data-pid="r4bfNbJ5">竟然没人举实例，我给一个吧……</p>
 <div class="highlight">
  <pre><code class="language-text">1.#include"stdio.h"
2.#include"sparsepp-master/sparsepp.h"
3.int main()
4.{
5.	spp::sparse_hash_map&lt;std::pair&lt;int,int&gt;,int&gt; mp;
	6.mp.insert(std::make_pair(std::make_pair(1,1),1));
	7.return 0;
8.}</code></pre>
 </div>
 <p data-pid="HJeOzBfQ">这个程序时使用sparsepp库提供的hash版map来存数据的例子，但他有一个错误：库中并没有给出为std::pair&lt;int,int&gt;产生hash值的算法，因此该程序不能工作。</p>
 <p data-pid="i2NvshnF">理想情况下我们想要编译器这么提示我们：“亲爱的程序员，您的程序这里有错，错误原因和解决方法我都给你标注好了，么么嗒~~~”</p>
 <p data-pid="JE23McB1">具体错误提示大概长这样：</p>
 <div class="highlight">
  <pre><code class="language-text">line 6:mp.insert(std::make_pair(std::make_pair(1,1),1));
                                ^^^^^^^^^^^^^^^^^^^ can't generate serialization</code></pre>
 </div>
 <p data-pid="NzJi6czm">但实际上有点困难，一般编译器只会这么提示我们：“吔屎啦，这里这里这里这里这里这里我都看不懂，赶紧给老娘改！”</p>
 <p data-pid="GniLiRog">JAVA和javascript就喜欢这么干，错误提示大概长这样：</p>
 <div class="highlight">
  <pre><code class="language-text">In file sparsepp-master/sparsepp.h:1483:42: XXXXXX
In file sparsepp-master/sparsepp.h:5069:77: XXXXXX
In file main.cpp:6:25: type cast failed
In file main.cpp:3:1: XXXXX</code></pre>
 </div>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="_5xZbSMC">而混乱邪恶的C++是这样提示我们的：</p>
 <p class="ztext-empty-paragraph"><br></p>
 <div class="highlight">
  <pre><code class="language-text">In file included from main.cpp:2:0:
sparsepp-master/sparsepp.h: In instantiation of 'size_t spp::spp_hash&lt;T&gt;::op
erator()(const T&amp;) const [with T = std::pair&lt;int, int&gt;; size_t = long long u
nsigned int]':
sparsepp-master/sparsepp.h:1483:42:   required from 'size_t spp::sparsehash_
internal::sh_hashtable_settings&lt;Key, HashFunc, SizeType, HT_MIN_BUCKETS&gt;::ha
sh(const key_type&amp;) const [with Key = std::pair&lt;int, int&gt;; HashFunc = spp::s
pp_hash&lt;std::pair&lt;int, int&gt; &gt;; SizeType = long long unsigned int; int HT_MIN
_BUCKETS = 4; size_t = long long unsigned int; spp::sparsehash_internal::sh_
hashtable_settings&lt;Key, HashFunc, SizeType, HT_MIN_BUCKETS&gt;::key_type = std:
:pair&lt;int, int&gt;]'
sparsepp-master/sparsepp.h:4729:31:   required from 'size_t spp::sparse_hash
table&lt;Value, Key, HashFcn, ExtractKey, SetKey, EqualKey, Alloc&gt;::hash(const 
key_type&amp;) const [with Value = std::pair&lt;std::pair&lt;int, int&gt;, int&gt;; Key = st
d::pair&lt;int, int&gt;; HashFcn = spp::spp_hash&lt;std::pair&lt;int, int&gt; &gt;; ExtractKey
 = spp::sparse_hash_map&lt;std::pair&lt;int, int&gt;, int&gt;::SelectKey; SetKey = spp::
sparse_hash_map&lt;std::pair&lt;int, int&gt;, int&gt;::SetKey; EqualKey = std::equal_to&lt;
std::pair&lt;int, int&gt; &gt;; Alloc = spp::libc_allocator_with_realloc&lt;std::pair&lt;co
nst std::pair&lt;int, int&gt;, int&gt; &gt;; size_t = long long unsigned int; spp::spars
e_hashtable&lt;Value, Key, HashFcn, ExtractKey, SetKey, EqualKey, Alloc&gt;::key_t
ype = std::pair&lt;int, int&gt;]'
sparsepp-master/sparsepp.h:4242:33:   required from 'spp::sparse_hashtable&lt;V
alue, Key, HashFcn, ExtractKey, SetKey, EqualKey, Alloc&gt;::Position spp::spar
se_hashtable&lt;Value, Key, HashFcn, ExtractKey, SetKey, EqualKey, Alloc&gt;::_fin
d_position(const key_type&amp;) const [with Value = std::pair&lt;std::pair&lt;int, int
&gt;, int&gt;; Key = std::pair&lt;int, int&gt;; HashFcn = spp::spp_hash&lt;std::pair&lt;int, i
nt&gt; &gt;; ExtractKey = spp::sparse_hash_map&lt;std::pair&lt;int, int&gt;, int&gt;::SelectKe
y; SetKey = spp::sparse_hash_map&lt;std::pair&lt;int, int&gt;, int&gt;::SetKey; EqualKey
 = std::equal_to&lt;std::pair&lt;int, int&gt; &gt;; Alloc = spp::libc_allocator_with_rea
lloc&lt;std::pair&lt;const std::pair&lt;int, int&gt;, int&gt; &gt;; spp::sparse_hashtable&lt;Valu
e, Key, HashFcn, ExtractKey, SetKey, EqualKey, Alloc&gt;::key_type = std::pair&lt;
int, int&gt;]'
sparsepp-master/sparsepp.h:4401:38:   required from 'std::pair&lt;typename spp:
:sparsetable&lt;Value, typename Alloc::rebind&lt;Value&gt;::other&gt;::ne_iterator, bool
&gt; spp::sparse_hashtable&lt;Value, Key, HashFcn, ExtractKey, SetKey, EqualKey, A
lloc&gt;::_insert_noresize(T&amp;) [with T = const std::pair&lt;const std::pair&lt;int, i
nt&gt;, int&gt;; Value = std::pair&lt;std::pair&lt;int, int&gt;, int&gt;; Key = std::pair&lt;int,
 int&gt;; HashFcn = spp::spp_hash&lt;std::pair&lt;int, int&gt; &gt;; ExtractKey = spp::spar
se_hash_map&lt;std::pair&lt;int, int&gt;, int&gt;::SelectKey; SetKey = spp::sparse_hash_
map&lt;std::pair&lt;int, int&gt;, int&gt;::SetKey; EqualKey = std::equal_to&lt;std::pair&lt;in
t, int&gt; &gt;; Alloc = spp::libc_allocator_with_realloc&lt;std::pair&lt;const std::pai
r&lt;int, int&gt;, int&gt; &gt;; typename spp::sparsetable&lt;Value, typename Alloc::rebind
&lt;Value&gt;::other&gt;::ne_iterator = spp::Two_d_iterator&lt;std::pair&lt;std::pair&lt;int, 
int&gt;, int&gt;, spp::sparsegroup&lt;std::pair&lt;std::pair&lt;int, int&gt;, int&gt;, spp::libc_
allocator_with_realloc&lt;std::pair&lt;std::pair&lt;int, int&gt;, int&gt; &gt; &gt;*, std::pair&lt;c
onst std::pair&lt;int, int&gt;, int&gt;*, std::bidirectional_iterator_tag&gt;]'
sparsepp-master/sparsepp.h:4451:36:   required from 'std::pair&lt;typename spp:
:sparsetable&lt;Value, typename Alloc::rebind&lt;Value&gt;::other&gt;::ne_iterator, bool
&gt; spp::sparse_hashtable&lt;Value, Key, HashFcn, ExtractKey, SetKey, EqualKey, A
lloc&gt;::insert(spp::sparse_hashtable&lt;Value, Key, HashFcn, ExtractKey, SetKey,
 EqualKey, Alloc&gt;::const_reference) [with Value = std::pair&lt;std::pair&lt;int, i
nt&gt;, int&gt;; Key = std::pair&lt;int, int&gt;; HashFcn = spp::spp_hash&lt;std::pair&lt;int,
 int&gt; &gt;; ExtractKey = spp::sparse_hash_map&lt;std::pair&lt;int, int&gt;, int&gt;::Select
Key; SetKey = spp::sparse_hash_map&lt;std::pair&lt;int, int&gt;, int&gt;::SetKey; EqualK
ey = std::equal_to&lt;std::pair&lt;int, int&gt; &gt;; Alloc = spp::libc_allocator_with_r
ealloc&lt;std::pair&lt;const std::pair&lt;int, int&gt;, int&gt; &gt;; typename spp::sparsetabl
e&lt;Value, typename Alloc::rebind&lt;Value&gt;::other&gt;::ne_iterator = spp::Two_d_ite
rator&lt;std::pair&lt;std::pair&lt;int, int&gt;, int&gt;, spp::sparsegroup&lt;std::pair&lt;std::p
air&lt;int, int&gt;, int&gt;, spp::libc_allocator_with_realloc&lt;std::pair&lt;std::pair&lt;in
t, int&gt;, int&gt; &gt; &gt;*, std::pair&lt;const std::pair&lt;int, int&gt;, int&gt;*, std::bidirec
tional_iterator_tag&gt;; spp::sparse_hashtable&lt;Value, Key, HashFcn, ExtractKey,
 SetKey, EqualKey, Alloc&gt;::const_reference = const std::pair&lt;const std::pair
&lt;int, int&gt;, int&gt;&amp;; spp::sparse_hashtable&lt;Value, Key, HashFcn, ExtractKey, Se
tKey, EqualKey, Alloc&gt;::value_type = std::pair&lt;const std::pair&lt;int, int&gt;, in
t&gt;]'
sparsepp-master/sparsepp.h:5069:77:   required from 'std::pair&lt;typename spp:
:sparse_hashtable&lt;std::pair&lt;typename spp::remove_const&lt;Key&gt;::type, T&gt;, Key, 
HashFcn, spp::sparse_hash_map&lt;Key, T, HashFcn, EqualKey, Alloc&gt;::SelectKey, 
spp::sparse_hash_map&lt;Key, T, HashFcn, EqualKey, Alloc&gt;::SetKey, EqualKey, Al
loc&gt;::iterator, bool&gt; spp::sparse_hash_map&lt;Key, T, HashFcn, EqualKey, Alloc&gt;
::insert(const value_type&amp;) [with Key = std::pair&lt;int, int&gt;; T = int; HashFc
n = spp::spp_hash&lt;std::pair&lt;int, int&gt; &gt;; EqualKey = std::equal_to&lt;std::pair&lt;
int, int&gt; &gt;; Alloc = spp::libc_allocator_with_realloc&lt;std::pair&lt;const std::p
air&lt;int, int&gt;, int&gt; &gt;; typename spp::sparse_hashtable&lt;std::pair&lt;typename spp
::remove_const&lt;Key&gt;::type, T&gt;, Key, HashFcn, spp::sparse_hash_map&lt;Key, T, Ha
shFcn, EqualKey, Alloc&gt;::SelectKey, spp::sparse_hash_map&lt;Key, T, HashFcn, Eq
ualKey, Alloc&gt;::SetKey, EqualKey, Alloc&gt;::iterator = spp::Two_d_iterator&lt;std
::pair&lt;std::pair&lt;int, int&gt;, int&gt;, spp::sparsegroup&lt;std::pair&lt;std::pair&lt;int, 
int&gt;, int&gt;, spp::libc_allocator_with_realloc&lt;std::pair&lt;std::pair&lt;int, int&gt;, 
int&gt; &gt; &gt;*, std::pair&lt;const std::pair&lt;int, int&gt;, int&gt;*, std::bidirectional_it
erator_tag&gt;; spp::sparse_hash_map&lt;Key, T, HashFcn, EqualKey, Alloc&gt;::value_t
ype = std::pair&lt;const std::pair&lt;int, int&gt;, int&gt;]'
main.cpp:6:49:   required from here
sparsepp-master/sparsepp.h:943:27: error: use of deleted function 'std::hash
&lt;std::pair&lt;int, int&gt; &gt;::hash()'
         SPP_HASH_CLASS&lt;T&gt; hasher;
                           ^~~~~~
In file included from E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64
/lib/gcc/x86_64-w64-mingw32/6.3.0/include/c++/bits/basic_string.h:5628:0,
                 from E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64
/lib/gcc/x86_64-w64-mingw32/6.3.0/include/c++/string:52,
                 from sparsepp-master/sparsepp.h:839,
                 from main.cpp:2:
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-mi
ngw32/6.3.0/include/c++/bits/functional_hash.h:85:12: note: 'std::hash&lt;std::
pair&lt;int, int&gt; &gt;::hash()' is implicitly deleted because the default definiti
on would be ill-formed:
     struct hash : __hash_enum&lt;_Tp&gt;
            ^~~~
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-mi
ngw32/6.3.0/include/c++/bits/functional_hash.h:85:12: error: no matching fun
ction for call to 'std::__hash_enum&lt;std::pair&lt;int, int&gt;, false&gt;::__hash_enum
()'
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-mi
ngw32/6.3.0/include/c++/bits/functional_hash.h:66:7: note: candidate: std::_
_hash_enum&lt;_Tp, &lt;anonymous&gt; &gt;::__hash_enum(std::__hash_enum&lt;_Tp, &lt;anonymous&gt;
 &gt;&amp;&amp;) [with _Tp = std::pair&lt;int, int&gt;; bool &lt;anonymous&gt; = false]
       __hash_enum(__hash_enum&amp;&amp;);
       ^~~~~~~~~~~
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-mi
ngw32/6.3.0/include/c++/bits/functional_hash.h:66:7: note:   candidate expec
ts 1 argument, 0 provided
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-mi
ngw32/6.3.0/include/c++/bits/functional_hash.h:85:12: error: 'std::__hash_en
um&lt;_Tp, &lt;anonymous&gt; &gt;::~__hash_enum() [with _Tp = std::pair&lt;int, int&gt;; bool 
&lt;anonymous&gt; = false]' is private within this context
     struct hash : __hash_enum&lt;_Tp&gt;
            ^~~~
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-min
gw32/6.3.0/include/c++/bits/functional_hash.h:67:7: note: declared private he
re
       ~__hash_enum();
       ^
In file included from main.cpp:2:0:
sparsepp-master/sparsepp.h:943:27: error: use of deleted function 'std::hash&lt;
std::pair&lt;int, int&gt; &gt;::~hash()'
         SPP_HASH_CLASS&lt;T&gt; hasher;
                           ^~~~~~
In file included from E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/
lib/gcc/x86_64-w64-mingw32/6.3.0/include/c++/bits/basic_string.h:5628:0,
                 from E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/
lib/gcc/x86_64-w64-mingw32/6.3.0/include/c++/string:52,
                 from sparsepp-master/sparsepp.h:839,
                 from main.cpp:2:
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-min
gw32/6.3.0/include/c++/bits/functional_hash.h:85:12: note: 'std::hash&lt;std::pa
ir&lt;int, int&gt; &gt;::~hash()' is implicitly deleted because the default definition
 would be ill-formed:
     struct hash : __hash_enum&lt;_Tp&gt;
            ^~~~
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-min
gw32/6.3.0/include/c++/bits/functional_hash.h:85:12: error: 'std::__hash_enum
&lt;_Tp, &lt;anonymous&gt; &gt;::~__hash_enum() [with _Tp = std::pair&lt;int, int&gt;; bool &lt;an
onymous&gt; = false]' is private within this context
E:/mingw-w64/x86_64-6.3.0-posix-seh-rt_v5-rev2/mingw64/lib/gcc/x86_64-w64-min
gw32/6.3.0/include/c++/bits/functional_hash.h:67:7: note: declared private he
re
       ~__hash_enum();
       ^
In file included from main.cpp:2:0:
sparsepp-master/sparsepp.h:944:22: error: no match for call to '(std::hash&lt;st
d::pair&lt;int, int&gt; &gt;) (const std::pair&lt;int, int&gt;&amp;)'
         return hasher(__v);
                ~~~~~~^~~~~</code></pre>
 </div>
 <p data-pid="DykrHnXJ">C++：”你叼是吧？你调啊？你调啊？怎么不调了？刚才不是很跳么？哎我就不明白了，你现在嘴长哪去了？刚才blablablabla不是很能说嘛？你现在倒是说说看程序错哪里了啊？“</p>
</body>
# C++到底是如何从代码到游戏的？
- 点赞数：7958
- 更新时间：2022年02月15日19时17分43秒
- 回答url：https://www.zhihu.com/question/385197253/answer/1170395776
<body>
 <p data-pid="Q89IdzYv">这个简单啊。</p>
 <p data-pid="5zU5VAXD">你既然问C++了，那我问你，现在，我有一个Student类。C++怎么创建一个学生类的对象？</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="c1">// 嗯我会！有两种方式：
</span><span class="c1"></span><span class="n">Student</span> <span class="n">s</span><span class="p">;</span>
<span class="n">Student</span> <span class="o">*</span><span class="n">s2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="p">(</span><span class="s">"张三"</span><span class="p">);</span>
</code></pre>
 </div>
 <p data-pid="HsEKBH9K">那好，现在这学生的行为有：吃饭，睡觉，上网课。现在你执行个上网课的行为，怎么做？</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="c1">// 简单啊
</span><span class="c1"></span><span class="n">s2</span><span class="o">-&gt;</span><span class="n">upNetworkClass</span><span class="p">();</span>
</code></pre>
 </div>
 <p data-pid="Qu-3-sC9">通过对象调用成员函数不就成了么。</p>
 <p data-pid="2I2_ifOD">嗯，上面的代码在学校里都写过吧？有这个基础就够了。</p>
 <p data-pid="qPrEB8Ko">那游戏是啥？无非是一堆图形堆叠呗，把上面的Student类换成窗体类，换成控件类，换成游戏中不同的元素类，然后再组合起来不就完了么。</p>
 <p data-pid="r8LdBeVX">呐现在，我告诉你，有一个窗体类，叫QWidget，它有一个行为叫show，可以显示窗体。你给我生成一个窗体并显示出来。那就照葫芦画瓢呗：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="n">QWidget</span> <span class="o">*</span><span class="n">w</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QWidget</span><span class="p">();</span>
<span class="n">w</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
</code></pre>
 </div>
 <p data-pid="LPCeBSEq">来我们看看效果：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-eb39b055cdc7db5006287974230c4421_720w.jpg?source=1940ef5c" data-rawwidth="687" data-rawheight="530" data-size="normal" data-caption="" data-original-token="v2-68490aa797e0ba2a4423e09f5de32087" data-default-watermark-src="https://picx.zhimg.com/50/v2-8754adfac49d3eafac129a8e8d3bb195_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="687" data-original="https://pica.zhimg.com/v2-eb39b055cdc7db5006287974230c4421_r.jpg?source=1940ef5c">
 </figure>
 <blockquote data-pid="U3djjJCm">
  呀，有点意思哈？但是这距离游戏还差远呢啊。 你这窗体也太丑了不是。
 </blockquote>
 <p data-pid="qBcGSVV9">没事，窗体丑不要紧，我们给她美化一下！</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="n">TDWidget</span> <span class="o">*</span> <span class="n">w</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TDWidget</span><span class="p">(</span><span class="s">":/img/welcome.png"</span><span class="p">);</span>
<span class="n">w</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
</code></pre>
 </div>
 <p data-pid="XkqGxJUJ">QWidget换成了TDWidget，构造函数里传了一张图片，没超纲吧。再看看效果：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-45e590cc538877d60d6a7b4c856645aa_720w.jpg?source=1940ef5c" data-rawwidth="950" data-rawheight="623" data-size="normal" data-caption="" data-original-token="v2-6873d7be7c3b41cb075a97dac35f56c2" data-default-watermark-src="https://pica.zhimg.com/50/v2-ffb900349960a3c35d8c57c7851b50ab_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="950" data-original="https://pic1.zhimg.com/v2-45e590cc538877d60d6a7b4c856645aa_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="pOHaKSw9">诶？事情好像开始变的有趣了起来？</p>
 <blockquote data-pid="1Dl3R0Jl">
  但还是不够，我这是游戏，要交互的！你这一张死图能干啥。
 </blockquote>
 <p data-pid="wMghvbj1">交互嘛！加个按钮不完了？我给你一个按钮类，这个类有一个move()行为，可以把自己移动到画面的任何地方。你知道你想要的按钮怎么来了吗？</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="n">QPushButton</span> <span class="o">*</span> <span class="n">btn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">"按钮"</span><span class="p">,</span><span class="n">w</span><span class="p">);</span> <span class="c1">//第二个参数代表它属于哪个窗体，如果不写，它就会生成在屏幕上而不是窗体里
</span><span class="c1"></span><span class="n">btn</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">330</span><span class="p">,</span><span class="mi">450</span><span class="p">);</span>
</code></pre>
 </div>
 <p data-pid="G1vbDrRg">瞅瞅：</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-054f7d9a59c4677fe4e7bf7225b0f44a_720w.jpg?source=1940ef5c" data-rawwidth="920" data-rawheight="615" data-size="normal" data-caption="" data-original-token="v2-f0f896832c248fe894a1bc7033eebef4" data-default-watermark-src="https://picx.zhimg.com/50/v2-05270c5afa867b1a958a65cda7a9b9d5_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="920" data-original="https://picx.zhimg.com/v2-054f7d9a59c4677fe4e7bf7225b0f44a_r.jpg?source=1940ef5c">
 </figure>
 <blockquote data-pid="oYNHqR1Z">
  em.......你这按钮，有是有，画风有点突兀了吧。
 </blockquote>
 <p data-pid="T27t63Au">没事，再美化一下嘛：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="n">TDPushButton</span> <span class="o">*</span><span class="n">btn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TDPushButton</span><span class="p">(</span>
			<span class="s">":/img/begin_normal.png"</span><span class="p">,</span>	<span class="c1">// 常规图片
</span><span class="c1"></span>			<span class="s">":/img/begin_hover.png"</span><span class="p">,</span>	<span class="c1">// 鼠标悬停的图片
</span><span class="c1"></span>			<span class="s">":/img/begin_press.png"</span><span class="p">,</span>	<span class="c1">// 鼠标按下的图片
</span><span class="c1"></span>			<span class="n">w</span><span class="p">);</span>				<span class="c1">// 父控件
</span><span class="c1"></span><span class="n">btn</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">330</span><span class="p">,</span><span class="mi">450</span><span class="p">);</span>
</code></pre>
 </div>
 <p data-pid="HSPoqpdH">效果：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-3d4f950e00de93ddc77e489811e07ffd_720w.gif?source=1940ef5c" data-rawwidth="900" data-rawheight="600" data-size="normal" data-caption="" data-original-token="v2-3d4f950e00de93ddc77e489811e07ffd" data-thumbnail="https://picx.zhimg.com/50/v2-3d4f950e00de93ddc77e489811e07ffd_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="900" data-original="https://pic1.zhimg.com/v2-3d4f950e00de93ddc77e489811e07ffd_r.jpg?source=1940ef5c">
 </figure>
 <blockquote data-pid="TC2HBJqY">
  呀 可以啊。 快快快，然后呢，点开始游戏，进入游戏界面！这个咋做？
 </blockquote>
 <p data-pid="mzui-34z">嗯.....其实界面切换你自己已经会了。</p>
 <p data-pid="LrLNf07Q">你这个界面不就是一个窗体，想切换界面的话.....你把这个窗体关了，再换张图片开一个新的不就完了。</p>
 <p data-pid="FB0YR0_i">新的窗体用一张传新的图片做背景，我再顺手给加上四个按钮，代码不贴了，就是上面的代码复制粘贴改改坐标，改改图片：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-f7ba542dca8495523a3c261e14eb370b_720w.gif?source=1940ef5c" data-rawwidth="900" data-rawheight="600" data-size="normal" data-caption="" data-original-token="v2-f7ba542dca8495523a3c261e14eb370b" data-thumbnail="https://picx.zhimg.com/50/v2-f7ba542dca8495523a3c261e14eb370b_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="900" data-original="https://picx.zhimg.com/v2-f7ba542dca8495523a3c261e14eb370b_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Q8hiuls4">接下来就是游戏的主体部分了，也巨简单，有图就行：</p>
 <div class="highlight">
  <pre><code class="language-cpp"><span class="n">TDMenuButton</span> <span class="o">*</span><span class="n">btn1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TDMenuButton</span><span class="p">(</span><span class="s">":/img/1_normal.png"</span><span class="p">,</span><span class="s">":/img/1_hover.png"</span><span class="p">,</span><span class="s">":/img/1_selected.png"</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
<span class="n">btn1</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
<span class="n">TDMenuButton</span> <span class="o">*</span><span class="n">btn2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TDMenuButton</span><span class="p">(</span><span class="s">":/img/1_normal.png"</span><span class="p">,</span><span class="s">":/img/1_hover.png"</span><span class="p">,</span><span class="s">":/img/1_selected.png"</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
<span class="n">btn2</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">165</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
<span class="n">TDMenuButton</span> <span class="o">*</span><span class="n">btn3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TDMenuButton</span><span class="p">(</span><span class="s">":/img/1_normal.png"</span><span class="p">,</span><span class="s">":/img/1_hover.png"</span><span class="p">,</span><span class="s">":/img/1_selected.png"</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
<span class="n">btn3</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">165</span><span class="p">);</span>
</code></pre>
 </div>
 <p data-pid="uXOv99hP">三个按钮，和上面的TDPushButton没区别，就是换成了TDMenuButton对不对，没超纲吧。</p>
 <p data-pid="AoAp1n93">只要你的图片够美，就能生成这样：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-f10bef304ad8882ea0933cd1b9d0a684_720w.jpg?source=1940ef5c" data-rawwidth="882" data-rawheight="598" data-size="normal" data-caption="" data-original-token="v2-244527ee6d9995890d53530b19158755" data-default-watermark-src="https://pica.zhimg.com/50/v2-e4ddffe7f8f86f80b22c7019d7f3e15e_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="882" data-original="https://picx.zhimg.com/v2-f10bef304ad8882ea0933cd1b9d0a684_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="7VS-fVDb">一个按钮会写，三个按钮自然也会写，既然学了点C++都想做游戏了，循环总会写吧：</p>
 <div class="highlight">
  <pre><code class="language-cpp">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">11</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">TDMenuButton</span> <span class="o">*</span> <span class="n">btn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TDMenuButton</span><span class="p">(</span><span class="s">":/img/1_normal.png"</span><span class="p">,</span><span class="s">":/img/1_hover.png"</span><span class="p">,</span><span class="s">":/img/1_selected.png"</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
			<span class="n">btn</span><span class="o">-&gt;</span><span class="n">move</span><span class="p">(</span><span class="mi">100</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="mi">65</span><span class="p">,</span><span class="mi">100</span><span class="o">+</span><span class="n">j</span><span class="o">*</span><span class="mi">65</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
</code></pre>
 </div>
 <p data-pid="vp4gzPi8">效果：</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="B69aQTQH">多空几行，密恐福利：</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-9e4c67dc267c934d16b56ffd515857c1_720w.jpg?source=1940ef5c" data-rawwidth="912" data-rawheight="599" data-size="normal" data-caption="" data-original-token="v2-9dff160f09b39a0b5139bd1311c922bd" data-default-watermark-src="https://picx.zhimg.com/50/v2-43d17bce157fe10e1d5538b323bd231c_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="912" data-original="https://picx.zhimg.com/v2-9e4c67dc267c934d16b56ffd515857c1_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="FhwzaK2v">这.....怎么还有点一言难尽呢......</p>
 <p data-pid="ps4xhmPp">循环会写，随机数会写吗？ 随机个头像行吗？</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-f3348fff5f0a4ea555429327a19b54bb_720w.jpg?source=1940ef5c" data-rawwidth="910" data-rawheight="596" data-size="normal" data-caption="" data-original-token="v2-411c2cd8c5fdd8c4fef9eaf1c3ab886c" data-default-watermark-src="https://pic1.zhimg.com/50/v2-b885eca78f228e1a31bbeb6d5b5ffde4_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="910" data-original="https://pic1.zhimg.com/v2-f3348fff5f0a4ea555429327a19b54bb_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="4ZarEAxn">嗯......这下终于像点样了。</p>
 <p data-pid="zsAnGaKY">最后再加亿点点核心逻辑：点击两个相同的图片，判断它能不能连通，如果能连通，就把这两个按钮直接delete掉，效果就是酱紫：</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-b25b5da88fa4499abcce1959e10c1f33_720w.gif?source=1940ef5c" data-rawwidth="900" data-rawheight="600" data-size="normal" data-caption="" data-original-token="v2-b25b5da88fa4499abcce1959e10c1f33" data-thumbnail="https://picx.zhimg.com/50/v2-b25b5da88fa4499abcce1959e10c1f33_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="900" data-original="https://pic1.zhimg.com/v2-b25b5da88fa4499abcce1959e10c1f33_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="l-DXv7at">就是这样咯，从你学过的C++基础语法，结合现有的框架控件，就可以撸这样一个简单的连连看。</p>
 <p data-pid="5WchoKtv">当然了，为了点燃你题目里想要的学习热情，我故意避开一些以你现有知识可能听不懂的部分，还有一些逻辑比较绕的部分。比如：</p>
 <p data-pid="kO5mWYkN">避开了注册按钮的回调，</p>
 <p data-pid="FceEE0oJ">避开了随机生成图片的时候要保证成对出现的算法，</p>
 <p data-pid="OFdLyxRM">避开了把这些按钮和数据做关联，</p>
 <p data-pid="RAKpH9c_">避开了如何通过数据计算两点能否连通，</p>
 <p data-pid="wJcqFV3U">等等</p>
 <p data-pid="Qu9dvm6c">但这都不重要，不妨碍你简单体验一下<b>C++是如何从代码到游戏</b>的这个过程。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="-2mfe2SP">从图片素材上你们也看出来了，这代码是两三年前的，那个时候还在做培训机构的辅导老师，学生们爱打游戏，不好好上课，就做的这个上课带她们写。</p><a data-draft-node="block" data-draft-type="link-card" href="https://link.zhihu.com/?target=https%3A//github.com/TheThreeDog/PictureMatching" class=" wrap external" target="_blank" rel="nofollow noreferrer">王者荣耀风格的连连看</a>
 <p data-pid="oW38S9vH">因为本身我不打荣耀，所以里面的头像确实一个也不认识，都是那时候为了勾引学生好好上课，现在游戏里的头像应该有不少都更新好几茬儿了。</p>
 <p data-pid="UfyqtqPc">这个玩意儿是用Qt C++写的。因为本身对帧率没什么要求，所以基于Qt就可以搞。如果要玩一些真正的游戏（画面需要帧率级别的刷新的），一定要上游戏引擎写的。cocos2d unity3d 什么的。</p>
 <p data-pid="qWWzvGkp">当然，我上面说“游戏无非是一堆图形堆叠呗”只是为了讲解故意压低一下难度，真正的游戏开发是非常复杂庞大的。</p>
 <p data-pid="KGY5uMyF">这个小项目确实像上面写的一样，用了大量的TD开头的控件。这个源自于我的一个开源框架叫做TD-Framework</p><a data-draft-node="block" data-draft-type="link-card" href="https://link.zhihu.com/?target=http%3A//www.threedog.top/" class=" wrap external" target="_blank" rel="nofollow noreferrer">TD框架使用手册</a>
 <p data-pid="DYt1F_rg">因为我叫三级狗（ThreeDog）所以控件普遍用TD开头。Qt本身没有提供这种直接用图片构造控件的方法，所以就自己造了一些。</p>
 <p data-pid="1mr_Yuy4">写下它的时候还是大四刚毕业，那时候我还把这玩意儿叫框架，现在... 我觉得还是叫玩具更合适些：跨平台编译不过，函数指针强转有问题，代码也写的乱七八糟....</p>
 <hr>
 <p data-pid="SL09tpVr">其实你题目上的这个困惑：（到现在为止，老师也只会教你如何写代码）大家都是一样的，而且很遗憾的告诉你，不只是到现在为止，一直到你毕业，你在学校上课学的东西可能也仅限于黑框框里面打印点东西。至少用C++只能这样。</p>
 <p data-pid="jAJBJYRR">我大学的时候和你一样，我比你还急，语法没看利索就去摸cocos2d了，对着视频吭哧瘪肚地搭环境，把视频暂停下来抄代码，有一个地方有出入就跑不起来，对着报错一难过就是一整天。</p>
 <p data-pid="qG6iKWTj">那时候写代码仅限于：这么写可以实现这个功能，然后我照着这一句改吧改吧实现我的功能。</p>
 <p data-pid="rlcKvxJQ">一开始都是这么过来的。</p>
 <p data-pid="GNjptlna">回过头来看这个过程还是收获挺大的，硬着头皮折腾了这些东西，回过头再学基础的时候发现理解多少会有点不一样。</p>
 <p data-pid="ownbcSRZ">这几天我在研究函数指针和std::function的时候又翻到了cocos2d的源码。突然发现不光网上的小游戏的代码，cocos2d框架本身的源码对我而言也已经不再是天书，很多地方我已经能看懂了。</p>
 <p data-pid="gNv0jeP4">突然就明白当年为什么那样写可以实现函数调用。也突然就知道<code><i>menuselector</i></code><i>和</i><code><i>CC_CALLBACK</i></code><i>都是什么东西</i> 。说句没出息的，这个发现几乎成了我这几天的快乐源泉。毕竟实打实的看到了自己在编程道路上的成长。</p>
 <p data-pid="ojnZ1Iip">不管怎样爱折腾绝对是好事儿，当然，大学教的那点黑框框里的东西真的是非常非常重要的。</p>
 <p data-pid="AWDByfgf">加油吧</p>
 <p class="ztext-empty-paragraph"><br></p>
 <hr>
 <p data-pid="d2D3nAO5">20220215:</p>
 <p data-pid="18f8b2GW">我本人没有授权过任何机构和平台在B站修改，发布这篇回答，大家看到了顺手帮我点个举报吧。</p>
 <p data-pid="cR_rVVhz">最近不断收到好心人的提醒，我的文章又被抄了。我是真的累了 ，类似的视频我找知乎版权团队帮我处理过好几个，都下架了。但几乎每一次我都要提交一大堆信息，签署授权文件，走一堆流程才能把对方视频下了。我今天在B站上搜了一下“c++是如何从代码到游戏的” 妈呀十几个一模一样的视频，把我的内容抄走拉群卖课，我是真的管不动了，抄袭成本和维权成本完全不是一个量级。大家看到了顺手帮我点个举报吧，能下架最好，如果举报无效就无效吧，我也懒得折腾了。</p>
 <p data-pid="QVjHXirC">我目前还是在认真工作上班，夯实基础，没有出书或者开课的计划，老板们也不要因为此类需求再私信我啦。我先下还是想好好学技术，争取以后写出更多更好的文章给大家。</p>
</body>
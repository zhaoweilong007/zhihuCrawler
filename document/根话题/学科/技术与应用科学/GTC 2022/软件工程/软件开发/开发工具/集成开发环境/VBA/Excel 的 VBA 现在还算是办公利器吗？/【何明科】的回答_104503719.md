# Excel 的 VBA 现在还算是办公利器吗？
- 点赞数：6122
- 更新时间：2016年06月06日23时58分07秒
- 回答url：https://www.zhihu.com/question/24833569/answer/104503719
<body>
 <p data-pid="w-BAtf8e">先说结论，VBA依旧是办公利器。以我的个人经历而言，在BCG做过三年咨询顾问，写了上万行的VBA程序，每个项目一千至几千行程序不等。最后将Excel用成了中控界面，类似EMACS，在Excel可以随意操控全公司的打印机、Word、Powerpoint等等，自动完成各种任务以及数据更新和抓取。依靠VBA，在效率上是一般同事的数倍甚至是高一个量级，你说VBA还是不是办公利器？</p>
 <p data-pid="U8oFoBLc">不过题主得到的反馈也正常，许多高级程序员确实瞧不上VBA。因为程序员是有鄙视链的：汇编 &gt;C &gt;C++ &gt;Python &gt;Java及C#及PHP（这三者相互撕） &gt;VB &gt;HTML。在这长长的鄙视链中，甚至都没有VBA的位置。</p>
 <p data-pid="9Qn_Euff">但是Office+VBA是图灵完备的，所以被程序员用来耍酷的各类性感语言能实现的大部分功能，VBA都能实现，而且往往是以更高效更快捷的方式，在这里不谈效率和优雅。较之Python等常用语言，VBA各有攻防各有优缺点。Python的优势当然是扩展性强、超越Office环境之后的适用性强、资源丰富以及效率高，而VBA的优点如下：</p>
 <ul>
  <li data-pid="EhqzbDt4">环境不依赖，只需要打开装机自带的Office，然后按下Alt+F11就自动进入编程和执行环境</li>
  <li data-pid="PZpCUm1G">上手简单，学习曲线很平缓，甚至可以更简单的通过录制宏来解决写程序的问题，只需要在简单的代码基础上修修补补就可以执行，参考<a href="https://www.zhihu.com/question/20870802/answer/34107391" class="internal">Excel VBA 如何快速学习？ - 何明科的回答</a><br></li>
  <li data-pid="OgNBiSFb">与办公环境完美兼容，在Excel/Word/Powerpoint/Outlook/Access之间随便穿梭，比胶水语言还要简单易用</li>
  <li data-pid="4tY6w8e-">分享性和移植性很强，几乎所有测试通过的程序放到别的机器上也可轻易执行（如果不考虑各种本地文件位置）</li>
 </ul>
 <p data-pid="VZrpjS4O">基于以上的优劣势对比，VBA仍然是当之无愧的办公利器之王。而且大家不用太在乎手中的工具（VBA还是Python或者其他），核心还是使用工具的人以及人的思考。</p>
 <p data-pid="U-ZM_q44">下面列举Office+VBA实现的若干功能，真正为职场人士省时省事省力。大部分内容在回答（</p><a href="https://www.zhihu.com/question/27588491/answer/90603436" class="internal">Excel 到底有多厉害？ - 何明科的回答</a>
 <p data-pid="OF7mAD0_">）中已经出现过。不愿意点击过去阅读的，直接看下面的克隆内容。</p>
 <p data-pid="Wu4bFRAk"><b>1、批量修改格式</b></p>
 <p data-pid="KnmM7vFQ">下图是利用Powerpoint中录制的宏再加上稍微修改的代码（甚至都称不上是改代码，大部分是改参数），将Powerpoint中所有的字体及字号进行统一修改。常做PPT而且需要根据老板的喜好改来改去的同学们，知道这个批处理功能有多么救命。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/573d74cb3d835acefa17899774602b6e_720w.jpg?source=1940ef5c" data-original-token="573d74cb3d835acefa17899774602b6e" class="content_image">
 </figure>
 <br>
 <p data-pid="ORbl6zFx"><b>2、批量完成打印</b></p>
 <p data-pid="zWqbWlf8">刚进职场的新人，只要爸爸不是李刚，基本都做过影帝影后（影=印，各种复印打印的体力劳动）。特别是咨询投行服务行业，在大忽悠会议之前之后，花数小时或者整晚来打印数个文件，并不是天方夜谭。而且这件事情是对着同样一堆不断修改的文件，会经常不断重复发生。</p>
 <p data-pid="bVtJL0-8">我写的第一个VBA程序就是完成对100多张Excel表格的自动打印，因为是第一个VBA程序，所以比较挫，基本上是宏录制之后来改的，没有使用参考书及搜索引擎，全靠F1和自动提示，所以贴出来特别纪念一下。但也让大家清楚VBA上手也多么容易。实现的功能就是将每周都要做一次的100多张表格的按顺序打印让机器自动做一遍，而且需要防卡纸：按下一个“妞”，就慢慢美妙结果的发生。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/e7cd68b25900b0c5f4a6f60b935a05f5_720w.jpg?source=1940ef5c" data-rawwidth="676" data-rawheight="424" data-original-token="e7cd68b25900b0c5f4a6f60b935a05f5" class="origin_image zh-lightbox-thumb" width="676" data-original="https://pic1.zhimg.com/e7cd68b25900b0c5f4a6f60b935a05f5_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="48ge-Wa_">后来这个程序的升级版是：调度多台打印机，进一步提高效率，以及将打印机卡纸造成队列错误的概率降到极小的范围内。</p>
 <p data-pid="DVXSuvUu"><b>3、制作炫目视觉效果（图表、动画及油画）</b></p>
 <p data-pid="GB9JctBz">图表制作是每个Office一族的必备任务，制得一手好表格，绝对是升职加薪和偷懒放风的利器。在回答（</p><a href="https://www.zhihu.com/question/24331936/answer/48616123" class="internal">黄焖鸡米饭是怎么火起来的？ - 何明科的回答</a>
 <p data-pid="V9oMqpAo">），就利用Excel+VBA做出数张炫酷的信息地图，利用VBA为每个省的图形涂色。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/71d4c477d5d0216676743cc8ced48cdd_720w.jpg?source=1940ef5c" data-rawwidth="1373" data-rawheight="584" data-original-token="71d4c477d5d0216676743cc8ced48cdd" class="origin_image zh-lightbox-thumb" width="1373" data-original="https://picx.zhimg.com/71d4c477d5d0216676743cc8ced48cdd_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="w6S6wwd-">（涂色部分来自于网上的一段程序，制作GIF动画的是自己完成的）</p>
 <p data-pid="HzavqG_D">同时，为了进一步增强炫酷结果，还利用VBA将这些连续变化的图表做成了GIF动画。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/8a517ecb76ee3704e81aa399144e6beb_720w.jpg?source=1940ef5c" data-rawwidth="1197" data-rawheight="589" data-original-token="8a517ecb76ee3704e81aa399144e6beb" class="origin_image zh-lightbox-thumb" width="1197" data-original="https://picx.zhimg.com/8a517ecb76ee3704e81aa399144e6beb_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="U64ZbAzG">另外还可以利用Excel，把心仪妹子的图片拿到手，然后用Excel化成点阵图并进行油画效果的处理，然后送给她撩一撩。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/ae03578effcf9a205d0ad3c267d9eaa6_720w.jpg?source=1940ef5c" data-original-token="ae03578effcf9a205d0ad3c267d9eaa6" class="content_image">
 </figure>
 <p data-pid="o09o6XMO"><b>4、</b><b>撰写</b><b>八股文</b></p>
 <p data-pid="HwkJbXhz">这是帮朋友实现的一个项目，他们实验室是研究某类事故并对重大事故进行鉴定，最后发布word版的正式报告。之前的工作流程是在专业的软件中完成计算和仿真，最后按照正式报告八股文的行文，把各种关键信息填进去，最后写成Word文件。写报告的过程枯燥而没有技术含量，但却要反复进行。</p>
 <p data-pid="So6odQ01">通过下图的Word+VBA，完成主要的交互界面并连接计算软件。在通过简单的交互获取主要信息后，在后台完成计算并将主要信息填写入八股文的Word模版，最终完成报告，同时将结构化的信息存入Access数据库。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/7ad977587312726306a95db0a7197aa7_720w.jpg?source=1940ef5c" data-rawwidth="866" data-rawheight="521" data-original-token="7ad977587312726306a95db0a7197aa7" class="origin_image zh-lightbox-thumb" width="866" data-original="https://picx.zhimg.com/7ad977587312726306a95db0a7197aa7_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="zwthEDSw"><b>5、管理项目及同步内容</b></p>
 <p data-pid="68nlBNT5">这是协助某国际大型汽车制造厂完成新品牌及其新款车型上市，面临车型即将断档的窘境，该新车型的上市非常关键，不能错失时间节点。然而，新车型上市涉及到无数分支：制造、产品、市场、渠道、营销、公关、财务等等，同时还要协调欧洲的两个总部以及中国的两个分部。</p>
 <p data-pid="HUE1yXKD">这次咨询的核心任务就是项目管理，总控整个大项目的进度，并每周向中国区的CEO汇报进度并发掘出易出现问题的关键节点以调配资源。我们4个咨询顾问分配下去各自负责几个部门或者项目分支，和团队一起规划流程、画甘特图、确认里程碑及时间点、安排负责人等等。当每天回到办公室大家将进度汇总在一起的时候发现了挑战及难点，每条任务线并不是独立发展的，而是各条任务线交织在一起并互相影响。</p>
 <ul>
  <li data-pid="YHxBkP2k">某些核心人员在多个任务线出现。比如：负责预算的财务人员，几乎要出现在各条线中负责相关预算的审批环节</li>
  <li data-pid="Wd3UYb6S">某些任务线的里程碑是其他任务线里程碑的必要条件而相互关联。比如：新车的下线时间影响发布会的时间，相关法规测试的通过又影响车辆的下线时间等等</li>
 </ul>
 <p data-pid="UuxAXEei">当任务线增多以及任务线之间的交叉越发频繁的时候，汇总的任务将会几何级数增加，这就是我们在项目过程中遇到的问题。于是我利用Excel+VBA完成了这个工作的自动化。主要实现的功能：</p>
 <ul>
  <li data-pid="Z38kPlhj">自动将4个顾问手中分散的Excel文件汇集在一起形成一个大的总表，如下图</li>
  <li data-pid="FncfqMJ-">各顾问手中的表格是按照部门维度来划分的，汇总后需要按照不同的维度来输出不同类型的表格，比如：按任务线输出表格、按责任人输出表格、所有延误任务的表格、所有需要资源重点投入任务的表格等等</li>
 </ul>
 <figure>
  <img src="https://pic1.zhimg.com/50/735d490e3ccd5ada806b28230e7d7c31_720w.jpg?source=1940ef5c" data-rawwidth="921" data-rawheight="663" data-original-token="735d490e3ccd5ada806b28230e7d7c31" class="origin_image zh-lightbox-thumb" width="921" data-original="https://pic1.zhimg.com/735d490e3ccd5ada806b28230e7d7c31_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="CaefcAMa">在此基础之上，还要将上面提到的各种维度下的所有表格（大概有200多张），按要求格式粘贴到PPT中，每周提交给中国区的总部进行汇报和评估。密密麻麻的表格如下图。于是，我又写了一个程序将Excel中的表格输出到Powerpoint中，将一个秘书每次需要数小时才能完成的工作，简化成了一键发布，并可以在Excel中完成对PPT的更新。</p>
 <figure>
  <img src="https://pica.zhimg.com/50/13113c0de51532ae9d52781b90a5f984_720w.jpg?source=1940ef5c" data-rawwidth="1725" data-rawheight="745" data-original-token="13113c0de51532ae9d52781b90a5f984" class="origin_image zh-lightbox-thumb" width="1725" data-original="https://picx.zhimg.com/13113c0de51532ae9d52781b90a5f984_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="2fOitRzI">这个项目的程序量不小，近似于写了一个迷你版的Microsoft Project来进行项目管理。</p>
 <figure>
  <img src="https://pica.zhimg.com/50/6686906f828d327e4e90bd0f33adbffa_720w.jpg?source=1940ef5c" data-rawwidth="1841" data-rawheight="813" data-original-token="6686906f828d327e4e90bd0f33adbffa" class="origin_image zh-lightbox-thumb" width="1841" data-original="https://pic1.zhimg.com/6686906f828d327e4e90bd0f33adbffa_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="7WS11yAK">最后，下图中密密麻麻的PPT每周需要更新一次，每次都是快100张的工作量，然而基本上都是靠Excel来自动完成更新的。因为PPT的模版每次变化不大，我将这些模版记录下来，每周更新的时候只要根据Excel中最新的数据更改PPT中的数据即可。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/14ce50e4e2f1859d8d85c80b04ac669d_720w.jpg?source=1940ef5c" data-rawwidth="1709" data-rawheight="757" data-original-token="14ce50e4e2f1859d8d85c80b04ac669d" class="origin_image zh-lightbox-thumb" width="1709" data-original="https://pic1.zhimg.com/14ce50e4e2f1859d8d85c80b04ac669d_r.jpg?source=1940ef5c">
 </figure>
 <br>
 <p data-pid="ZKXpz9zF"><b>6、海量下载Bloomberg数据并完成分析</b></p>
 <p data-pid="P1L1pyfy">通过Bloomberg的VBA API，海量下载数百只目标股票的tick data以及order book。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/1753b3966dc2c5a0e7d339fed7ab5979_720w.jpg?source=1940ef5c" data-rawwidth="930" data-rawheight="273" data-original-token="1753b3966dc2c5a0e7d339fed7ab5979" class="origin_image zh-lightbox-thumb" width="930" data-original="https://picx.zhimg.com/1753b3966dc2c5a0e7d339fed7ab5979_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="LBPVKkHY">并根据实现构建好的数学模型，在后台完成计算，将上述的实时数据转化成每只股票实时的trading cost，实时展现在交易员最常用的Excel界面中，方便交易员评估当下的交易成本以便于优化交易策略。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/183842f4c1a2307f18d03b8cb20657c8_720w.jpg?source=1940ef5c" data-rawwidth="1205" data-rawheight="222" data-original-token="183842f4c1a2307f18d03b8cb20657c8" class="origin_image zh-lightbox-thumb" width="1205" data-original="https://pica.zhimg.com/183842f4c1a2307f18d03b8cb20657c8_r.jpg?source=1940ef5c">
 </figure>
 <br>
 <blockquote data-pid="Z2GDuaXn">
  更多文章请到<a href="http://zhuanlan.zhihu.com/hemingke" class="internal">数据冰山 - 知乎专栏</a>
  <br>
  更多回答请看<a href="https://www.zhihu.com/people/he-ming-ke" class="internal">何明科的主页</a>
 </blockquote>
</body>
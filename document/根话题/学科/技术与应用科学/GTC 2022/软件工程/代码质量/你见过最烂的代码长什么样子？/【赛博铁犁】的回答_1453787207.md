# 你见过最烂的代码长什么样子？
- 点赞数：7340
- 更新时间：2020年09月05日16时47分50秒
- 回答url：https://www.zhihu.com/question/265453795/answer/1453787207
<body>
 <p data-pid="66F-MMfv">我第一份工作清理的代码。十几年依然没见过更烂的。</p>
 <p data-pid="mEH1UixA">3500行的主逻辑代码，只有一个函数！！！</p>
 <p data-pid="KQOg2Uxn">函数的开头声明了一百多个变量，包括i, j, k这种计数器（C++代码哦）。</p>
 <p data-pid="5KbfocFt">里面是一个奇大无比的连续if。</p>
 <p data-pid="_vqa3Reu">每一个else if代表一个逻辑分支。一共判断了十几次。</p>
 <p data-pid="kq954Pfd">整个项目有十几万行。</p>
 <p data-pid="751k5iT2">工具类绝不抽离出来做函数，最夸张的在同一个函数中都能写四五次。有的逻辑在整个系统中重复写了不下十几次。</p>
 <p data-pid="ISkErhfZ">神秘数字多如牛毛。绝不用宏或者常量替代。</p>
 <p data-pid="sqjyDxgp">注释基本上只有一种//xxx modified at yyyy/mm/dd</p>
 <p data-pid="eMNea-Jq">跑起来的效果是每一两个小时就崩溃一次。</p>
 <p data-pid="NcFkH0CC">当时也是初生牛犊不怕虎。刚好住在公交的始发站附近，每天都有位子。于是买了本《代码大全》，每天上下班就抱着啃。啃完了就照着书里说的原则去改。</p>
 <p data-pid="1GLEVRu5">花了小半年吧。</p>
 <p data-pid="4_A1VNUd">把所有的工具代码都抽出来做了工具类。</p>
 <p data-pid="jJQnhFe_">把大函数都拆成几十行的小函数。</p>
 <p data-pid="S7PhNz33">用VC全项目一个数字，一个数字的搜索，把所有能找到的神秘数字都抽出来用宏或者常量来替代。保证代表同一件事物的神秘数字，只出现一次。</p>
 <p data-pid="-gsf-QgX">那个巨大的if，改成了switch，并且主函数里面，几乎只有这一个switch和针对不同逻辑需要的参数变量，每一个开关下，直接去调用一个逻辑函数。</p>
 <p data-pid="0v553H3D">在所有清理好的重要的地方，都加了伪代码注释。</p>
 <p data-pid="691tuv40">最终削减了近三分之一的代码。还顺手增加了几个小功能。</p>
 <p data-pid="D59-vrbZ">测试一个月，7*24小时运转，崩溃三次。</p>
 <p data-pid="5RPJSogS">我本来还不满足。结果老板告诉了我一个重要的人生哲理。</p>
 <p data-pid="9VVVURzA"><b>客户签的合同要求没这么高。你费那个劲干嘛。那几个功能已经白送了。他又不给咱们加钱。</b></p>
 <p data-pid="dNuB3stG">交差。</p>
</body>
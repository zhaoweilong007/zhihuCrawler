# 如何根据一张 A 楼照 B 楼的照片判断出这张照片是 A 楼的几层？
- 点赞数：5559
- 更新时间：2018年01月13日10时23分38秒
- 回答url：https://www.zhihu.com/question/24651925/answer/28527771
<body>
 <p data-pid="fxvR3uPR">注：最高票答案<a href="http://www.zhihu.com/people/navisli" class="internal">NavisLi</a>的极简方案：平行线交点所在楼层就是对楼等高楼层，是<b>正确</b>的。但只适用于相机不倾斜的情况，本文将给出几组判断方法，适用于更广泛的情况。</p>
 <p data-pid="isfA3Jyo">=====================正文=====================<br>
  平行直线是图片测量的基础，无论是45度仰视拍摄还是两栋楼朝向不平行，都可以完美解决这一问题。然而，也并不是画几条平行线那么简单，下面介绍这种方法的原理。</p>
 <p data-pid="huWElQUp">首先在图像上找两组<b>水平</b>平行线。</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/ce2455b14768c470c7fe0c8212f09c3e_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="600" data-rawheight="799" data-original-token="ce2455b14768c470c7fe0c8212f09c3e" class="origin_image zh-lightbox-thumb" width="600" data-original="https://picx.zhimg.com/ce2455b14768c470c7fe0c8212f09c3e_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="cam9X4b6">对于真实世界中的一组平行直线，可以认为它们不相交，也可以认为相交在无穷远处。因为摄像机把直线映射为直线的性质，经过摄像头小孔的成像（射影变换），这一在三维空间处无穷远处的交点在图像上反而可以看见了，这和你能看见笔直铁轨的交汇处是一个道理。</p>
 <p data-pid="8VOe6gJJ">在图像上这一交点称为消影点或者灭点，通过延长平行直线的像得出（蓝色圆点）。当平行线段有很多时，其延长线不唯一，这时就需要使用比如最小二乘法，得到一个离所有平行直线都比较接近的点：</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/60f94642c76b3d96fd41cca3da825942_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1000" data-rawheight="799" data-original-token="60f94642c76b3d96fd41cca3da825942" class="origin_image zh-lightbox-thumb" width="1000" data-original="https://picx.zhimg.com/60f94642c76b3d96fd41cca3da825942_r.jpg?source=1940ef5c">
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="Uhxb10In">两组水平平行线可以得到两个消影点（其位置有可能出了图像边框），把这两个消影点连起来，就得到了<b>地平线</b>（上图亮蓝色）。地平线上每一个点都是某一组<b>水平</b>平行直线的交点的像，<b>所有</b>水平平行线的交点都在地平线上。<b>图像上所有比地平线高的点，在真实世界中都比摄像头高；所有比地平线低的点，在真实世界中都比摄像头低。摄像头朝向是否水平不影响这些关系的成立。</b></p>
 <p data-pid="BDMHCedA">假设两个楼朝向相同，对应层高度也相同，下面可以使用多种途径解决题主的问题。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <ul>
  <li data-pid="RPEiGBeb">方法1：找到对面楼层某些窗台，使得窗台上沿比地平线高（因此在真实世界中比摄像头高），窗台下沿比地平线低（因此在真实世界中比摄像头低），这一层与摄像头同层。当相机没有旋转时，地平线与图像边缘平行，因此找到一个消影点就找了地平线，但是大多数情况下相机都有一定旋转，因此只有找出两组水平平行线，得到两个消影点，才能准确定位地平线。</li>
  <li data-pid="_ocCwKxj">方法2： 因为拍摄者所在的半个窗户下沿和对面楼某层上所有半个窗户下沿是水平平行的，把这两个半窗户下沿连起来，应该得到一个近似梯形（对应三维空间中水平的平行四边形）：</li>
 </ul>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/7b5bc23a5f8db863fe0a38520e62e682_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1000" data-rawheight="799" data-original-token="7b5bc23a5f8db863fe0a38520e62e682" class="origin_image zh-lightbox-thumb" width="1000" data-original="https://pic1.zhimg.com/7b5bc23a5f8db863fe0a38520e62e682_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="lzIpJx37">平行四边形两条横跨两栋楼房的边相互水平平行，因此二者延长线的交点应该处在无穷远处，因此在图像上也应该在地平线上。在本图中，只有正中的那一层窗户延长线离地平线很近，稍微往高一层或者往低一层，交点与地平线的距离就变得很大：</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/c9e1d1f8c686a47fe39dabee712629ac_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1000" data-rawheight="799" data-original-token="c9e1d1f8c686a47fe39dabee712629ac" class="origin_image zh-lightbox-thumb" width="1000" data-original="https://pic1.zhimg.com/c9e1d1f8c686a47fe39dabee712629ac_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Kvb8JKkU">因此对面等高楼层就是水平平行直线的交点离地平线最接近的那一层。</p>
 <ul>
  <li data-pid="WNGe7htt">方法3： 首先在地平线上随便找一个点（蓝色圆点），把这一点和摄像者所在窗台下沿的两边连起来。然后把左边的消影点（在图像外面）和这一图形相连，得到一系列黄色小棒，因为从左边消影点发出的所有直线都相互水平平行，而任一消影点发出的直线也水平平行，所以这些小棒棒也全都水平平行，长度相等（因为相邻小棒棒之间的四边形在真实世界中对边水平平行，是平行四边形）。在这些黄色小棒棒里，只有最上面的小棒棒的长度恰好和那一层的半个窗户长度近似。其他黄色小棒棒并不与对应楼层半个窗户吻合，说明它们其实是悬浮在两楼之间的半空中，而不是贴在对面楼面上。</li>
 </ul>
 <p class="ztext-empty-paragraph"><br></p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/dc9d7fab37e17228c223f5b25920541b_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1000" data-rawheight="799" data-original-token="dc9d7fab37e17228c223f5b25920541b" class="origin_image zh-lightbox-thumb" width="1000" data-original="https://picx.zhimg.com/dc9d7fab37e17228c223f5b25920541b_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="AopaF5wH">因此对面等高楼层就是黄色小棒长度和所在楼层半个窗户吻合的那一层。</p>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="LJcyqCVK">上述方法不仅可以估计图像中的等高楼层，还可以定量测量出其他很多长度、角度的大小，在图像测量中均有十分广泛的应用。</p>
</body>
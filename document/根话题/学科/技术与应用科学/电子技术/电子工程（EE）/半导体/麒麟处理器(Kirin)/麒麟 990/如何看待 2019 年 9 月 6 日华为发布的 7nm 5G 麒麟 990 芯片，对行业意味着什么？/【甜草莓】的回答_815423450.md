# 如何看待 2019 年 9 月 6 日华为发布的 7nm 5G 麒麟 990 芯片，对行业意味着什么？
- 点赞数：5563
- 更新时间：2019年09月06日21时28分24秒
- 回答url：https://www.zhihu.com/question/344453437/answer/815423450
<body>
 <p data-pid="FVBJ9kmz">Kirin 990 终于来了。</p>
 <p data-pid="ds02QV7a">本次发布会亮点颇多，从开幕演讲，到把华为比作黑天鹅，再到Kirin 990 发布，几乎贯穿全程。一句话总结5G和AI：<b>物联网已经成为现实，AI将会成为未来</b>。</p>
 <p data-pid="W-TBkOko">这里只能介绍几个我非常感兴趣的地方：</p>
 <ul>
  <li data-pid="Fi4u-KZ8">Kirin990 5G 性能</li>
  <li data-pid="PBPA6ckX">NPU 中新的大小核设计</li>
  <li data-pid="thf0V64d">在mobile ISP中实现工业级图像去噪（BM3D）/视频去噪</li>
 </ul>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="JBAgOyTo"><b>1. Kirin 990 5G版性能</b></p>
 <p data-pid="3TgDHbcW">如果我们把目前未发布和已发布的5G SoC 方案和外挂5G 基带方案做对比，大约可以有这样的图表。</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-f9e0164a09c440888f868f56eee7b102_720w.jpg?source=1940ef5c" data-size="normal" data-rawwidth="2960" data-rawheight="1630" data-original-token="v2-c58ac8eae9160f35a7f66ca276cf24f1" data-default-watermark-src="https://picx.zhimg.com/50/v2-0a22ffce7291c53fb572f7f2591d27e8_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="2960" data-original="https://picx.zhimg.com/v2-f9e0164a09c440888f868f56eee7b102_r.jpg?source=1940ef5c">
  <figcaption>
   数据来自Anandtech和发布会
  </figcaption>
 </figure>
 <p data-pid="n95ARYCV">对比Kirin980 , 990 的CPU部分依然延续了2*A76超大核、2*A76大核加上4个A55小核心的设计，重点是提升了频率，降低了功耗。虽然A77没有到来让人有些失望，但是现在的配置与业界主流旗舰芯片相比，单核性能也提高了10%，多核性能提高了9%，能让手机更加流畅。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-ed1b274ffb76a3298a31e25b0a5c5f81_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1866" data-rawheight="1306" data-original-token="v2-c7e1f49f90a4682295ea763f7395e3f3" data-default-watermark-src="https://picx.zhimg.com/50/v2-08d17cb7c96edbcad23cdddcaf909b35_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="1866" data-original="https://picx.zhimg.com/v2-ed1b274ffb76a3298a31e25b0a5c5f81_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="LdyYusLC">GPU 部分从原本的10核心Mali-G76 上升到16核Mali-G76 ，疯狂堆核。</p>
 <p data-pid="Lukp84W3">制程也采用了台积电最新的<b>7nm LPP EUV</b>工艺。</p>
 <p data-pid="IZDwtvkv">这些毫无疑问都是Kirin系列的大幅度升级，具体的对比可以详细研究上图。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-615b3e628cecec7552a4bb8fdca384dd_720w.jpg?source=1940ef5c" data-size="normal" data-rawwidth="2426" data-rawheight="922" data-original-token="v2-e3c754dd0679dd03f851ee1f691faaf4" data-default-watermark-src="https://pica.zhimg.com/50/v2-97e2bf0cdca9c763d70363888aae5f4a_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="2426" data-original="https://pic1.zhimg.com/v2-615b3e628cecec7552a4bb8fdca384dd_r.jpg?source=1940ef5c">
  <figcaption>
   余承东现场掏出Kirin 990芯片····
  </figcaption>
 </figure>
 <p data-pid="mh_IiKPN"><b>Kirin 990 历史性的进步：它是一款5G SoC芯片而不是外挂基带</b>。5G SoC方案和外挂5G基带方案对比，所带来的优点是芯片占用面积的降低，让手机中有更多设计空间来放置其它模块。这也算是商用速度非常快的5G SoC了，如果抛弃一些厂商不成熟的抢发和ppt等行为（请看上表中的一系列未知），那么Kirin 990可以算得上首个发布的5G SoC解决方案。发布会上说的是，麒麟990 5G是全球首款<b>旗舰5G SoC芯片，</b>因为E家定位并不是旗舰手机。</p>
 <p data-pid="HzpVWmPE">其实吧，我觉得是不是第一也没那么重要，能不能用得上才重要····奈何很多人觉得第一名头就响····</p>
 <p data-pid="QQArwt1z">内置5G模块里，Balong 5000 的SA/NSA，TDD和FDD频谱支持（FDD频谱主要是600~800MHz之间的广覆盖和多播频谱）也延续了下来。现场公布移动测试速度1700Mbps左右。这一代的Kirin 990和其它都没有提到毫米波，看来大家都觉得毫米波暂时用不上。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-cdcd84960bfd236499c81061825ab72d_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="3874" data-rawheight="1568" data-original-token="v2-a6bde9821e4915461d3e99d1ca6b448f" data-default-watermark-src="https://pic1.zhimg.com/50/v2-71ef20d0ba5eaa53d4318ac43699e1d4_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="3874" data-original="https://picx.zhimg.com/v2-cdcd84960bfd236499c81061825ab72d_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="A0DiOd-m">新的Bandwidth Part(BWP) ，看起来像是自适应修改了5G单载波带宽，从而降低待机功耗。<br></p>
 <p data-pid="RrmpbqNj"><b>2. NPU中新的大小核设计</b></p>
 <p data-pid="9YnJLLXf">Kirin 990 另外一个有意思的地方是，这次内置的NPU采用了和CPU相似的大小核设计 (Ascend Lite *2 + Ascend Tiny)，也就是<b>异构多处理器结构</b>。</p>
 <p data-pid="gD2vzZz2">对于通用计算单元来说，大小核设计的优点很明显：可以同时兼顾计算能力和功耗，高性能应用可以启用大核，功耗更高，低性能应用可以调用小核，具体Linux和ARM都有相应的切换工具<sup data-text="为什么电脑 CPU 不像手机 SoC 那样设计成大小核?" data-url="https://www.zhihu.com/question/68215387/answer/564233008" data-draft-node="inline" data-draft-type="reference" data-numero="1">[1]</sup>。</p>
 <p data-pid="PeES7CXi">对于NPU这种神经网络专用计算单元，大小核心分离，大核性能提高可以让视频、图像这些计算机视觉应用处理速度更快，以前做不到实时处理的一些处理，现在能做到实时（现场的实时AI P图还是很震撼的）；小核可以在平常运算中带来功耗降低。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-8e7488be8709112cb136740a9e82fe23_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="3956" data-rawheight="1596" data-original-token="v2-5585ac0a2f0b961431470d9a3a0e4036" data-default-watermark-src="https://pic1.zhimg.com/50/v2-f5d05c56973017cc27edb7cef1e62558_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="3956" data-original="https://picx.zhimg.com/v2-8e7488be8709112cb136740a9e82fe23_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="ZeTxk5xF">但是带来的问题是，ai相关的应用有没有那么多计算任务需要去切换？以及怎么区分高性能和低性能应用，来调度大小核心？</p>
 <p data-pid="jDO8n22P">对此华为给出的答案是有，他们认为人脸识别这种日常应用属于低性能应用，并不需要调度大核，而图像增强、目标识别、视频分割这些属于高性能应用，可以通过调度大核来提高计算能力。剩下的就是核心调度算法的优化问题了。</p>
 <p data-pid="8YdCWat-"><b>在NPU单元做大小核心分离，从而降低 低计算力场景芯片功耗尚属首次商用</b>；如果我们放眼未来，大小核带来的功耗和性能优势会随AI应用越来越多而越来越显著。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-7e880d299eaa49a2559ec6bc465a27d2_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="4096" data-rawheight="1579" data-original-token="v2-fd8af52d4e8b88cbc33d038bfcdd2305" data-default-watermark-src="https://picx.zhimg.com/50/v2-ba04ec850c7b6201602b42e05712a1e8_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-7e880d299eaa49a2559ec6bc465a27d2_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Vy4MezQo">目前，华为的AI-API已经被调用1.6万亿次，这或许就是开头说明AI是未来的原因。<br></p>
 <p data-pid="0__W_VAd"><b>3.图像去噪和BM3D</b></p>
 <p data-pid="zSbgKPkW">BM3D算法及其分支是<b>传统</b>图像去噪算法中极其强大的一种，接近图像去噪的理论界限<sup data-text="Levin A, Nadler B. Natural image denoising: Optimality and inherent bounds[C]//CVPR 2011. IEEE, 2011: 2833-2840." data-url="" data-draft-node="inline" data-draft-type="reference" data-numero="2">[2]</sup>，让图像去噪算法进展停滞了数年<sup data-text="Knaus C, Zwicker M. Progressive image denoising[J]. IEEE transactions on image processing, 2014, 23(7): 3114-3125." data-url="" data-draft-node="inline" data-draft-type="reference" data-numero="3">[3]</sup>，这毫无疑问是图像去噪领域的里程碑式算法，即使是现在，虽然深度学习可以通过训练集训练得到非常好的先验知识指导去噪来获得令人震撼的效果，但是个人以为，以有先验建模/训练的去噪算法（e.g. sparse coding/deep learning based）和基于传统信号处理的去噪算法（NLM, BM3D, PID etc)对比，依然是不太公平的。</p>
 <p data-pid="DWB29cnP">从芯片角度，手机SoC(System on Chip)一般包含CPU(中央处理器)、GPU(图形处理器)、ISP(图像信号处理器)、Modem(调制解调器)。在ISP处理流程中，图像去噪是非常基础也非常必要的，也是更进一步图像增强的基础。也正是因为图像信号在从相机获取和传输过程中都会不可避免的受到噪声污染导致图像质量退化，对图像的后续处理会产生严重影响，所以手机/相机/摄像头拍摄都要经过denoise单元。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-7041633a4d4c69c698d23a963e9cae0e_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="1968" data-rawheight="1126" data-original-token="v2-f03ace7b8e966e35d9f591dd19392acb" class="origin_image zh-lightbox-thumb" width="1968" data-original="https://picx.zhimg.com/v2-7041633a4d4c69c698d23a963e9cae0e_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="dEqYsw1d">最简单的图像去噪方法是<b>均值滤波</b>，简单说就是把像素周围的<b>临近</b>像素加权之后求平均（这是一种空域算法）。但是，我们一定要用临近像素吗？</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-f6fd62194fb213ad46885d201099a818_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="518" data-rawheight="234" data-original-token="v2-019a27e1cf3ae0f783f39267c148d943" class="origin_image zh-lightbox-thumb" width="518" data-original="https://pic1.zhimg.com/v2-f6fd62194fb213ad46885d201099a818_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="Y3QsSjDX">并不一定，自然图像中有一个重要的特性叫做<b>非局部相似性</b>，如果用过PS的同学应该有注意到，我们总能找到图像中某些相似部分，比如窗口位置粘贴过来放在其它的相似窗口部分，通过这种粘贴操作，去替换掉某些被破坏的像素或者污渍。</p>
 <figure data-size="normal">
  <img src="https://pica.zhimg.com/50/v2-6c3b878cae618b675574fb73c2c5832a_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="510" data-rawheight="506" data-original-token="v2-20b8ced6180716531cb2d5ff12a85853" class="origin_image zh-lightbox-thumb" width="510" data-original="https://picx.zhimg.com/v2-6c3b878cae618b675574fb73c2c5832a_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="hY7UxszZ">那么如果用图像中<b>其它、不相邻的</b>相似区域来做加权平均，可以得到比简单的均值滤波更好的效果。这就是鼎鼎大名的去噪算法NLM（Non-Local Means）的基础思想：<b>先寻找相似块，然后均值滤波</b>。</p>
 <p data-pid="ioLlW5SJ">发布会中提到的BM3D<sup data-text="Dabov K, Foi A, Katkovnik V, et al. Image denoising by sparse 3-D transform-domain collaborative filtering[J]. IEEE Transactions on image processing, 2007, 16(8): 2080-2095." data-url="" data-draft-node="inline" data-draft-type="reference" data-numero="4">[4]</sup>（Block-matching and 3D filtering，3维块匹配滤波）可以当做NLM的升级版，不一样的地方是BM3D找到相似块以后所做的不是简单的均值滤波这种<b>空域处理</b>，而是通过小波变换，把堆叠之后的相似像素块转换到变换域（<b>就是发布会所提到的频域</b>）。</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-8c36800af894635992a96eea1d90066c_720w.jpg?source=1940ef5c" data-size="normal" data-rawwidth="1318" data-rawheight="686" data-original-token="v2-baa3c75e012c7e19d7a0087343943074" class="origin_image zh-lightbox-thumb" width="1318" data-original="https://picx.zhimg.com/v2-8c36800af894635992a96eea1d90066c_r.jpg?source=1940ef5c">
  <figcaption>
   3D堆叠，之后会进行滤波
  </figcaption>
 </figure>
 <p data-pid="0wdtWzRV">再通过阈值判决或者维纳滤波等最佳线性滤波器，获取最终的像素结果。<b>BM3D的性能之所以那么好，也正是因为block matching和3D filtering这种空域+频域滤波结合的思想。</b></p>
 <p data-pid="6Naizzc5">所以，因为BM3D需要通过block matching搜索全图（或某个大范围局部区域）找到相似块，再利用小波变换、维纳滤波等方式才能最终找到去噪后的图像结果，所以会大幅度提升图像处理结果（性能在现在的一堆实验室算法中也算得上state-of-the-art），但是会<b>大大增加算法的计算复杂度</b>。</p>
 <p data-pid="OttHeLAo">其中block matching这一步尤其耗时。</p>
 <p data-pid="hmwZqVOb">大概耗时到什么程度？</p>
 <p data-pid="-2MyScp2">官方公布的程序<sup data-text="Image and video denoising by sparse 3D transform-domain collaborative filtering" data-url="http://www.cs.tut.fi/~foi/GCF-BM3D/" data-draft-node="inline" data-draft-type="reference" data-numero="5">[5]</sup>中，用BM3D matlab程序在桌面i7(@3.6GHz，16GB RAM)平台处理5百万像素图片大约需要40-50秒（现在手机相机大约都是1-2千万级的多个摄像头）。为此专门有研究人员开发了GPU加速版本 BM3D<sup data-text="Honzátko D, Kruliš M. Accelerating block-matching and 3D filtering method for image denoising on GPUs[J]. Journal of Real-Time Image Processing, 2017: 1-15." data-url="" data-draft-node="inline" data-draft-type="reference" data-numero="6">[6]</sup>，在GTX980平台上处理速度能达到5s以内，这是普通用户可以接受的水平。</p>
 <p data-pid="gYb2RnBH">当然，强调一下以上实验中搜索范围和相似度都采用的是平均水准，并不极端，而参数选择也会影响到BM3D算法性能<sup data-text="Lebrun M. An analysis and implementation of the BM3D image denoising method[J]. Image Processing On Line, 2012, 2: 175-213." data-url="" data-draft-node="inline" data-draft-type="reference" data-numero="7">[7]</sup>。现在单反中是有用到BM3D的，但是对应的ISP芯片算力没有找到具体数据...</p>
 <figure data-size="normal">
  <img src="https://picx.zhimg.com/50/v2-f0211cd0477455bd643c3f3fce2b6356_720w.jpg?source=1940ef5c" data-caption="" data-size="normal" data-rawwidth="451" data-rawheight="427" data-original-token="v2-8e002c1b98423f523fa0187eec437276" class="origin_image zh-lightbox-thumb" width="451" data-original="https://picx.zhimg.com/v2-f0211cd0477455bd643c3f3fce2b6356_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="_nOFhsjf">实验室算法从实验室到工业化，<b>其实本质上是一个效果和运算复杂度之间的平衡和优化问题</b>。 所以，发布会声称麒麟990可以在mobile SoC中的 ISP（面积应该不会很大）里实现了BM3D算法，且能用的话，这是一件相当厉害的事。</p>
 <p data-pid="UaOYo8fg">目前mobile ISP中用到比较多的是多帧图像去噪，计算压力没有block matching那么大，属于另一种技术流派，和BM3D这种单帧去噪算法可以联合使用提升效果。深度学习系的去噪算法目前大多不算在ISP这种传统图像信号处理模块里。</p>
 <p data-pid="DrEmmXxz">结合发布会上对「双域视频降噪技术」的描述（这个听起来不太可能是VBM3D），猜测华为可能是在ISP硬件设计或者是和GPU/NPU这些模块的联合调度中取得了大幅度突破，希望可以公布具体做法。而BM3D的成功应用，当然会给相机成像质量带来提升。</p>
 <figure data-size="normal">
  <img src="https://pic1.zhimg.com/50/v2-3006b72311539511ca1249eb8588eddf_720w.jpg?source=1940ef5c" data-size="normal" data-rawwidth="4096" data-rawheight="1569" data-original-token="v2-69c543231e8ff04ca0f8177e5042cacd" data-default-watermark-src="https://pic1.zhimg.com/50/v2-2952aa7b049e9192c96a4708f44a430d_720w.jpg?source=1940ef5c" class="origin_image zh-lightbox-thumb" width="4096" data-original="https://picx.zhimg.com/v2-3006b72311539511ca1249eb8588eddf_r.jpg?source=1940ef5c">
  <figcaption>
   emmm····相机读心率···
  </figcaption>
 </figure>
 <p class="ztext-empty-paragraph"><br></p>
 <p data-pid="hm-sytOF">总之，这款Kirin 990 SoC不论是从CPU、GPU、ISP、5G Modem、NPU还是内置图像算法，单项对比都已经站在现存SoC的高峰，相信两周后带有Kirin 990的Mate 30手机会非常值得期待。</p>
 <p data-pid="HVObTws_">完。</p>
 <p></p>
</body>
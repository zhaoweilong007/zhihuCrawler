# Excel 有哪些可能需要熟练掌握而很多人不会的技能？
- 点赞数：8862
- 更新时间：2016年03月23日07时09分38秒
- 回答url：https://www.zhihu.com/question/21758700/answer/91385842
<body>
 <p data-pid="eM7MpRTM">在咨询公司、VC/PE/Hedge Fund等基金混迹多年，一直靠着Excel的各种技巧安身立命和升职加薪。可能是因为程序员出身的原因，在学会以上各个答案提到的装逼炫酷图表、快捷键和一些略复杂的函数（VLookup等）之外，总是希望从更深的层次去探索Excel及各类Office软件，直到遇到了数组函数和VBA编程。这些技能一旦掌握能将工作效率提高数倍甚至是十倍以上，然而周围却很少有人掌握。如果对这些技能感兴趣，可以关注这个活动：</p><a href="http://zhuanlan.zhihu.com/hemingke/20652268" class="internal">粉丝回馈：程序让你更性感 - 数据冰山 - 知乎专栏</a>
 <p data-pid="NzmDnsmR">。</p>
 <p data-pid="-S2xCPDK">数组函数和VBA编程，简直就是为程序员而生的，数组函数充满了数据库的思维，而VBA本身就是彻头彻尾的编程，再加之各种接口，能够将Office各套软件以及OS下的各种功能完美结合在一起。因为Excel+VBA是图灵完备的，最后辅以Excel简单高效的数据呈现界面，所以在我的心目中，Excel+数组函数+VBA，简直就是网页前端+客户端+后台程序+数据库。感觉学会了这些，某种意义上就是成为了Full Stack Developer（全栈工程师），各互联网公司梦寐以求想招到的人。</p>
 <p data-pid="0ztqFozy"><b>一、数组函数</b></p>
 <p data-pid="x2TD32KF">数组函数往往会和Index、Indirect及Address等地址相关和数据块相关的函数搭配使用，如果不考虑效率的话，基本可以替代各种SQL语句了。</p>
 <p data-pid="UFE0NpGo"><u><i>数组函数之案例1：计算某类产品的总价值</i></u></p>
 <p data-pid="uzT7UdRD">计算AA产品的总价值，替代select sum(产品数量x产品单价) from ... where 产品编号=‘AA’</p>
 <p data-pid="Na7We57b">{=SUM(IF(($B$4:$B$8="AA"),($C$4:$C$8)*($D$4:$D$8),0))}</p>
 <figure>
  <img src="https://picx.zhimg.com/50/683621694a30fb9ae818db7b85f65751_720w.jpg?source=1940ef5c" data-rawwidth="304" data-rawheight="152" data-original-token="683621694a30fb9ae818db7b85f65751" class="content_image" width="304">
 </figure>
 <p data-pid="RBBgyaCe">如果没有数组函数，使用sumif等函数也会很复杂。</p>
 <p data-pid="8t9Ntd5E"><u><i>数组函数之案例2：挑选不重复的值并计算总和</i></u></p>
 <p data-pid="ZbJzHP87">左边的白色区域是原始数据，右边的彩色区域使用了数组函数的输出区域。数组函数实现了两大功能：</p>
 <ul>
  <li data-pid="QZ_pYCAk">黄色区域：将不重复的name+month筛选出来。</li>
  <li data-pid="tHXfex6s">蓝色区域：替代了select sum(tot) from ... group by name, month，将name+month对应的tot进行加总<br></li>
 </ul>
 <p data-pid="ECgZ4Tim">如果没有数组函数，只能使用Pivot Table等复杂方式，不仅程序开销很大，而且还不够灵活。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/d11d826d933369430ae978819355f06b_720w.jpg?source=1940ef5c" data-rawwidth="681" data-rawheight="633" data-original-token="d11d826d933369430ae978819355f06b" class="origin_image zh-lightbox-thumb" width="681" data-original="https://pic1.zhimg.com/d11d826d933369430ae978819355f06b_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="9mckPP7J"><u><i>数组函数之案例3：</i></u></p>
 <p data-pid="QXo4e8hg">这是一个帮助某国际家用电器厂商预测中国各家电品类市场潜力及规模的项目，从2005-2024年。一般的Excel函数只能解决两维的问题，而这次客户提出了这个变态的n维需求，需要精确到年份、电器品类、渠道类型、用户高中低端以及城市级别共5个维度来查看市场规模及潜力。简单说就是利用下面这个表格随时查看指定维度下的某年份的市场潜力及规模。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/50611288f0b91484921a0bdc00935972_720w.jpg?source=1940ef5c" data-rawwidth="518" data-rawheight="526" data-original-token="50611288f0b91484921a0bdc00935972" class="origin_image zh-lightbox-thumb" width="518" data-original="https://pica.zhimg.com/50611288f0b91484921a0bdc00935972_r.jpg?source=1940ef5c">
 </figure>
 <br>
 <p data-pid="2hZP5nc4">通过使用数组函数建模轻松实现如下功能，只要在指定的区域内选择相关值，就能计算值所需的市场规模及潜力，等于使用了SQL语句：select * from table where 条件1=A1 and 条件2=A2 and 条件3=A3……（共5个条件）</p>
 <figure>
  <img src="https://picx.zhimg.com/50/adfb2a50a8bfd98a2fb3551b1ceea8dc_720w.jpg?source=1940ef5c" data-rawwidth="521" data-rawheight="459" data-original-token="adfb2a50a8bfd98a2fb3551b1ceea8dc" class="origin_image zh-lightbox-thumb" width="521" data-original="https://picx.zhimg.com/adfb2a50a8bfd98a2fb3551b1ceea8dc_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="LWzxIaXp">复杂的数组函数编码如下</p>
 <div class="highlight">
  <pre><code class="language-text">=SUM(((Summary_Market!$S$71:$S$308=$A7)+(Summary_Market!$S$71:$S$308=$V7)+(Summary_Market!$S$71:$S$308=$AA7)+($A7="")&gt;0)*((Summary_Market!$T$71:$T$308=$B7)+(Summary_Market!$T$71:$T$308=$W7)+(Summary_Market!$T$71:$T$308=$AB7)+($B7="")&gt;0)*((Summary_Market!$U$71:$U$308=$C7)+(Summary_Market!$U$71:$U$308=$X7)+(Summary_Market!$U$71:$U$308=$AC7)+($C7="")&gt;0)*((Summary_Market!$V$71:$V$308=$D7)+(Summary_Market!$V$71:$V$308=$Y7)+(Summary_Market!$V$71:$V$308=$AD7)+($D7="")&gt;0)*(Summary_Market!BB$71:BB$308))
</code></pre>
 </div>
 <p data-pid="SDWToiJd">整个模型的界面及复杂的数组函数如下图，左边部分的界面其实就是图形化的SQL语句。这个模型被该客户及我们咨询公司使用了不下5年，部分依赖于其超强的灵活性。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/10ee16077908f109225127873a443695_720w.jpg?source=1940ef5c" data-rawwidth="1879" data-rawheight="899" data-original-token="10ee16077908f109225127873a443695" class="origin_image zh-lightbox-thumb" width="1879" data-original="https://picx.zhimg.com/10ee16077908f109225127873a443695_r.jpg?source=1940ef5c">
 </figure>
 <br>
 <br>
 <p data-pid="iF9Qv5p8"><b>二、VBA编程</b></p>
 <p data-pid="BJSLKHqO">首先不要被“编程”二字吓跑，因为VBA不会编程也可以进行，通过录制宏的方式就可以搞定。分享一些学习VBA的小技巧（一些学习VBA的小技巧在这个回答里：</p><a href="https://www.zhihu.com/question/20870802/answer/34107391" class="internal">Excel VBA 如何快速学习？ - 何明科的回答</a>
 <p data-pid="lsCMaDcp">），录制宏的诀窍见下图。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/9d4d1e746543513dab9a9964dd942836_720w.jpg?source=1940ef5c" data-rawwidth="723" data-rawheight="497" data-original-token="9d4d1e746543513dab9a9964dd942836" class="origin_image zh-lightbox-thumb" width="723" data-original="https://picx.zhimg.com/9d4d1e746543513dab9a9964dd942836_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="C97GrG-6">如果真要升级成为VBA编程达人，还是需要自己学习和自己编写VBA程序。下面列举若干自己亲手编写的若干Excel+VBA项目。</p>
 <p data-pid="gME2Ttei"><i><u>VBA编程之案例1：自动打印</u></i></p>
 <p data-pid="cPU0icxT">刚进职场的新人，只要爸爸不是李刚，基本都做过影帝影后（影=印，各种复印打印的体力劳动）。特别是咨询投行服务行业，在某次给客户的大汇报或者大忽悠会议之前，花数小时或者整晚来打印数个文件，并不是天方夜谭。而且这件事情是对着同样一堆不断修改的文件，会经常不断重复发生。</p>
 <p data-pid="7twU2q0f">我加入BCG的第一个项目，就是帮助某大型企业从上到下设计KPI体系并实施。从上到下涉及到几十个部门，大概有100多张的KPI表格需要完成，这些KPI表格分布在各个Excel文件里。我们4个咨询顾问的任务：</p>
 <ul>
  <li data-pid="wvovx_uM">设定好KPI的基本格式，然后每个顾问负责几个部门，在Excel里不断修改KPI表格，打印出来后去各个当事人及其领导那里讨论并修改</li>
  <li data-pid="OEJGJa7Z">每周把所有的Excel文件中的KPI表格归集在一起，按顺序分部门打印出来，并需要多份，找负责该项目的HR头儿汇报进度和情况</li>
 </ul>
 <p data-pid="zT_wm479">这里面有个费时费力的环节，每周需要在多个Excel文件中找出目标Worksheet，然后选定合适的区域作为输出的表格，按照一定的格式和一定的顺序，打印出这100多张表格。之前我们全是凭借人力，每周由一个Analyst把所有最新的Excel文件收集在一起，然后挨个打开文件选中合适的Worksheet，选中区域设置好格式进行打印。每进行一次，几乎耗费一两个小时，还不能保证不出错。</p>
 <p data-pid="HchsxcXA">于是写下了我的第一个VBA程序，而且基本上是宏录制之后来改的，没有使用参考书及搜索引擎，全靠F1和自动提示，所以贴出来特别纪念一下。实现的功能就是将上述的人肉实现的功能全部自动化。按下一个妞，就慢慢等着打印机按顺序出结果吧。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/e7cd68b25900b0c5f4a6f60b935a05f5_720w.jpg?source=1940ef5c" data-rawwidth="676" data-rawheight="424" data-original-token="e7cd68b25900b0c5f4a6f60b935a05f5" class="origin_image zh-lightbox-thumb" width="676" data-original="https://pic1.zhimg.com/e7cd68b25900b0c5f4a6f60b935a05f5_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="DkJbfLXe">后来这个程序的升级版是：调度多台打印机，进一步提高效率，以及将打印机卡纸造成队列错误的概率降到极小的范围内。</p>
 <p data-pid="Tdhmzsh8"><i><u>VBA编程之案例2：制作复杂的矩阵式分析图表</u></i></p>
 <p data-pid="DXOiLKCc">下图是研究各个车型之间的用户相互转换关系，因为要将一维的转化率向量，变成两维的矩阵，所以使用了如下的复杂公式。</p>
 <div class="highlight">
  <pre><code class="language-vb.net"><span class="o">=</span><span class="k">IF</span><span class="p">(</span><span class="n">ISERROR</span><span class="p">(</span><span class="n">OFFSET</span><span class="p">(</span><span class="err">$</span><span class="n">C</span><span class="err">$</span><span class="n">2</span><span class="p">,</span><span class="n">MATCH</span><span class="p">(</span><span class="n">CONCATENATE</span><span class="p">(</span><span class="n">ROW</span><span class="p">(</span><span class="n">A4</span><span class="p">),</span><span class="s">"-"</span><span class="p">,</span><span class="n">COLUMN</span><span class="p">(</span><span class="n">A4</span><span class="p">)),</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">3</span><span class="p">:</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">600</span><span class="p">,</span><span class="k">FALSE</span><span class="p">),</span><span class="n">0</span><span class="p">)</span><span class="o">/</span><span class="n">OFFSET</span><span class="p">(</span><span class="err">$</span><span class="n">C</span><span class="err">$</span><span class="n">2</span><span class="p">,</span><span class="n">MATCH</span><span class="p">(</span><span class="n">CONCATENATE</span><span class="p">(</span><span class="n">ROW</span><span class="p">(</span><span class="n">A4</span><span class="p">),</span><span class="s">"-"</span><span class="p">,</span><span class="n">ROW</span><span class="p">(</span><span class="n">A4</span><span class="p">)),</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">3</span><span class="p">:</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">600</span><span class="p">,</span><span class="k">FALSE</span><span class="p">),</span><span class="n">0</span><span class="p">)),</span><span class="s">""</span><span class="p">,</span><span class="n">OFFSET</span><span class="p">(</span><span class="err">$</span><span class="n">C</span><span class="err">$</span><span class="n">2</span><span class="p">,</span><span class="n">MATCH</span><span class="p">(</span><span class="n">CONCATENATE</span><span class="p">(</span><span class="n">ROW</span><span class="p">(</span><span class="n">A4</span><span class="p">),</span><span class="s">"-"</span><span class="p">,</span><span class="n">COLUMN</span><span class="p">(</span><span class="n">A4</span><span class="p">)),</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">3</span><span class="p">:</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">600</span><span class="p">,</span><span class="k">FALSE</span><span class="p">),</span><span class="n">0</span><span class="p">)</span><span class="o">/</span><span class="n">OFFSET</span><span class="p">(</span><span class="err">$</span><span class="n">C</span><span class="err">$</span><span class="n">2</span><span class="p">,</span><span class="n">MATCH</span><span class="p">(</span><span class="n">CONCATENATE</span><span class="p">(</span><span class="n">ROW</span><span class="p">(</span><span class="n">A4</span><span class="p">),</span><span class="s">"-"</span><span class="p">,</span><span class="n">ROW</span><span class="p">(</span><span class="n">A4</span><span class="p">)),</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">3</span><span class="p">:</span><span class="err">$</span><span class="n">D</span><span class="err">$</span><span class="n">600</span><span class="p">,</span><span class="k">FALSE</span><span class="p">),</span><span class="n">0</span><span class="p">))</span>
</code></pre>
 </div>
 <p data-pid="KwwQJGkj">同时为了用颜色的深浅来表示转化率的大小关系而便于比较，使用了VBA对下面的矩阵进行着色。当然有人肯定会说可以使用条件化格式，但是使用VBA保持了最高灵活度和效率。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/8e6941c88316bdaec24f12962804b760_720w.jpg?source=1940ef5c" data-rawwidth="1695" data-rawheight="680" data-original-token="8e6941c88316bdaec24f12962804b760" class="origin_image zh-lightbox-thumb" width="1695" data-original="https://picx.zhimg.com/8e6941c88316bdaec24f12962804b760_r.jpg?source=1940ef5c">
 </figure>
 <br>
 <p data-pid="7ICQalk_"><i><u>VBA编程之案例3：</u></i><u><i>管理分布的任务流，并将Excel表格输出到Powerpoint</i></u></p>
 <p data-pid="AhsbB44F">这是协助某国际大型汽车制造厂完成新品牌及其新款车型上市，面临车型即将断档的窘境，该新车型的上市非常关键，不能错失时间节点。然而，新车型上市涉及到无数分支：制造、产品、市场、渠道、营销、公关、财务等等，同时还要协调欧洲的两个总部以及中国的两个分部。</p>
 <p data-pid="Q8ucdoSa">这次咨询的核心任务就是项目管理，总控整个大项目的进度，并每周向中国区的CEO汇报进度并发掘出易出现问题的关键节点以调配资源。我们4个咨询顾问分配下去各自负责几个部门或者项目分支，和团队一起规划流程、画甘特图、确认里程碑及时间点、安排负责人等等。当每天回到办公室大家将进度汇总在一起的时候发现了挑战及难点，每条任务线并不是独立发展的，而是各条任务线交织在一起并互相影响。</p>
 <ul>
  <li data-pid="tux1hKp1">某些核心人员在多个任务线出现。比如：负责预算的财务人员，几乎要出现在各条线中负责相关预算的审批环节</li>
  <li data-pid="VRi9gOCA">某些任务线的里程碑是其他任务线里程碑的必要条件而相互关联。比如：新车的下线时间影响发布会的时间，相关法规测试的通过又影响车辆的下线时间等等</li>
 </ul>
 <p data-pid="JB8q0fKY">当任务线增多以及任务线之间的交叉越发频繁的时候，汇总的任务将会几何级数增加，这就是我们在项目过程中遇到的问题。于是我利用Excel+VBA完成了这个工作的自动化。主要实现的功能：</p>
 <ul>
  <li data-pid="GpCMTxzH">自动将4个顾问手中分散的Excel文件汇集在一起形成一个大的总表，如下图</li>
  <li data-pid="R4s7y9J0">各顾问手中的表格是按照部门维度来划分的，汇总后需要按照不同的维度来输出不同类型的表格，比如：按任务线输出表格、按责任人输出表格、所有延误任务的表格、所有需要资源重点投入任务的表格等等</li>
 </ul>
 <figure>
  <img src="https://pic1.zhimg.com/50/735d490e3ccd5ada806b28230e7d7c31_720w.jpg?source=1940ef5c" data-rawwidth="921" data-rawheight="663" data-original-token="735d490e3ccd5ada806b28230e7d7c31" class="origin_image zh-lightbox-thumb" width="921" data-original="https://picx.zhimg.com/735d490e3ccd5ada806b28230e7d7c31_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="xEQGCbjh">在此基础之上，还要将上面提到的各种维度下的所有表格（大概有200多张），按要求格式粘贴到PPT中，每周提交给中国区的总部进行汇报和评估。密密麻麻的表格如下图。于是，我又写了一个程序将Excel中的表格输出到Powerpoint中，将一个秘书每次需要数小时才能完成的工作，简化成了一键发布，并可以在Excel中完成对PPT的更新。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/13113c0de51532ae9d52781b90a5f984_720w.jpg?source=1940ef5c" data-rawwidth="1725" data-rawheight="745" data-original-token="13113c0de51532ae9d52781b90a5f984" class="origin_image zh-lightbox-thumb" width="1725" data-original="https://pic1.zhimg.com/13113c0de51532ae9d52781b90a5f984_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="vlowInGi">这个项目的程序量不小，近似于写了一个迷你版的Microsoft Project来进行项目管理。</p>
 <figure>
  <img src="https://pica.zhimg.com/50/6686906f828d327e4e90bd0f33adbffa_720w.jpg?source=1940ef5c" data-rawwidth="1841" data-rawheight="813" data-original-token="6686906f828d327e4e90bd0f33adbffa" class="origin_image zh-lightbox-thumb" width="1841" data-original="https://pica.zhimg.com/6686906f828d327e4e90bd0f33adbffa_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="_GhWeuv-">最后，下图中密密麻麻的PPT每周需要更新一次，每次都是快100张的工作量，然而基本上都是靠Excel来自动完成更新的。因为PPT的模版每次变化不大，我将这些模版记录下来，每周更新的时候只要根据Excel中最新的数据更改PPT中的数据即可。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/14ce50e4e2f1859d8d85c80b04ac669d_720w.jpg?source=1940ef5c" data-rawwidth="1709" data-rawheight="757" data-original-token="14ce50e4e2f1859d8d85c80b04ac669d" class="origin_image zh-lightbox-thumb" width="1709" data-original="https://picx.zhimg.com/14ce50e4e2f1859d8d85c80b04ac669d_r.jpg?source=1940ef5c">
 </figure>
 <br>
 <p data-pid="o5GeRJZf"><i><u>VBA编程之案例4：构建Financial Model并</u></i><u><i>根据结果倒推假设</i></u></p>
 <p data-pid="pN0WIsPT">一般的Financial Model都是根据重重假设计算最终结果。而在为某顶级手机品牌服务的过程中，我们却遭遇了逆向的尴尬。本来是根据地面销售人员的一定服务水平，计算所需要的销售人员数量；结果在项目过程中，总部已经确定好了销售人数的Head Count，转而要求我们根据HC确定服务水平。然而，服务水平不是一个单变量，是由零售店的覆盖率、销售拜访频率、拜访中的服务深度等多重因素来决定的，同时还可以根据一线至无线城市来变化。</p>
 <p data-pid="HU4gDroV">于是只好再次寄出Excel+VBA法宝。先根据常规思路建立好Financial Model，得出HC的初步结果。然后写VBA程序，根据不同的情景、不同的优先级以及不同的权重来调节零售店的覆盖率、销售拜访频率、拜访中的服务深度等多因素，同时设定这几大因素的可接受范围，逐步逼近HC的预设值。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/830621f87ccf31b455d7feed519125a8_720w.jpg?source=1940ef5c" data-rawwidth="1229" data-rawheight="709" data-original-token="830621f87ccf31b455d7feed519125a8" class="origin_image zh-lightbox-thumb" width="1229" data-original="https://picx.zhimg.com/830621f87ccf31b455d7feed519125a8_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="lnEpuyfP">如果没有程序，以前基本是靠人工手动调节来凑结果，而且因为各种情景的不同，还需要多次调节。而通过程序，基本是自动完成，还可智能得设置优先级及权重，无需人工参与。</p>
 <p data-pid="R3nd2kW0"><i><u>VBA编程之案例5：海量下载Bloomberg数据并完成分析</u></i></p>
 <p data-pid="qWuVcgSG">通过Bloomberg的VBA API，海量下载数百只目标股票的tick data以及order book。</p>
 <figure>
  <img src="https://pic1.zhimg.com/50/1753b3966dc2c5a0e7d339fed7ab5979_720w.jpg?source=1940ef5c" data-rawwidth="930" data-rawheight="273" data-original-token="1753b3966dc2c5a0e7d339fed7ab5979" class="origin_image zh-lightbox-thumb" width="930" data-original="https://pica.zhimg.com/1753b3966dc2c5a0e7d339fed7ab5979_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="QJz76ubV">并根据实现构建好的数学模型，在后台完成计算，将上述的实时数据转化成每只股票实时的trading cost，实时展现在交易员最常用的Excel界面中，方便交易员评估当下的交易成本以便于优化交易策略。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/183842f4c1a2307f18d03b8cb20657c8_720w.jpg?source=1940ef5c" data-rawwidth="1205" data-rawheight="222" data-original-token="183842f4c1a2307f18d03b8cb20657c8" class="origin_image zh-lightbox-thumb" width="1205" data-original="https://picx.zhimg.com/183842f4c1a2307f18d03b8cb20657c8_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="3DH5fov4"><b>三、数组函数+VBA的项目：全栈项目</b></p>
 <p data-pid="lxs2IcHQ">在项目中（</p><a href="http://zhuanlan.zhihu.com/hemingke/20083133" class="internal">RIO是如何席卷大江南北的？ - 数据冰山 - 知乎专栏</a>
 <p data-pid="Kj5h5q9G">）对Excel的要求很综合。首先通过数组函数，对每年对RIO酒购买时刻的提及率按省进行统计。</p>
 <figure>
  <img src="https://pica.zhimg.com/50/fe7498eca6ab6710ba8e2f14ab2ff927_720w.jpg?source=1940ef5c" data-rawwidth="1079" data-rawheight="709" data-original-token="fe7498eca6ab6710ba8e2f14ab2ff927" class="origin_image zh-lightbox-thumb" width="1079" data-original="https://pica.zhimg.com/fe7498eca6ab6710ba8e2f14ab2ff927_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="NZMQFgDq">其次，利用VBA程序，将上表中H列和I列的数据，按省份涂色到下图中的地图中。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/b3d53b76854235f69893fc56400e80f9_720w.jpg?source=1940ef5c" data-rawwidth="594" data-rawheight="350" data-original-token="b3d53b76854235f69893fc56400e80f9" class="origin_image zh-lightbox-thumb" width="594" data-original="https://pic1.zhimg.com/b3d53b76854235f69893fc56400e80f9_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="K4aby4tu">（涂色部分来自于网上的一段程序，制作GIF动画的是自己完成的）</p>
 <p data-pid="Dwn1Y8Qg">最后，再次利用VBA编程以及调用外部程序（GIFSICLE），将一幅幅图表合成在一起生成GIF动画。</p>
 <figure>
  <img src="https://pica.zhimg.com/50/3331aa1c952ab427bec6a0112c075529_720w.jpg?source=1940ef5c" data-rawwidth="1844" data-rawheight="494" data-original-token="3331aa1c952ab427bec6a0112c075529" class="origin_image zh-lightbox-thumb" width="1844" data-original="https://picx.zhimg.com/3331aa1c952ab427bec6a0112c075529_r.jpg?source=1940ef5c">
 </figure>
 <p data-pid="OxzowhG7">最后的彩蛋，还可以用VBA来画油画，零基础成为用美术作品把妹撩汉的艺术青年（</p><a href="https://www.zhihu.com/question/27720960/answer/91789985" class="internal">Excel 有什么奇技淫巧，让你相见恨晚？ - 何明科的回答</a>
 <p data-pid="MBl_RMLG">），下图把女神用Excel画成油画送给她。</p>
 <figure>
  <img src="https://picx.zhimg.com/50/ae03578effcf9a205d0ad3c267d9eaa6_720w.jpg?source=1940ef5c" data-original-token="ae03578effcf9a205d0ad3c267d9eaa6" class="content_image">
 </figure>
 <p data-pid="17jTqfXr">————————————————————</p>
 <p data-pid="9qekiCP6">更多文章关注我的专栏：</p><a href="http://zhuanlan.zhihu.com/hemingke" class="internal">数据冰山 - 知乎专栏</a>
</body>